<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Programació bàsica (ASX) \ Programació (DAM i DAW)</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Programació bàsica (ASX) \ Programació (DAM i DAW)">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Programació bàsica (ASX) \ Programació (DAM i DAW)</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u6" class="parentnode"><p><a class="unit" href="../../../WebContent/u6/introduccio.html">6. Fitxers</a></p><ul class="expander"><li id="u6introduccio"><a href="../../../WebContent/u6/introduccio.html">Introducció</a></li><li id="u6resum"><a href="../../../WebContent/u6/resum.html">Resum</a></li><li id="u6resultats_d_aprenentatge"><a href="../../../WebContent/u6/resultats_d_aprenentatge.html">Resultats d'aprenentatge</a></li><li id="u6mapa"><a href="../../../WebContent/u6/mapa.html">Mapa conceptual</a></li><li id="u6referencies"><a href="../../../WebContent/u6/referencies.html">Referències</a></li><li id="u6a1" class="tocsection"><p id='u6a1continguts'><a class="section" href="../../../WebContent/u6/a1/continguts.html">Gestió de fitxers</a><span class="buttonexp"></span></p><ul><li id="u6a1activitats"><a href="../../../WebContent/u6/a1/activitats.html">Activitats</a></li><li id="u6a1exercicis"><a href="../../../WebContent/u6/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u6a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u6/a1/continguts.html#la_classe_file">La classe File</a></li><li><a href="../../../WebContent/u6/a1/continguts.html#solucio_dels_reptes_proposats">Solució dels reptes proposats</a></li></ul></div></div><li id="u6a2" class="tocsection"><p id='u6a2continguts'><a class="section" href="../../../WebContent/u6/a2/continguts.html">Tractament bàsic de dades</a><span class="buttonexp"></span></p><ul><li id="u6a2activitats"><a href="../../../WebContent/u6/a2/activitats.html">Activitats</a></li><li id="u6a2exercicis"><a href="../../../WebContent/u6/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u6a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u6/a2/continguts.html#acces_sequeencial_a_fitxers_orientats_a_caracter">Accés seqüencial a fitxers orientats a caràcter</a></li><li><a href="../../../WebContent/u6/a2/continguts.html#aspectes_importants_de_l_acces_sequeencial">Aspectes importants de l'accés seqüencial</a></li><li><a href="../../../WebContent/u6/a2/continguts.html#acces_sequeencial_a_fitxers_orientats_a_byte">Accés seqüencial a fitxers orientats a byte</a></li><li><a href="../../../WebContent/u6/a2/continguts.html#acces_relatiu_a_les_dades">Accés relatiu a les dades</a></li><li><a href="../../../WebContent/u6/a2/continguts.html#solucions_als_reptes_proposats">Solucions als reptes proposats</a></li></ul></div></div><li id="u6a3" class="tocsection"><p id='u6a3continguts'><a class="section" href="../../../WebContent/u6/a3/continguts.html">Tractament modular de dades. El joc de combats a l'arena</a><span class="buttonexp"></span></p><ul><li id="u6a3activitats"><a href="../../../WebContent/u6/a3/activitats.html">Activitats</a></li><li id="u6a3exercicis"><a href="../../../WebContent/u6/a3/exercicis.html">Exercicis d'autoavaluació</a></li><li id="u6a3annexos"><a href="../../../WebContent/u6/a3/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u6a3' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u6/a3/continguts.html#descripcio_del_problema">Descripció del problema</a></li><li><a href="../../../WebContent/u6/a3/continguts.html#criteris_d_eleccio_de_tipus_de_fitxer">Criteris d'elecció de tipus de fitxer</a></li><li><a href="../../../WebContent/u6/a3/continguts.html#la_biblioteca_jocarenafitxers">La biblioteca "joc.arena.fitxers"</a></li><li><a href="../../../WebContent/u6/a3/continguts.html#esmenes_als_moduls_originals">Esmenes als mòduls originals</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Fitxers</a></li><li><a href="continguts.html">Tractament bàsic de dades</a></li><li>Activitats</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="activitats"> Activitats </a></h1>
    	
<h2><a id="compta_paraules" >Compta paraules</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a treballar amb cadenes de text llegides d’un fitxer orientat a caràcter.
</p>

<p>
Feu un programa anomenat <code>ComptaParaulesFitxer</code> que llegeixi un fitxer orientat a caràcter on hi ha tot de frases escrites en línies diferents. Per indicar el final del fitxer, hi ha una frase o només posa “fi”. Aquest programa ha de mostrar per pantalla el nombre de paraules que té cada frase, sense comptar la de “fi”. Les contraccions (l’, d’, etc.) compten com a part de la paraula associada.
</p>

<p>
Per exemple, a partir d’aquest fitxer:
</p>
<pre class="code">Hi havia una vegada...
Perquè ho ha fet avui?
No està malament
Si tu ho dius hi aniré
Doncs d&#039;acord
fi</pre>

<p>
La sortida per pantalla podria ser:
</p>
<pre class="code">La línia 1 té 4 paraules.
La línia 2 té 5 paraules.
La línia 3 té 3 paraules.
La línia 4 té 6 paraules.
La línia 5 té 2 paraules.</pre>

<p>
<form action=""><div class="solution ioccontent"><pre class="code java"><ol><li class="li1"><div class="de1">package unitat6.apartat2.activitats;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">import java.util.Scanner;</div></li><li class="li1"><div class="de1">import java.io.File;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">public class ComptaParaulesFitxer {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public static void main (String[] args) {</div></li><li class="li1"><div class="de1">    ComptaParaulesFitxer programa = new ComptaParaulesFitxer();</div></li><li class="li1"><div class="de1">    programa.inici();</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public void inici() {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      File f = new File(&quot;Document.txt&quot;);</div></li><li class="li1"><div class="de1">      Scanner lector = new Scanner(f);</div></li><li class="li1"><div class="de1">      boolean llegir = true;</div></li><li class="li1"><div class="de1">      int numLinia = 1;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      while (llegir) {</div></li><li class="li1"><div class="de1">        String text = lector.nextLine();</div></li><li class="li1"><div class="de1">        if (&quot;fi&quot;.equals(text)) {</div></li><li class="li1"><div class="de1">          llegir = false;</div></li><li class="li1"><div class="de1">        } else {</div></li><li class="li1"><div class="de1">          //Es pot usar &quot;split&quot; per comptar les paraules</div></li><li class="li1"><div class="de1">          String[] paraules = text.split(&quot; &quot;);</div></li><li class="li1"><div class="de1">          int numPar = paraules.length;</div></li><li class="li1"><div class="de1">          System.out.println(&quot;La línia &quot; + numLinia + &quot; té &quot; + numPar + &quot; paraules.&quot;);</div></li><li class="li1"><div class="de1">          numLinia++;</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">      lector.close();</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error llegint fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }     </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="la_maquina_d_escriure" >La màquina d&#039;escriure</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és veure com emmagatzemar dades llegides des del teclat en fitxers orientats a caràcter.
</p>

<p>
Feu un programa que funcioni com una màquina d’escriure. En iniciar la seva execució, ha de preguntar a l’usuari que escrigui, usant el teclat el nom d’un fitxer. Si aquest fitxer ja existeix, s’ha de demanar que posi un altre nom. Un cop s’ha escrit un nom correcte, el programa ha d’anar llegint tot el text que escrigui l’usuari i, cada cop que acaba d’introduir una línia, en prémer la tecla de retorn, desar-lo al fitxer. El programa acaba quan l’usuari escriu una línia de text en la qual només hi ha un punt (“.”). Aquest punt no s’escriu dins el fitxer resultant.
</p>

<p>
<form action=""><div class="solution ioccontent"><pre class="code java"><ol><li class="li1"><div class="de1">package unitat6.apartat2.activitats;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">import java.util.Scanner;</div></li><li class="li1"><div class="de1">import java.io.File;</div></li><li class="li1"><div class="de1">import java.io.PrintStream;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">public class MaquinaEscriure {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public static void main (String[] args) {</div></li><li class="li1"><div class="de1">    MaquinaEscriure programa = new MaquinaEscriure();</div></li><li class="li1"><div class="de1">    programa.inici();</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public void inici() {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      File fitxerSortida = preguntarFitxer();</div></li><li class="li1"><div class="de1">      PrintStream escriptor = new PrintStream(fitxerSortida);</div></li><li class="li1"><div class="de1">      Scanner lector = new Scanner(System.in);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      boolean llegir = true;</div></li><li class="li1"><div class="de1">      while (llegir) {</div></li><li class="li1"><div class="de1">        String text = lector.nextLine();</div></li><li class="li1"><div class="de1">        if (&quot;.&quot;.equals(text)) {</div></li><li class="li1"><div class="de1">          llegir = false;</div></li><li class="li1"><div class="de1">        } else {</div></li><li class="li1"><div class="de1">          escriptor.println(text);</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      escriptor.close();</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error escrivint fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Pregunta a l'usuari el nom del fitxer.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @return Ruta al fitxer a escriure</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public File preguntarFitxer() {</div></li><li class="li1"><div class="de1">    Scanner lector = new Scanner(System.in);</div></li><li class="li1"><div class="de1">    boolean preguntar = true;</div></li><li class="li1"><div class="de1">    File f = null;</div></li><li class="li1"><div class="de1">    while (preguntar) {</div></li><li class="li1"><div class="de1">      System.out.print(&quot;Escriu el nom del fitxer on escriure: &quot;);</div></li><li class="li1"><div class="de1">      String nomFitxer = lector.nextLine();</div></li><li class="li1"><div class="de1">      f = new File(nomFitxer);</div></li><li class="li1"><div class="de1">      if (f.exists()) {</div></li><li class="li1"><div class="de1">        System.out.println(&quot;El fitxer ja existeix.&quot;);</div></li><li class="li1"><div class="de1">      } else {</div></li><li class="li1"><div class="de1">        preguntar = false;</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">    return f;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="histogrames" >Histogrames</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és veure com desar en un fitxer orientat a caràcter el resultat de fer operacions complexes sobre unes dades llegides des d’un altre fitxer.
</p>

<p>
Genereu un programa que, en iniciar-se, pregunti el nom d’un fitxer a l’usuari. El programa ha de comprovar que existeix. Aquest fitxer ha de contenir una seqüència de valors reals, entre 0 i 10, que representen un seguit de notes d’estudiants d’una aula. Per indicar el final de la seqüència, s’usa el valor -1 com a marca de fi. Podeu generar-lo prèviament vosaltres mateixos amb un editor de text.
</p>

<p>
El programa ha de llegir el contingut del fitxer i generar-ne un de nou anomenat “Histograma-nom del fitxer llegit”. Per exemple, si el fitxer amb les notes es diu, “NotesReals.txt”, el fitxer resultat s’anomenarà “Histograma-NotesReals.txt”. El contingut d’aquest fitxer ha de ser un histograma de les notes, comptant que: 
</p>
<ul>
<li class="level1"><div class="li"> Excel·lent = nota entre 10 i 9</div>
</li>
<li class="level1"><div class="li"> Notable = nota entre 9 i 6.5</div>
</li>
<li class="level1"><div class="li"> Aprovat = nota entre 6.5 i 5</div>
</li>
<li class="level1"><div class="li"> Suspès = nota inferior a 5</div>
</li>
</ul>

<p>
Per exemple, si el fitxer “NotesReals.txt” conté:
</p>
<pre class="code">10 8,5 4,5 3,75 6 7,5 8 9 2,5 9 5 6,5 -1</pre>

<p>
El fitxer resultant “Histograma-NotesReals.txt” contindria el següent:
</p>
<pre class="code">Histograma del fitxer NotesReals.txt
------------
Suspès    :***
Aprovat   :**
Notable   :****
Excel·lent:***</pre>

<p>
<form action=""><div class="solution ioccontent"><pre class="code java"><ol><li class="li1"><div class="de1">package unitat6.apartat2.activitats;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">import java.util.Scanner;</div></li><li class="li1"><div class="de1">import java.io.File;</div></li><li class="li1"><div class="de1">import java.io.PrintStream;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">public class Histogrames {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  //Constant que tradueix &lt;blau&gt;índexs d'histograma&lt;/blau&gt;&lt;nota blau&gt;és correcta l'esmena? --- //[[cortegai@uoc.edu|Clara Ortega Illera]] 11/08/2011 17:43//&lt;/nota&gt; a text</div></li><li class="li1"><div class="de1">  private static final String[] textHistograma =</div></li><li class="li1"><div class="de1">                       {&quot;Suspès    &quot;, &quot;Aprovat   &quot;, &quot;Notable   &quot;, &quot;Excel·lent&quot;};</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public static void main (String[] args) {</div></li><li class="li1"><div class="de1">    Histogrames programa = new Histogrames();</div></li><li class="li1"><div class="de1">    programa.inici();</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public void inici() {</div></li><li class="li1"><div class="de1">    File fitxerEntrada = preguntarFitxer();</div></li><li class="li1"><div class="de1">    int[] histograma = crearHistograma(fitxerEntrada);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    String nomSortida = &quot;Histograma-&quot; + fitxerEntrada.getName();</div></li><li class="li1"><div class="de1">    File fitxerSortida = new File (nomSortida);</div></li><li class="li1"><div class="de1">    String titol = &quot;Histograma del fitxer &quot; + fitxerEntrada.getName();</div></li><li class="li1"><div class="de1">    escriureHistograma(titol, histograma, fitxerSortida);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    System.out.println(&quot;Histograma escrit al fitxer &quot; + fitxerSortida);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Pregunta a l'usuari el nom del fitxer.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @return Ruta al fitxer a escriure</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public File preguntarFitxer() {</div></li><li class="li1"><div class="de1">    Scanner lector = new Scanner(System.in);</div></li><li class="li1"><div class="de1">    boolean preguntar = true;</div></li><li class="li1"><div class="de1">    File f = null;</div></li><li class="li1"><div class="de1">    while (preguntar) {</div></li><li class="li1"><div class="de1">      System.out.print(&quot;Escriu el nom del fitxer amb les dades: &quot;);</div></li><li class="li1"><div class="de1">      String nomFitxer = lector.nextLine();</div></li><li class="li1"><div class="de1">      f = new File(nomFitxer);</div></li><li class="li1"><div class="de1">      if (f.isFile()) {</div></li><li class="li1"><div class="de1">        preguntar = false;</div></li><li class="li1"><div class="de1">      } else {</div></li><li class="li1"><div class="de1">        System.out.println(&quot;Aquest fitxer no existeix.&quot;);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">    return f;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** A partir d'un fitxer orientat a caràcter que conté reals, genera</div></li><li class="li1"><div class="de1">   * l'histograma. El valor -1 indica el final de les dades.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param f Fitxer d'on llegir les dades</div></li><li class="li1"><div class="de1">   * @return L'array de l'histograma.</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public int[] crearHistograma(File f) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      Scanner lector = new Scanner(f);</div></li><li class="li1"><div class="de1">      int[] histograma = new int[4];</div></li><li class="li1"><div class="de1">      boolean llegir = true;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      while (llegir) {</div></li><li class="li1"><div class="de1">        double valor = lector.nextDouble();</div></li><li class="li1"><div class="de1">        if (valor == -1) {</div></li><li class="li1"><div class="de1">          llegir = false;</div></li><li class="li1"><div class="de1">        } else {</div></li><li class="li1"><div class="de1">          int index = indexHistograma(valor);</div></li><li class="li1"><div class="de1">          if (index != -1) {</div></li><li class="li1"><div class="de1">            histograma[index]++;</div></li><li class="li1"><div class="de1">          }</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      lector.close();</div></li><li class="li1"><div class="de1">      return histograma;</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">     return null;</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Escriu un array que representa un histograma a un fitxer.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param titol Títol a la primera línia de l'histograma.</div></li><li class="li1"><div class="de1">   * @param histograma array amb l'histograma (4 posicions)</div></li><li class="li1"><div class="de1">   * @param f Fitxer destinació</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void escriureHistograma(String titol, int[] histograma, File f) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      PrintStream escriptor = new PrintStream(f);</div></li><li class="li1"><div class="de1">      escriptor.println(titol);</div></li><li class="li1"><div class="de1">      escriptor.println(&quot;------------&quot;);</div></li><li class="li1"><div class="de1">      for(int i = 0; i &lt; histograma.length; i++) {</div></li><li class="li1"><div class="de1">        escriptor.print(textHistograma[i] + &quot;:&quot;);</div></li><li class="li1"><div class="de1">        for (int j = 0; j &lt; histograma[i]; j++) {</div></li><li class="li1"><div class="de1">          escriptor.print(&quot;*&quot;);</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">        escriptor.println();</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      escriptor.close();</div></li><li class="li1"><div class="de1">    } catch (Exception e)  {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error escrivint resultat: &quot; + f);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** A partir del valor d'una nota, diu a quin índex de l'histograma correspon.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param valor Valor de nota a comprovar.</div></li><li class="li1"><div class="de1">   * @return Índex de l'histograma (0-3), o -1 si el valor no està entre 0 i 10.</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public int indexHistograma(double valor) {</div></li><li class="li1"><div class="de1">    if ((valor &gt;= 9)&amp;&amp;(valor &lt;= 10)) {</div></li><li class="li1"><div class="de1">      return 3;</div></li><li class="li1"><div class="de1">    } else if ((valor &gt;= 6.5)&amp;&amp;(valor &lt; 9)) {</div></li><li class="li1"><div class="de1">      return 2;</div></li><li class="li1"><div class="de1">    } else if ((valor &gt;= 5)&amp;&amp;(valor &lt; 6.5)) {</div></li><li class="li1"><div class="de1">      return 1;</div></li><li class="li1"><div class="de1">    } else  if ((valor &gt;= 0)&amp;&amp;(valor &lt; 5)) {</div></li><li class="li1"><div class="de1">      return 0;</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">    return -1;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="cadenes_de_bytes" >Cadenes de bytes</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a tractar fitxers orientats a byte que contenen diferents tipus de dades.
</p>

<p>
<strong>1.</strong> Genereu un programa que, a partir d’una frase, la desi en un fitxer orientat a byte. Ara bé, si us fixeu en els continguts de la unitat, veureu que entre la llista de mètodes bàsics per escriure tipus de dades a un fitxer d’aquestes característiques no hi ha cap mètode que escrigui cadenes de text directament. Per tant, el que es farà és emmagatzemar cada paraula individualment com si fos una seqüència de bytes. Per cada paraula, cal escriure primer la seva mida en bytes, i llavors immediatament els bytes de què es composa. Per transformar una cadena de text a un <em>array</em> de bytes podeu usar el mètode <strong>getBytes()</strong> de la classe <code>String</code>.
</p>

<p>
Per exemple, si es vol tractar la frase “Hi havia una vegada una cadena de text”, el fitxer contindria consecutivament els valors següents, tots ells en format binari (aquí s’escriuen com a text perquè us sigui possible entendre-ho).
</p>
<pre class="code">2 Hi 5 havia 3 una 6 vegada 3 una 6 cadena 2 de 4 text</pre>

<p>
<strong>2.</strong> Un cop fet, genereu un programa que sigui capaç de llegir el fitxer resultant i mostri per pantalla només les paraules amb un text que ocupi més de 3 bytes. Per exemple, a partir de la frase anterior, el programa mostraria:
</p>
<pre class="code">havia
vegada
cadena
text</pre>

<p>
Per inicialitzar una cadena de text partint d’un <em>array</em> de bytes (en lloc d’un literal entre cometes dobles, com heu fet sempre fins ara) es pot usar un constructor especial d<code>‘String</code>, d’acord a la sentència següent:
</p>
<pre class="code">String text = new String(arrayBytes);</pre>

<p>
<form action=""><div class="solution ioccontent"><pre class="code java"><ol><li class="li1"><div class="de1">package unitat6.apartat2.activitats;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">import java.io.RandomAccessFile;</div></li><li class="li1"><div class="de1">import java.io.File;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">public class TractarCadenesBinari {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public static void main (String[] args) {</div></li><li class="li1"><div class="de1">    TractarCadenesBinari programa = new TractarCadenesBinari();</div></li><li class="li1"><div class="de1">    programa.inici();</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public void inici() {</div></li><li class="li1"><div class="de1">    File fitxer = new File(&quot;CadenesText.bin&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    String text = &quot;Hi havia una vegada una cadena de text&quot;;</div></li><li class="li1"><div class="de1">    String[] paraules = text.split(&quot; &quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    generarFitxer(fitxer, paraules);</div></li><li class="li1"><div class="de1">    tractarFitxer(fitxer);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Genera un fitxer orientat a byte d'acord al format especificat. Si el</div></li><li class="li1"><div class="de1">   * fitxer ja existia, se sobreescriu totalment.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param f Ruta del fitxer a generar</div></li><li class="li1"><div class="de1">   * @param paraules Paraules que cal escriure</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void generarFitxer(File f, String[] paraules) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      if (f.isFile()) {</div></li><li class="li1"><div class="de1">        f.delete();</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">      RandomAccessFile raf = new RandomAccessFile(f, &quot;rw&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      for (int i = 0; i &lt; paraules.length; i++) {</div></li><li class="li1"><div class="de1">        byte[] bytes = paraules[i].getBytes();</div></li><li class="li1"><div class="de1">        raf.writeInt(bytes.length);</div></li><li class="li1"><div class="de1">        raf.writeBytes(paraules[i]);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      raf.close();</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error generant fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Tracta el fitxer, de manera que es mostren per pantalla només les</div></li><li class="li1"><div class="de1">   * paraules que ocupen més de tres bytes.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param f Ruta al fitxer que cal tractar</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void tractarFitxer(File f) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      RandomAccessFile raf = new RandomAccessFile(f, &quot;r&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      while (raf.getFilePointer() &lt; raf.length()) {</div></li><li class="li1"><div class="de1">        int numBytes = raf.readInt();</div></li><li class="li1"><div class="de1">        if (numBytes &gt; 3) {</div></li><li class="li1"><div class="de1">          //Si ocupa més de tres bytes, es llegeix i es mostra</div></li><li class="li1"><div class="de1">          byte[] bytes = new byte[numBytes];</div></li><li class="li1"><div class="de1">          for (int i = 0; i &lt; numBytes; i++) {</div></li><li class="li1"><div class="de1">            bytes[i] = raf.readByte();</div></li><li class="li1"><div class="de1">          }</div></li><li class="li1"><div class="de1">          String paraula = new String(bytes);</div></li><li class="li1"><div class="de1">          System.out.println(paraula);</div></li><li class="li1"><div class="de1">        } else {</div></li><li class="li1"><div class="de1">          //Si n'ocupa menys, se salta</div></li><li class="li1"><div class="de1">          raf.skipBytes(numBytes);</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      raf.close();</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error tractant fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="copiar_fitxers" >Copiar fitxers</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a treballar amb dos fitxers orientats a byte alhora, l’un per llegir dades i l’altre per escriure’n.
</p>

<p>
Feu un programa anomenat <code>CopiarFitxerBinari</code> que realitzi una còpia d’un fitxer orientat a byte. El programa primer ha de demanar a l’usuari que introdueixi pel teclat els noms dels fitxers origen i destinació. Un cop fet, ha d’assegurar-se que l’origen existeix i que el destí no (no es vol sobreescriure’l). Finalment, ha de crear un fitxer amb el nom de la destinació que contingui exactament les mateixes dades que el fitxer origen, siguin quines siguin aquestes dades o el seu tipus.
</p>

<p>
Un cop heu realitzat el programa i veieu que funciona correctament, reflexioneu sobre la qüestió següent: funcionarà correctament si el fitxer origen és orientat a caràcter? Proveu-ho.
</p>

<p>
<form action=""><div class="solution ioccontent"><pre class="code java"><ol><li class="li1"><div class="de1">package unitat6.apartat2.activitats;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">import java.util.Scanner;</div></li><li class="li1"><div class="de1">import java.io.File;</div></li><li class="li1"><div class="de1">import java.io.RandomAccessFile;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">//Proveu-lo sobre un fitxer orientat a caràcter...</div></li><li class="li1"><div class="de1">public class CopiarFitxerBinari {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public static void main (String[] args) {</div></li><li class="li1"><div class="de1">    CopiarFitxerBinari programa = new CopiarFitxerBinari();</div></li><li class="li1"><div class="de1">    programa.inici();</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public void inici() {</div></li><li class="li1"><div class="de1">    //Es llegeix de teclat rutes origen i destinació</div></li><li class="li1"><div class="de1">    Scanner teclat = new Scanner(System.in);</div></li><li class="li1"><div class="de1">    System.out.print(&quot;Escriu el nom del fitxer origen: &quot;);</div></li><li class="li1"><div class="de1">    String origen = teclat.nextLine();</div></li><li class="li1"><div class="de1">    File rutaOrigen = new File(origen);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    if (rutaOrigen.isFile()) {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      System.out.print(&quot;Escriu el nom del fitxer destinació: &quot;);</div></li><li class="li1"><div class="de1">      String desti = teclat.nextLine();</div></li><li class="li1"><div class="de1">      File rutaDesti = new File(desti);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      if (rutaDesti.isFile()) {</div></li><li class="li1"><div class="de1">        System.out.println(&quot;El fitxer destinació ja existeix.&quot;);</div></li><li class="li1"><div class="de1">      } else {</div></li><li class="li1"><div class="de1">        ferCopia(rutaOrigen, rutaDesti);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    } else {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;El fitxer origen no existeix.&quot;);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Copia un fitxer orientat a byte, a partir d'una ruta origen, a una de destinació.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param rutaOrigen Ruta del fitxer origen</div></li><li class="li1"><div class="de1">   * @param rutaDesti Ruta del fitxer destinació</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void ferCopia(File rutaOrigen, File rutaDesti) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      RandomAccessFile rafOrigen = new RandomAccessFile(rutaOrigen, &quot;r&quot;);</div></li><li class="li1"><div class="de1">      RandomAccessFile rafDesti = new RandomAccessFile(rutaDesti, &quot;rw&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      long numBytes = rutaOrigen.length();</div></li><li class="li1"><div class="de1">      for (int i = 0; i &lt; numBytes; i++) {</div></li><li class="li1"><div class="de1">        byte dada = rafOrigen.readByte();</div></li><li class="li1"><div class="de1">        rafDesti.writeByte(dada);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">      rafDesti.setLength(numBytes);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      rafOrigen.close();</div></li><li class="li1"><div class="de1">      rafDesti.close();</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Copia finalitzada correctament.&quot;);</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error fent la còpia: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>

<p>
Respecte a la qüestió, sí que funcionarà. Si us pareu a pensar, un fitxer orientat a caràcter és exactament el mateix que un fitxer orientat a byte on totes les dades que conté són de tipus caràcter (<code>char</code>).
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="actualitzacio_de_dades" >Actualització de dades</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és veure com treballar amb documents orientats a byte, de manera que s’hi puguin modificar les dades contingudes.
</p>

<p>
Feu un programa que serveixi com a editor de fitxers orientats a byte que contingui només enters. Aquest s’ha de comportar de la manera següent. En iniciar la seva execució, ha de preguntar a l’usuari quin fitxer vol editar, de manera que aquest pugui escriure el nom usant el teclat. Llavors, ha de mostrar el contingut del fitxer per pantalla, distribuït en files de 10 valors. No cal que formateu la sortida en columnes ben proporcionades. Si el fitxer no existia, se’n crea un de nou i, en aquest cas, no apareix cap valor, ja que el fitxer és buit.
</p>

<p>
Tot just després dels valors, el programa espera que l’usuari escrigui una comanda, d’entre les següents:
</p>
<ul>
<li class="level1"><div class="li"> a <em>valor</em>: afegir aquest valor al final del fitxer.</div>
</li>
<li class="level1"><div class="li"> d <em>posició</em>: esborrar el valor que hi ha en aquesta posició, comptant que el primer valor es considera en la posició 0. Ara hi ha un valor menys al fitxer.</div>
</li>
<li class="level1"><div class="li"> x: el programa acaba.</div>
</li>
</ul>

<p>
Després d’executar cada comanda, menys la de sortir, es torna a mostrar el contingut del fitxer, de manera que es poden veure els canvis soferts. 
</p>

<p>
Tot seguit es mostra un exemple de com podria ser l’execució del programa.
</p>
<pre class="code">Escriu el nom del fitxer a editar: FitxerEnters.bin

-------------
Comanda: hfdsgjf
Comanda desconeguda.

-------------
Comanda: a 3

3 
-------------
Comanda: a 50

3 50 
-------------
Comanda: a 40

3 50 40 
-------------
Comanda: a 2

3 50 40 2 
-------------
Comanda: d 1

3 40 2 
-------------
Comanda: x</pre>

<p>
<form action=""><div class="solution ioccontent"><pre class="code java"><ol><li class="li1"><div class="de1">package unitat6.apartat2.activitats;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">import java.io.RandomAccessFile;</div></li><li class="li1"><div class="de1">import java.io.File;</div></li><li class="li1"><div class="de1">import java.util.Scanner;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">public class ActualitzacioDades {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public static void main (String[] args) {</div></li><li class="li1"><div class="de1">    ActualitzacioDades programa = new ActualitzacioDades();</div></li><li class="li1"><div class="de1">    programa.inici();</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  public void inici() {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      //Es llegeix de teclat ruta del fitxer</div></li><li class="li1"><div class="de1">      Scanner teclat = new Scanner(System.in);</div></li><li class="li1"><div class="de1">      System.out.print(&quot;Escriu el nom del fitxer a editar: &quot;);</div></li><li class="li1"><div class="de1">      String origen = teclat.nextLine();</div></li><li class="li1"><div class="de1">      File fitxer = new File(origen);</div></li><li class="li1"><div class="de1">      RandomAccessFile raf = new RandomAccessFile(fitxer, &quot;rw&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      boolean executar = true;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      while(executar) {</div></li><li class="li1"><div class="de1">        mostrarFitxer(raf);</div></li><li class="li1"><div class="de1">        System.out.println(&quot;\n-------------&quot;);</div></li><li class="li1"><div class="de1">        System.out.print(&quot;Comanda: &quot;);</div></li><li class="li1"><div class="de1">        //Llegir comanda</div></li><li class="li1"><div class="de1">        String comanda = teclat.next();</div></li><li class="li1"><div class="de1">        if (&quot;x&quot;. equals(comanda)) {</div></li><li class="li1"><div class="de1">          executar = false;</div></li><li class="li1"><div class="de1">        } else {</div></li><li class="li1"><div class="de1">          if (&quot;a&quot;.equals(comanda)&amp;&amp;teclat.hasNextInt()) {</div></li><li class="li1"><div class="de1">            int valor = teclat.nextInt();</div></li><li class="li1"><div class="de1">            afegirValor(raf,valor);</div></li><li class="li1"><div class="de1">          } else if (&quot;d&quot;.equals(comanda)&amp;&amp;teclat.hasNextInt()) {</div></li><li class="li1"><div class="de1">            int posicio = teclat.nextInt();</div></li><li class="li1"><div class="de1">            eliminarValor(raf,posicio);</div></li><li class="li1"><div class="de1">          } else {</div></li><li class="li1"><div class="de1">            System.out.println(&quot;Comanda desconeguda.&quot;);</div></li><li class="li1"><div class="de1">          }</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      raf.close();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error accedint al fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** Mostra el contingut del fitxer per pantalla, escrivint 10 valors</div></li><li class="li1"><div class="de1">   * per fila. Fixeu-vos que un RandomAccessFile es pot passar com a paràmetre.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param raf Fitxer d'acces relatiu a mostrar</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void mostrarFitxer(RandomAccessFile raf) {</div></li><li class="li1"><div class="de1">    try { </div></li><li class="li1"><div class="de1">      long numEnters = raf.length()/4;</div></li><li class="li1"><div class="de1">      //Cal garantir que l'apuntador esta al principi</div></li><li class="li1"><div class="de1">      raf.seek(0);</div></li><li class="li1"><div class="de1">      for (long i = 0; i &lt; numEnters; i++) {</div></li><li class="li1"><div class="de1">        if (i%10 == 0) {</div></li><li class="li1"><div class="de1">          System.out.println();    </div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">        int valor = raf.readInt();</div></li><li class="li1"><div class="de1">        System.out.print(valor + &quot; &quot;);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error llegint fitxer: &quot; + e);    </div></li><li class="li1"><div class="de1">    }  </div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** A partir d'un fitxer d'enters, afegeix un valor al final.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param raf Fitxer a modificar</div></li><li class="li1"><div class="de1">   * @param valor Valor a afegir</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void afegirValor(RandomAccessFile raf, int valor) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      long fiFitxer = raf.length();</div></li><li class="li1"><div class="de1">      raf.seek(fiFitxer);</div></li><li class="li1"><div class="de1">      raf.writeInt(valor);</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error modificant fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  /** A partir d'un fitxer d'enters, elimina un valor.</div></li><li class="li1"><div class="de1">   *</div></li><li class="li1"><div class="de1">   * @param raf Fitxer a modificar</div></li><li class="li1"><div class="de1">   * @param posicio Posició a esborrar</div></li><li class="li1"><div class="de1">   */</div></li><li class="li1"><div class="de1">  public void eliminarValor(RandomAccessFile raf, int posicio) {</div></li><li class="li1"><div class="de1">    try {</div></li><li class="li1"><div class="de1">      if ((posicio &gt;= raf.length()/4)||(posicio &lt; 0)) {</div></li><li class="li1"><div class="de1">        System.out.println(&quot;Aquesta posició no existeix.&quot;);</div></li><li class="li1"><div class="de1">      } else {</div></li><li class="li1"><div class="de1">        long midaFinal = raf.length() - 4;</div></li><li class="li1"><div class="de1">        //Per esborrar un valor, cal desplaçar tots els posteriors a sobre</div></li><li class="li1"><div class="de1">        //de l'anterior valor.</div></li><li class="li1"><div class="de1">        long posMoure = (posicio + 1)*4;</div></li><li class="li1"><div class="de1">        while (posMoure &lt; raf.length()) {</div></li><li class="li1"><div class="de1">          raf.seek(posMoure);</div></li><li class="li1"><div class="de1">          int valor = raf.readInt();</div></li><li class="li1"><div class="de1">          raf.seek(posMoure - 4);</div></li><li class="li1"><div class="de1">          raf.writeInt(valor);</div></li><li class="li1"><div class="de1">          posMoure = posMoure + 4;</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">        //Queda el darrer valor repetit. Cal ajustar la nova mida del fitxer</div></li><li class="li1"><div class="de1">        raf.setLength(midaFinal);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    } catch (Exception e) {</div></li><li class="li1"><div class="de1">      System.out.println(&quot;Error modificant fitxer: &quot; + e);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u6/a2/continguts.html">Tractament bàsic de dades</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u6/a2/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
