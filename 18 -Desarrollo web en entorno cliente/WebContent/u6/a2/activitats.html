<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Desenvolupament web en l'entorn client</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Desenvolupament web en l'entorn client">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Desenvolupament web en l'entorn client</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u7" class="parentnode"><p><a class="unit" href="../../../WebContent/u7/introduccio.html">7. Desenvolupament de casos pràctics</a></p><ul class="expander"><li id="u7introduccio"><a href="../../../WebContent/u7/introduccio.html">Introducció</a></li><li id="u7resum"><a href="../../../WebContent/u7/resum.html">Resum</a></li><li id="u7resultats"><a href="../../../WebContent/u7/resultats.html">Resultats d'aprenentatge</a></li><li id="u7referencies"><a href="../../../WebContent/u7/referencies.html">Referències</a></li><li id="u7a1" class="tocsection"><p id='u7a1continguts'><a class="section" href="../../../WebContent/u7/a1/continguts.html">Desenvolupament de casos pràctics</a><span class="buttonexp"></span></p><ul><li id="u7a1activitats"><a href="../../../WebContent/u7/a1/activitats.html">Activitats</a></li><li id="u7a1exercicis"><a href="../../../WebContent/u7/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u7a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u7/a1/continguts.html#desenvolupament_amb_nodejs">Desenvolupament amb Node.js</a></li><li><a href="../../../WebContent/u7/a1/continguts.html#aplicacions_amb_la_biblioteca_leaflet">Aplicacions amb la biblioteca Leaflet</a></li><li><a href="../../../WebContent/u7/a1/continguts.html#desenvolupament_de_jocs_amb_html5">Desenvolupament de jocs amb HTML5</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Mecanismes de programació asíncrona client-servidor</a></li><li><a href="continguts.html">Programació de la comunicació asíncrona amb jQuery</a></li><li>Activitats</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="activitats"> Activitats </a></h1>
    	
<p>

<h2><a id="peticio_ajax_i_processament_de_resposta_xml_amb_jquery_i_dades_en_la_url" >Petició AJAX i processament de resposta XML amb jQuery i dades en la URL</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a enviar peticions AJAX i processar la resposta rebuda en format XML utilitzant la biblioteca jQuery.
</p>

<p>
Us demanen que implementeu una aplicació que utilitzi la biblioteca jQuery, que llegeixi el fitxer de dades que retorna el següent <acronym title="Uniform Resource Locator">URL</acronym> “<a href="https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml" class="urlextern" title="https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml"  rel="nofollow">https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml</a>”, que conté informació de diferents organismes de Catalunya, i el processi per afegir una taula amb aquesta informació a la seva pàgina web. No cal que us preocupeu per l’estil perquè vindrà donat per la pàgina on s’incrustarà. Podeu afegir la taula directament al cos del document <acronym title="HyperText Markup Language">HTML</acronym>.
També podeu filtrar la cerca per municipi, per exemple, passant el paràmetre <em>municipi</em> amb el valor d’un municipi català al mateix <acronym title="Uniform Resource Locator">URL</acronym> (per exemple, es podria afegir a l’<acronym title="Uniform Resource Locator">URL</acronym> el següent: <em>?municipi=Barcelona</em>).
</p>

<p>
<form action=""><div class="solution ioccontent"><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;!DOCTYPE html&gt;</div></li><li class="li1"><div class="de1">&lt;html&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;head&gt;</div></li><li class="li1"><div class="de1">&lt;meta charset=&quot;utf-8&quot;&gt;</div></li><li class="li1"><div class="de1">&lt;script src=&quot;https://code.jquery.com/jquery-3.1.0.js&quot;&gt;&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">carregarDades('https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml?municipi=Barcelona');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function carregarDades(url) {</div></li><li class="li1"><div class="de1">	$.ajax({</div></li><li class="li1"><div class="de1">		url: url,</div></li><li class="li1"><div class="de1">		success: processarResposta,</div></li><li class="li1"><div class="de1">	});</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function processarResposta(dades) {</div></li><li class="li1"><div class="de1">	let $taula = generarTaula();</div></li><li class="li1"><div class="de1">	let $organitzacions = $(dades).find('row');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	$organitzacions.each(function() {</div></li><li class="li1"><div class="de1">		let $fila = generarFila(this);</div></li><li class="li1"><div class="de1">		$taula.append($fila);</div></li><li class="li1"><div class="de1">	})</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	$('body').append($taula);</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function generarTaula() {</div></li><li class="li1"><div class="de1">	let $taula = $('&lt;table border=&quot;1&quot;&gt;');</div></li><li class="li1"><div class="de1">	let $capcalera = $('&lt;tr&gt;');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colOrg = generarColumna(&quot;Organisme&quot;, true);</div></li><li class="li1"><div class="de1">	$capcalera.append($colOrg);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colMun = generarColumna(&quot;Municipi&quot;, true);</div></li><li class="li1"><div class="de1">	$capcalera.append($colMun);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colAdr = generarColumna(&quot;Adreça&quot;, true);</div></li><li class="li1"><div class="de1">	$capcalera.append($colAdr);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colCP = generarColumna(&quot;Codi Postal&quot;, true);</div></li><li class="li1"><div class="de1">	$capcalera.append($colCP);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colTel = generarColumna(&quot;Telefon&quot;, true);</div></li><li class="li1"><div class="de1">	$capcalera.append($colTel);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colMail = generarColumna(&quot;Mail&quot;, true);</div></li><li class="li1"><div class="de1">	$capcalera.append($colMail);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	$taula.append($capcalera);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	return $taula;</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function generarFila(node) {</div></li><li class="li1"><div class="de1">	let $fila = $('&lt;tr&gt;'),</div></li><li class="li1"><div class="de1">	$node = $(node);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let nom = $node.find('organisme').text();</div></li><li class="li1"><div class="de1">	let mun = $node.find('municipi').text();</div></li><li class="li1"><div class="de1">	let adreca = $node.find('adre_a').text();</div></li><li class="li1"><div class="de1">	let CP = $node.find('codi_postal').text();</div></li><li class="li1"><div class="de1">	let tel = $node.find('tel_fon').text();</div></li><li class="li1"><div class="de1">	let mail = $node.find('email').text();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colNom = generarColumna(nom);</div></li><li class="li1"><div class="de1">	$fila.append($colNom);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colMun = generarColumna(mun);</div></li><li class="li1"><div class="de1">	$fila.append($colMun);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colAdr = generarColumna(adreca);</div></li><li class="li1"><div class="de1">	$fila.append($colAdr);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colCP = generarColumna(CP);</div></li><li class="li1"><div class="de1">	$fila.append($colCP);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colTel = generarColumna(tel);</div></li><li class="li1"><div class="de1">	$fila.append($colTel);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	let $colMail = generarColumna(mail);</div></li><li class="li1"><div class="de1">	$fila.append($colMail);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	return $fila;</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function generarColumna(contingut, esCapcalera) {</div></li><li class="li1"><div class="de1">	let $columna;</div></li><li class="li1"><div class="de1">	if (esCapcalera) {</div></li><li class="li1"><div class="de1">		$columna = $('&lt;th&gt;');</div></li><li class="li1"><div class="de1">	} else {</div></li><li class="li1"><div class="de1">		$columna = $('&lt;td&gt;');</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	$columna.html(contingut);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	return $columna;</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;/head&gt;</div></li><li class="li1"><div class="de1">&lt;/html&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/JbKKgr?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/JbKKgr?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/JbKKgr?editors=1010</a>.
</p>

<p>
Com es pot apreciar, l’enviament de la petició AJAX es realitza en invocar la funció <code>carregarDades()</code>, en què s’invoca el mètode <code>ajax()</code> de la biblioteca passant com a opcions un objecte que defineix les propietats <code>url</code> i <code>success</code>, que corresponen a l’<acronym title="Uniform Resource Locator">URL</acronym> al qual s’envia la petició (en aquest cas, el nom del fitxer) i la funció a invocar quan la resposta sigui exitosa. Com que el mètode d’enviament (<code>GET</code>) i el format de la resposta (<code>XML</code>) són els que corresponen per defecte, no cal especificar-los.
</p>

<p>
Una vegada s’obté la resposta, es pot tractar de la mateixa manera que el DOM, ja que jQuery treballa sobre elements que implementin aquesta interfície i, per consegüent, pot cercar elements, analitzar i crear nous elements tant per a <acronym title="HyperText Markup Language">HTML</acronym> com per a XML.
</p>

<p>
Cal destacar que en processar la resposta es fa servir el mètode <code>each()</code> de la funció jQuery per recórrer l’<em>array</em> de dades retornades (no s’ha de confondre amb el mètode <code>each()</code> propi dels objectes <code>jQuery</code> que itera sobre els elements que selecciona).
</p>

<p>
S’ha descompost la feina de crear la taula en diferents funcions, de manera que <code>generarTaula()</code>, <code>generarFila()</code> i <code>generarColumna()</code> s’encarreguen de generar la taula, les files i les columnes respectivament.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

</p>

<p>

<h2><a id="peticio_ajax_i_processament_de_resposta_xml_amb_jquery_i_dades_en_la_peticio" >Petició AJAX i processament de resposta XML amb jQuery i dades en la petició</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a enviar peticions AJAX afegint els paràmetres dintre de la mateixa petició AJAX, no adjuntant-los directament al mateix <acronym title="Uniform Resource Locator">URL</acronym>.
</p>

<p>
Us demanen que creeu una pàgina que mostri el següent <acronym title="HyperText Markup Language">HTML</acronym>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">  &lt;label for=&quot;municipi&quot;&gt;Municipi:&lt;/label&gt;</div></li><li class="li1"><div class="de1">	&lt;input type=&quot;text&quot; value=&quot;Barcelona&quot; id=&quot;municipi&quot;&gt;</div></li><li class="li1"><div class="de1">	&lt;br&gt;</div></li><li class="li1"><div class="de1">	&lt;label for=&quot;CP&quot;&gt;Codi Postal:&lt;/label&gt;</div></li><li class="li1"><div class="de1">	&lt;input type=&quot;text&quot; value=&quot;08005&quot; id=&quot;CP&quot;&gt;</div></li><li class="li1"><div class="de1">	&lt;br&gt;</div></li><li class="li1"><div class="de1">	&lt;button id=&quot;env&quot;&gt;Cercar&lt;/button&gt;</div></li><li class="li1"><div class="de1">	&lt;hr&gt;</div></li><li class="li1"><div class="de1">	&lt;h3&gt;Resultats:&lt;/h3&gt;</div></li><li class="li1"><div class="de1">	&lt;div id=&quot;res&quot;&gt;&lt;/div&gt;</div></li></ol></pre>

<p>
Feu que quan l’usuari polsi el botó es faci una crida AJAX al següent <acronym title="Uniform Resource Locator">URL</acronym>: “<a href="https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml" class="urlextern" title="https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml"  rel="nofollow">https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml</a>”. Haureu d’enviar els paràmetres <code>municipi</code> i <code>codi_postal</code>  dintre de la petició AJAX en compte d’afegir-los directament a l’<acronym title="Uniform Resource Locator">URL</acronym>.
</p>

<p>
Feu que els resultats es mostrin en una taula dintre del <code>div</code> inferior de l<code>‘<acronym title="HyperText Markup Language">HTML</acronym></code>, i que aquests resultats s’esborrin quan es realitzi una nova cerca.
</p>

<p>
<form action=""><div class="solution ioccontent"><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;!DOCTYPE html&gt;</div></li><li class="li1"><div class="de1">&lt;html&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;head&gt;</div></li><li class="li1"><div class="de1">&lt;meta charset=&quot;utf-8&quot;&gt;</div></li><li class="li1"><div class="de1">&lt;script src=&quot;https://code.jquery.com/jquery-3.1.0.js&quot;&gt;&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">window.onload=function(){</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	$('#env').on('click',carregarDades);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	function carregarDades() {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		$('#res').html('');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let munic = $('#municipi').val();</div></li><li class="li1"><div class="de1">		let CP = $('#CP').val();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		$.ajax({</div></li><li class="li1"><div class="de1">			url: 'https://analisi.transparenciacatalunya.cat/resource/amca-cgrp.xml',</div></li><li class="li1"><div class="de1">			data: {&quot;municipi&quot; : munic,</div></li><li class="li1"><div class="de1">					&quot;codi_postal&quot; : CP},</div></li><li class="li1"><div class="de1">			success: processarResposta,</div></li><li class="li1"><div class="de1">		});</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	function processarResposta(dades) {</div></li><li class="li1"><div class="de1">		let $taula = generarTaula();</div></li><li class="li1"><div class="de1">		let $organitzacions = $(dades).find('row');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		$organitzacions.each(function() {</div></li><li class="li1"><div class="de1">			let $fila = generarFila(this);</div></li><li class="li1"><div class="de1">			$taula.append($fila);</div></li><li class="li1"><div class="de1">		})</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		$('#res').append($taula);</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	function generarTaula() {</div></li><li class="li1"><div class="de1">		let $taula = $('&lt;table border=&quot;1&quot;&gt;');</div></li><li class="li1"><div class="de1">		let $capcalera = $('&lt;tr&gt;');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colOrg = generarColumna(&quot;Organisme&quot;, true);</div></li><li class="li1"><div class="de1">		$capcalera.append($colOrg);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colMun = generarColumna(&quot;Municipi&quot;, true);</div></li><li class="li1"><div class="de1">		$capcalera.append($colMun);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colAdr = generarColumna(&quot;Adreça&quot;, true);</div></li><li class="li1"><div class="de1">		$capcalera.append($colAdr);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colCP = generarColumna(&quot;Codi Postal&quot;, true);</div></li><li class="li1"><div class="de1">		$capcalera.append($colCP);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colTel = generarColumna(&quot;Telefon&quot;, true);</div></li><li class="li1"><div class="de1">		$capcalera.append($colTel);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colMail = generarColumna(&quot;Mail&quot;, true);</div></li><li class="li1"><div class="de1">		$capcalera.append($colMail);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		$taula.append($capcalera);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		return $taula;</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	function generarFila(node) {</div></li><li class="li1"><div class="de1">		let $fila = $('&lt;tr&gt;'),</div></li><li class="li1"><div class="de1">		$node = $(node);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let nom = $node.find('organisme').text();</div></li><li class="li1"><div class="de1">		let mun = $node.find('municipi').text();</div></li><li class="li1"><div class="de1">		let adreca = $node.find('adre_a').text();</div></li><li class="li1"><div class="de1">		let CP = $node.find('codi_postal').text();</div></li><li class="li1"><div class="de1">		let tel = $node.find('tel_fon').text();</div></li><li class="li1"><div class="de1">		let mail = $node.find('email').text();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colNom = generarColumna(nom);</div></li><li class="li1"><div class="de1">		$fila.append($colNom);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colMun = generarColumna(mun);</div></li><li class="li1"><div class="de1">		$fila.append($colMun);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colAdr = generarColumna(adreca);</div></li><li class="li1"><div class="de1">		$fila.append($colAdr);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colCP = generarColumna(CP);</div></li><li class="li1"><div class="de1">		$fila.append($colCP);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colTel = generarColumna(tel);</div></li><li class="li1"><div class="de1">		$fila.append($colTel);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		let $colMail = generarColumna(mail);</div></li><li class="li1"><div class="de1">		$fila.append($colMail);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		return $fila;</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	function generarColumna(contingut, esCapcalera) {</div></li><li class="li1"><div class="de1">		let $columna;</div></li><li class="li1"><div class="de1">		if (esCapcalera) {</div></li><li class="li1"><div class="de1">			$columna = $('&lt;th&gt;');</div></li><li class="li1"><div class="de1">		} else {</div></li><li class="li1"><div class="de1">			$columna = $('&lt;td&gt;');</div></li><li class="li1"><div class="de1">		}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		$columna.html(contingut);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		return $columna;</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">	&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;/head&gt;</div></li><li class="li1"><div class="de1">&lt;body&gt;</div></li><li class="li1"><div class="de1">	&lt;label for=&quot;municipi&quot;&gt;Municipi:&lt;/label&gt;</div></li><li class="li1"><div class="de1">	&lt;input type=&quot;text&quot; value=&quot;Barcelona&quot; id=&quot;municipi&quot;&gt;</div></li><li class="li1"><div class="de1">	&lt;br&gt;</div></li><li class="li1"><div class="de1">	&lt;label for=&quot;CP&quot;&gt;Codi Postal:&lt;/label&gt;</div></li><li class="li1"><div class="de1">	&lt;input type=&quot;text&quot; value=&quot;08005&quot; id=&quot;CP&quot;&gt;</div></li><li class="li1"><div class="de1">	&lt;br&gt;</div></li><li class="li1"><div class="de1">	&lt;button id=&quot;env&quot;&gt;Cercar&lt;/button&gt;</div></li><li class="li1"><div class="de1">	&lt;hr&gt;</div></li><li class="li1"><div class="de1">	&lt;h3&gt;Resultats:&lt;/h3&gt;</div></li><li class="li1"><div class="de1">	&lt;div id=&quot;res&quot;&gt;&lt;/div&gt;</div></li><li class="li1"><div class="de1">&lt;/body&gt;</div></li><li class="li1"><div class="de1">&lt;/html&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/VmjKMV?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/VmjKMV?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/VmjKMV?editors=1010</a>. 
</p>

<p>
Com es pot apreciar, s’ha usat el paràmetre <code>data</code> per adjuntar les dades que volem que s’enviïn amb la crida AJAX. Fixeu-vos també que aquestes dades estan en format JSON.
</p>

<p>
Finalment, s’ha descompost en tres funcions diferents  la generació de la taula, les columnes i les files, per fer el codi més entendor.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

</p>

<p>

<h2><a id="peticio_ajax_i_processament_de_resposta_json_amb_jquery" >Petició AJAX i processament de resposta JSON amb jQuery</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a enviar peticions AJAX i processar la resposta rebuda en format JSON utilitzant la biblioteca jQuery.
</p>

<p>
Us demanen que implementeu una aplicació que utilitzi la biblioteca jQuery i que realitzi una petició AJAX al següent <acronym title="Uniform Resource Locator">URL</acronym>: “<a href="https://api.scryfall.com/cards/random" class="urlextern" title="https://api.scryfall.com/cards/random"  rel="nofollow">https://api.scryfall.com/cards/random</a>”, que pertany a una <acronym title="Application Programming Interface">API</acronym> d’un conegut joc de cartes i que retorna les dades d’una carta aleatòria. Una vegada obtinguda la resposta, l’haureu de processar per afegir la informació que considereu a una taula. No cal que us preocupeu per l’estil, perquè vindrà donat per la pàgina on s’incrustarà. Podeu afegir la taula directament al cos del document <acronym title="HyperText Markup Language">HTML</acronym>.
</p>

<p>
<form action=""><div class="solution ioccontent"><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;!DOCTYPE html&gt;</div></li><li class="li1"><div class="de1">&lt;html&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;head&gt;</div></li><li class="li1"><div class="de1">  &lt;meta charset=&quot;utf-8&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;script src=&quot;https://code.jquery.com/jquery-3.1.0.js&quot;&gt;&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;/head&gt;</div></li><li class="li1"><div class="de1">&lt;body&gt;</div></li><li class="li1"><div class="de1">&lt;/body&gt;</div></li><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  carregarDades('https://api.scryfall.com/cards/random');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function carregarDades(url) {</div></li><li class="li1"><div class="de1">    $.ajax({</div></li><li class="li1"><div class="de1">      url: url,</div></li><li class="li1"><div class="de1">      dataType: 'json',</div></li><li class="li1"><div class="de1">      success: processarResposta,</div></li><li class="li1"><div class="de1">    });</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function processarResposta(dades) {</div></li><li class="li1"><div class="de1">    let $taula = generarTaula();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $fila = generarFila(dades);</div></li><li class="li1"><div class="de1">    $taula.append($fila);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    $('body').append($taula);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function generarTaula() {</div></li><li class="li1"><div class="de1">    let $taula = $('&lt;table border=&quot;1&quot;&gt;');</div></li><li class="li1"><div class="de1">    let $capcalera = $('&lt;tr&gt;');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colNom = generarColumna(&quot;Nom&quot;, true);</div></li><li class="li1"><div class="de1">    $capcalera.append($colNom);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colImatge = generarColumna(&quot;Imatge&quot;, true);</div></li><li class="li1"><div class="de1">    $capcalera.append($colImatge);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colData = generarColumna(&quot;Data Sortida&quot;, true);</div></li><li class="li1"><div class="de1">    $capcalera.append($colData);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $textCarta = generarColumna(&quot;Text carta&quot;, true);</div></li><li class="li1"><div class="de1">    $capcalera.append($textCarta);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    $taula.append($capcalera);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    return $taula;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function generarFila(dades) {</div></li><li class="li1"><div class="de1">    let $fila = $('&lt;tr&gt;');</div></li><li class="li1"><div class="de1">    let nom = dades.name;</div></li><li class="li1"><div class="de1">    let imatge = $('&lt;img src=&quot;'+dades.image_uris.small+'&quot;&gt;');</div></li><li class="li1"><div class="de1">    let data = dades.released_at;</div></li><li class="li1"><div class="de1">    let textCarta = dades.oracle_text;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colNom = generarColumna(nom);</div></li><li class="li1"><div class="de1">    $fila.append($colNom);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colImatge = generarColumna(imatge);</div></li><li class="li1"><div class="de1">    $fila.append($colImatge);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colData = generarColumna(data);</div></li><li class="li1"><div class="de1">    $fila.append($colData);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let $colText = generarColumna(textCarta);</div></li><li class="li1"><div class="de1">    $fila.append($colText);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    return $fila;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function generarColumna(contingut, esCapcalera) {</div></li><li class="li1"><div class="de1">    let $columna;</div></li><li class="li1"><div class="de1">    if (esCapcalera) {</div></li><li class="li1"><div class="de1">      $columna = $('&lt;th&gt;');</div></li><li class="li1"><div class="de1">    } else {</div></li><li class="li1"><div class="de1">      $columna = $('&lt;td&gt;');</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    $columna.html(contingut);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    return $columna;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;/html&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/BprPZO?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/BprPZO?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/BprPZO?editors=1010</a>. 
</p>

<p>
Com es pot apreciar, en aquest cas s’ha hagut d’especificar el tipus de dada (<code>json</code>), ja que, en cas contrari, s’interpretaria com a XML, el navegador llençaria una excepció i s’aturaria l’execució del programa.
</p>

<p>
Les dades són obtingudes com un objecte de JavaScript ja analitzat, així que no cal fer cap altra operació addicional per treballar amb aquestes dades.
</p>

<p>
Finalment, s’ha descompost en tres funcions diferents  la generació de la taula, les columnes i les files, per fer el codi més entendor.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

</p>

<h2><a id="enviament_de_peticions_ajax_amb_parametres_a_servidors_que_admeten_cors_mitjancant_jquery" >Enviament de peticions AJAX amb paràmetres a servidors que admeten CORS mitjançant jQuery</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a enviar peticions AJAX amb paràmetres a un servidor que implementa mecanismes CORS mitjançant la biblioteca jQuery.
</p>

<p>
Us han demanat que implementeu una funció utilitzant jQuery que permeti carregar la descripció i el resum de les enquestes que facilita l’Institut d’Estadística de Catalunya (<a href="http://www.idescat.cat/dev/api/cal/" class="urlextern" title="http://www.idescat.cat/dev/api/cal/"  rel="nofollow">www.idescat.cat/dev/api/cal</a>). Aquesta funció ha d’acceptar per paràmetre l’<acronym title="Uniform Resource Locator">URL</acronym> i un objecte JavaScript amb les propietats <code>t</code> i <code>id</code> corresponents a l’any que es vol consultar i l’identificador d’estadística, respectivament.
</p>

<p>
Per demostrar el correcte funcionament es demana que la taula mostri la informació de les enquestes de població activa (identificador <code>EPA</code>) per l’any 2012.
</p>

<p>
<form action=""><div class="solution ioccontent"><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;!DOCTYPE html&gt;</div></li><li class="li1"><div class="de1">&lt;html&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;head&gt;</div></li><li class="li1"><div class="de1">  &lt;meta charset=&quot;utf-8&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;script src=&quot;https://code.jquery.com/jquery-3.1.0.js&quot;&gt;&lt;/script&gt;</div></li><li class="li1"><div class="de1">  &lt;script&gt;</div></li><li class="li1"><div class="de1">      carregarDades('http://api.idescat.cat/cal/v1/dades.json', {t:2012, id:&quot;ipi&quot;});</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      function carregarDades(url, parametres) {</div></li><li class="li1"><div class="de1">        $.ajax({</div></li><li class="li1"><div class="de1">          url: url,</div></li><li class="li1"><div class="de1">          dataType: 'json',</div></li><li class="li1"><div class="de1">          data: parametres,</div></li><li class="li1"><div class="de1">          success: processarResposta,</div></li><li class="li1"><div class="de1">        });</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      function processarResposta(resposta) {        </div></li><li class="li1"><div class="de1">        let dades = resposta.vevent;</div></li><li class="li1"><div class="de1">        let $taula = generarTaula();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        for (let i=0; i&lt;dades.length; i++) {</div></li><li class="li1"><div class="de1">            let $fila = generarFila(dades[i].description, dades[i].summary);</div></li><li class="li1"><div class="de1">            $taula.append($fila);</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        $('body').append($taula);        </div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      function generarTaula() {</div></li><li class="li1"><div class="de1">        let $taula = $('&lt;table&gt;');</div></li><li class="li1"><div class="de1">        let $capcalera = $('&lt;tr&gt;');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        let $colDescipcio = generarColumna(&quot;Descripcio&quot;, true);</div></li><li class="li1"><div class="de1">        $capcalera.append($colDescipcio);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        let $colResum = generarColumna(&quot;Resum&quot;, true);</div></li><li class="li1"><div class="de1">        $capcalera.append($colResum);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        $taula.append($capcalera);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        return $taula;</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      function generarFila(descripcio, resum) {</div></li><li class="li1"><div class="de1">        let $fila = $('&lt;tr&gt;');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        let $colDescripcio = generarColumna(descripcio);</div></li><li class="li1"><div class="de1">        $fila.append($colDescripcio);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        let $colResum = generarColumna(resum);</div></li><li class="li1"><div class="de1">        $fila.append($colResum);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        return $fila;</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      function generarColumna(contingut, esCapcalera) {</div></li><li class="li1"><div class="de1">        let $columna;</div></li><li class="li1"><div class="de1">        if (esCapcalera) {</div></li><li class="li1"><div class="de1">          $columna = $('&lt;th&gt;');</div></li><li class="li1"><div class="de1">        } else {</div></li><li class="li1"><div class="de1">          $columna = $('&lt;td&gt;');</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        $columna.html(contingut);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        return $columna;</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  &lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;/head&gt;</div></li><li class="li1"><div class="de1">&lt;/html&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/GNqNjZ?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/GNqNjZ?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/GNqNjZ?editors=1010</a>.
</p>

<p>
Com que el servei de dades obertes de l’Institut d’Estadística de la Catalunya implementa els mecanismes necessaris per realitzar peticions des d’altres dominis, només cal realitzar una petició AJAX convencional.
</p>

<p>
jQuery simplifica la utilització de paràmetres, de manera que es pot passar directament l’objecte que conté aquests paràmetres i la biblioteca s’encarrega de fer els tractaments necessaris per realitzar la petició.
</p>

<p>
Cal destacar que el servidor ja retorna el tipus multimèdia de la resposta (<code>application/json</code>) i, per consegüent, no cal sobreescriure’l. Proveu d’eliminar la línia <code>dataType: son</code> per comprovar si continua funcionant.
</p>

<p>
Per realitzar el tractament de les dades, s’ha descompost la tasca en tres funcions diferents, així el codi és més entenedor.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

<p>

<h2><a id="enviament_de_peticions_utilitzant_jsonp_mitjancant_jquery" >Enviament de peticions utilitzant JSONP mitjançant jQuery</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a enviar peticions a servidors que admetin JSONP mitjançant la biblioteca jQuery.
</p>

<p>
Us han demanat crear un cercador de dades sobre una determinada IP que utilitzi la informació proporcionada per GeoJS (<a href="https://www.geojs.io/docs/v1/endpoints/geo/" class="urlextern" title="https://www.geojs.io/docs/v1/endpoints/geo/"  rel="nofollow">www.geojs.io/docs/v1/endpoints/geo/</a>) utilitzant la tècnica JSONP. Aquesta <acronym title="Application Programming Interface">API</acronym> proporciona dades d’una IP concreta. Podeu consultar tota la documentació necessària a la mateixa pàgina.
</p>

<p>
La vostra aplicació haurà d’incloure un quadre de text per escriure la IP que es vol cercar i, una vegada es retorni el resultat, haurà de substituir qualsevol resultat anterior pel nou i mostrar, com a mínim, l’organització a la qual pertany la IP, el país i el les coordenades.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
A la documentació es pot trobar fàcilment que per realitzar cerques sobre una IP determinada, aquesta IP s’ha de posar al final de l’<acronym title="Uniform Resource Locator">URL</acronym> seguida de la cadena <code>.js</code>.
</p>

<p>
Com que jQuery permet utilitzar la mateixa interfície del mètode <code>ajax()</code> per realitzar peticions utilitzant JSONP, només cal especificar que el <code>dataType</code> serà <code>jsonp</code> i, a banda, l’opció <code>jsonp</code> amb el nom del paràmetre que espera rebre el servei web, en aquest cas <code>callback</code>, i la resta de paràmetres són els mateixos que s’utilitzaria en una petició: <code>url</code> i <code>success</code>.
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;!DOCTYPE html&gt;</div></li><li class="li1"><div class="de1">&lt;html&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;head&gt;</div></li><li class="li1"><div class="de1">  &lt;meta charset=&quot;utf-8&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;script src=&quot;https://code.jquery.com/jquery-3.1.0.js&quot;&gt;&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;/head&gt;</div></li><li class="li1"><div class="de1">&lt;body&gt;</div></li><li class="li1"><div class="de1">  &lt;h1&gt;Cercador d'informació sobre IPs&lt;/h1&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; id=&quot;textACercar&quot; placeholder=&quot;8.8.8.8&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;button id=&quot;botoCercar&quot;&gt;Cercar&lt;/button&gt;</div></li><li class="li1"><div class="de1">  &lt;div id=&quot;resultats&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;/div&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  &lt;script&gt;</div></li><li class="li1"><div class="de1">    let $botoCercar = $('#botoCercar');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    $botoCercar.on ('click',  function() {</div></li><li class="li1"><div class="de1">      let IPACercar = $('#textACercar').val();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      $.ajax({</div></li><li class="li1"><div class="de1">        url: 'https://get.geojs.io/v1/ip/geo/'+IPACercar+'.js',</div></li><li class="li1"><div class="de1">        jsonp: 'callback',</div></li><li class="li1"><div class="de1">        dataType: 'jsonp',</div></li><li class="li1"><div class="de1">        success: processarResposta</div></li><li class="li1"><div class="de1">      });</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    });</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    function processarResposta(dades) {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      let $resultats = $('#resultats');</div></li><li class="li1"><div class="de1">      $resultats.html(''); // S'elimina el contingut anterior</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      $resultats.append(generarInfo(dades))</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    function generarInfo(dades) {</div></li><li class="li1"><div class="de1">      console.log(dades);</div></li><li class="li1"><div class="de1">      let $llistaDades = $('&lt;ul&gt;');</div></li><li class="li1"><div class="de1">      let $org = $('&lt;li&gt;');</div></li><li class="li1"><div class="de1">      $org.html(&quot;&lt;b&gt;Organització&lt;/b&gt;: &quot; + dades.organization_name);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      let $pais = $('&lt;li&gt;');</div></li><li class="li1"><div class="de1">      $pais.html(&quot;&lt;b&gt;País&lt;/b&gt;: &quot; + dades.country);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      let $coord = $('&lt;li&gt;');</div></li><li class="li1"><div class="de1">      $coord.html(&quot;&lt;b&gt;Lat&lt;/b&gt;: &quot; + dades.latitude+&quot; &lt;b&gt; /Lon&lt;/b&gt;: &quot; + dades.longitude);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      $llistaDades.append($org);</div></li><li class="li1"><div class="de1">      $llistaDades.append($pais);</div></li><li class="li1"><div class="de1">      $llistaDades.append($coord);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      return $llistaDades;</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  &lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;/body&gt;</div></li><li class="li1"><div class="de1">&lt;/html&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/oYLYPj?editors=1011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/oYLYPj?editors=1011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/oYLYPj?editors=1011</a>.
</p>

<p>
Com es pot apreciar, treballar amb JSONP i jQuery  és molt simple perquè només cal especificar l’opció <code>jsonp</code>.
</p>

<p>
Fixeu-vos que des del punt de vista de la implementació, el processament de la resposta és idèntic al que es faria amb qualsevol petició AJAX ordinària.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u6/a2/continguts.html">Programació de la comunicació asíncrona amb jQuery</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u6/a2/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
