<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Desenvolupament web en l'entorn client</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Desenvolupament web en l'entorn client">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Desenvolupament web en l'entorn client</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u5" class="parentnode"><p><a class="unit" href="../../../WebContent/u5/introduccio.html">5. Model d'objectes del document</a></p><ul class="expander"><li id="u5introduccio"><a href="../../../WebContent/u5/introduccio.html">Introducció</a></li><li id="u5resum"><a href="../../../WebContent/u5/resum.html">Resum</a></li><li id="u5resultats"><a href="../../../WebContent/u5/resultats.html">Resultats d'aprenentatge</a></li><li id="u5referencies"><a href="../../../WebContent/u5/referencies.html">Referències</a></li><li id="u5a1" class="tocsection"><p id='u5a1continguts'><a class="section" href="../../../WebContent/u5/a1/continguts.html">Programació amb el DOM (Document Object Model)</a><span class="buttonexp"></span></p><ul><li id="u5a1activitats"><a href="../../../WebContent/u5/a1/activitats.html">Activitats</a></li><li id="u5a1exercicis"><a href="../../../WebContent/u5/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u5a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u5/a1/continguts.html#estructura_del_dom_interficies_principals">Estructura del DOM. Interfícies principals</a></li><li><a href="../../../WebContent/u5/a1/continguts.html#interficies_del_dom">Interfícies del DOM</a></li><li><a href="../../../WebContent/u5/a1/continguts.html#interficie_node">Interficie 'Node'</a></li><li><a href="../../../WebContent/u5/a1/continguts.html#interficie_document">Interficie 'Document'</a></li><li><a href="../../../WebContent/u5/a1/continguts.html#la_interficie_element">La interfície 'Element'</a></li></ul></div></div><li id="u5a2" class="tocsection"><p id='u5a2continguts'><a class="section" href="../../../WebContent/u5/a2/continguts.html">Programació amb el DOM i la biblioteca jQuery</a><span class="buttonexp"></span></p><ul><li id="u5a2activitats"><a href="../../../WebContent/u5/a2/activitats.html">Activitats</a></li><li id="u5a2exercicis"><a href="../../../WebContent/u5/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u5a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u5/a2/continguts.html#introduccio_a_jquery">Introducció a jQuery</a></li><li><a href="../../../WebContent/u5/a2/continguts.html#selectors">Selectors</a></li><li><a href="../../../WebContent/u5/a2/continguts.html#crear_i_manipular_elements">Crear i manipular elements</a></li><li><a href="../../../WebContent/u5/a2/continguts.html#utilitzar_events_amb_jquery">Utilitzar Events amb jQuery</a></li><li><a href="../../../WebContent/u5/a2/continguts.html#model-vista-controlador_mvc">Model-vista-controlador (MVC)</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Esdeveniments. Manejament de formularis</a></li><li>Programació amb formularis</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="programacio_amb_formularis"> Programació amb formularis </a></h1>
    	
<p>
Els aspectes més importants que cal conèixer sobre els formularis són: per a què serveixen i com validar que la informació és correcta abans de fer-la servir. Amb l’arribada d’HTML5 els elements que formen l’estructura dels formularis van adquirir una gran quantitat de noves opcions i, d’aquesta manera, van facilitar-ne la validació i van oferir als navegadors l’opció de mostrar quadres d’entrada de dades més adients, com per exemple els selectors de dates.
</p>

<p>
Cal destacar la importància de la validació de les dades -aquest és un dels principals usos que es va donar a JavaScript inicialment. Gràcies a l’evolució del llenguatge <acronym title="HyperText Markup Language">HTML</acronym> s’ha simplificat molt aquesta tasca, ja que ara és possible incrustar regles de validació directament a les etiquetes <acronym title="HyperText Markup Language">HTML</acronym>. Tot i així, en alguns casos més complexos, com la càrrega de fitxers, continua requerint implementar la validació mitjançant JavaScript.
</p>

<p>
Una de les tècniques més potents per realitzar validacions complexes, reemplaçaments i extracció de textos és la utilització <em>expressions regulars</em>. Aquestes expressions permeten utilitzar patrons complexos per realitzar cerques a les cadenes de text. Gràcies a aquestes és possible simplificar el tractament de la informació guardada en galetes (<em>cookies</em> en anglès), ja que aquestes no utilitzen un format fàcil d’utilitzar.
</p>

<h2><a id="que_es_un_formulari" >Què és un formulari?</a></h2>
<div class="level2">

<p>
Segurament tots us haureu trobat amb formularis en paper en un moment o altre: es tracta d’un document amb uns textos que us demanen determinada informació, i uns espais en blanc per omplir-los. És a dir, la seva funció és <strong>recollir informació</strong> que més endavant <strong>serà processada</strong> d’una manera o altra.
</p>

<p>
En el cas que ens interessa el seu fi és el mateix, tot i que la seva forma és molt diferent. Pràcticament totes les pàgines que visitem diàriament tenen formularis per una banda o altra:
</p>
<ul>
<li class="level1"><div class="li"> Formularis per realitzar cerques com <a href="https://google.com" class="urlextern" title="https://google.com"  rel="nofollow">www.google.com</a>.</div>
</li>
<li class="level1"><div class="li"> Formularis per identificar-nos en una pàgina com el de <a href="https://ioc.xtec.cat/" class="urlextern" title="https://ioc.xtec.cat/"  rel="nofollow">www.ioc.xtec.cat</a>.</div>
</li>
<li class="level1"><div class="li"> Pàgines amb <em>quizzes</em> que, seleccionant unes opcions o les altres, ens mostren diferents resultats.</div>
</li>
<li class="level1"><div class="li"> Els comentaris que es publiquen a través de Facebook.</div>
</li>
<li class="level1"><div class="li"> I, per descomptat, la versió digital dels formularis paper d’ús habitual; com el de la declaració de la renda.</div>
</li>
</ul>

<p>
El seu funcionament és molt semblant als formularis en paper: ofereixen unes opcions o quadres de text per marcar o omplir; una vegada s’ha omplert aquesta informació, és <strong>recollida, enviada/entregada i processada</strong>.
</p>

<p>
S’ha de tenir en compte que un formulari només és un mitjà per introduir informació que serà enviada a un servidor o bé serà utilitzada per l’aplicació en JavaScript.
</p>
<div class="iocexample"><div class="ioccontent"><p class="ioctitle">Exemples de formularis segons la finalitat</p><ul>
<li class="level1"><div class="li"> Un exemple de formulari enviat a un servidor seria el de cerca de Google. Aquest formulari recull les dades necessàries per fer la cerca i, un cop l’usuari prem el botó, s’envien al servidor. Aquest fa la cerca amb les dades i retorna el resultat al navegador del client perquè el mostri a la finestra.</div>
</li>
<li class="level1"><div class="li"> Un exemple -molt simple- de formulari en JavaScript seria una aplicació amb dos quadres de text, en què s’han d’introduir dos nombres, i un botó que en clicar-lo mostri el resultat de la suma. En aquest formulari, quan l’usuari prem el botó, és el propi navegador qui directament fa el processament de les dades i mostra el resultat que obté.</div>
</li>
</ul>

<p>
Tots dos fan servir formularis, però amb objectius diferents.
</p>
</div></div>
</div>

<h2><a id="estructura_d_un_formulari" >Estructura d&#039;un formulari</a></h2>
<div class="level2">

<p>
En general, tots els formularis comparteixen una mateixa estructura similar a aquesta:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form&gt;</div></li><li class="li1"><div class="de1">  Introdueix el teu nom:</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; /&gt;</div></li><li class="li1"><div class="de1">  &lt;br&gt;</div></li><li class="li1"><div class="de1">  Introdueix el teu cognom:</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; /&gt;</div></li><li class="li1"><div class="de1">    &lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; value=&quot;enviar&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/eJxpVE?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/eJxpVE?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/eJxpVE?editors=1000</a>.
</p>

<p>
D’aquesta manera, tots els elements del formulari han d’anar niats dins del bloc format per l’etiqueta <code>form</code>, i tots els elements que es troben dins queden lligats a aquest formulari.
</p>

<p>
Podeu veure que dintre del formulari hi ha un element <code>input</code> que es repeteix 3 vegades. Els dos primers són de tipus <code>text</code> i això fa que es mostrin com una capsa per escriure text, mentre que el darrer és de tipus <code>submit</code> i es mostra com un botó.
</p>

<p>
Aquest últim element és imprescindible, ja que és el que ens permet enviar la informació del formulari al servidor.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
No només hi ha elements de tipus <code>text</code>, sinó que es poden afegir altres tipus d’elements, com ara: llistes, àrees de text, llistes desplegables, botons, caselles de selecció o etiquetes per associar els camps del formulari.
</p>
</div></div>
<p>
Ara bé, aquest exemple no és funcional perquè el formulari no conté informació sobre on s’ha d’enviar ni com ho ha de fer, ni hi ha manera de saber a quin concepte corresponen els quadres de text. Tota aquesta informació s’afegeix mitjançant els atributs dels elements <code>form</code> i <code>input</code>.
</p>

<p>
Un exemple més complet seria el següent:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Introdueix el teu nom:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;text&quot; name=&quot;nom&quot;/&gt;&lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Introdueix el teu cognom:</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; name=&quot;cognom&quot;/&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; value=&quot;enviar&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/WrPQmo?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/WrPQmo?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/WrPQmo?editors=1000</a>.
</p>

<p>
Aquest exemple és més interessant; hem afegit a l’element <code>form</code> els atributs <code>action=“test.php”</code> i <code>method=“GET”</code>. El primer indica que, en clicar el botó d’enviament, s’ha de passar aquesta informació a la pàgina <code>test.php</code>, mentre que el segon indica que el mètode que farem servir per passar aquesta informació és <code>GET</code>.
</p>

<p>
Si obriu les eines de desenvolupador del vostre navegador, a la pestanya de xarxa (<em>Network</em> en anglès), en clicar el botó <em>enviar</em> veureu una petició (que retornarà error 404, pàgina no trobada) fent servir el mètode <code>GET</code>.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Quan les pàgines a les quals dirigim les nostres peticions no existeixen, sempre es retorna una pàgina d’error amb el codi 404.
</p>
</div></div><div class="ioctextl"><div class="ioccontent"><p class="ioctitle"> Protocol HTTP1.1</p>
<p>
Aquest protocol és clau per al funcionament d’Internet. Entre altres elements, el protocol inclou una llista de verbs (equivalents als mètodes) i codis d’estat que són retornats juntament amb les respostes de peticions, com per exemple el codi 404 quan no es troba una pàgina o el codi 200 quan la pàgina s’ha rebut amb èxit.
En podeu trobar més informació a l’enllaç següent: <a href="https://ca.wikipedia.org/wiki/Protocol_de_transfer%C3%A8ncia_d%27hipertext" class="urlextern" title="https://ca.wikipedia.org/wiki/Protocol_de_transfer%C3%A8ncia_d%27hipertext"  rel="nofollow">wwww.goo.gl/kUzYf8</a>.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Els formularis poden fer servir els mètodes <code>POST</code> o <code>GET</code>, que es corresponen amb els mètodes del mateix nom per al protocol HTTP. Tot i que el protocol <em>HTTP1.1</em> admet més mètodes com <code>PUT</code> i <code>DELETE</code>, l’especificació d’HTML5 no els admet. Existeixen <em>frameworks</em> que afegeixen aquesta funcionalitat fent l’enviament com a <code>POST</code>, però afegint un camp ocult que indica el mètode que es vol fer servir.
</p>
</div></div><div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Serveis Web RESTful</p>
<p>
RESTful és una arquitectura de serveis web que es basa a fer servir un mateix <acronym title="Uniform Resource Locator">URL</acronym> amb diferents verbs per realitzar diferents accions. Per exemple, suposant que tenim un servei web que permet gestionar l’usuari, podríem tenir els següents <acronym title="Uniform Resource Locator">URL</acronym>:
</p>
<ul>
<li class="level1"><div class="li"> <code>www.exemple.cat/usuaris/joan</code> (GET): retorna les dades de l’usuari <code>joan</code>.</div>
</li>
<li class="level1"><div class="li"> <code>www.exemple.cat/usuaris/joan</code> (PUT): modifica les dades de l’usuari <code>joan</code>.</div>
</li>
<li class="level1"><div class="li"> <code>www.exemple.cat/usuaris/joan</code> (DELETE): elimina l’usuari <code>joan</code>.</div>
</li>
<li class="level1"><div class="li"> <code>www.exemple.cat/usuaris/</code> (POST): crea un usuari nou.</div>
</li>
<li class="level1"><div class="li"> <code>www.exemple.cat/usuaris/</code> (GET): retorna la llista completa d’usuaris.</div>
</li>
</ul>

<p>
Tot i que <acronym title="HyperText Markup Language">HTML</acronym> no admet l’ús de tots els verbs des dels formularis, sí que és possible fer crides <em>AJAX</em> que els facin servir.
</p>
</div></div>
</div>

<h3><a id="elements_d_un_formulari" >Elements d&#039;un formulari</a></h3>
<div class="level3">

<p>
Dintre de les etiquetes <code>form</code> podem trobar els mateixos elements que en qualsevol document <acronym title="HyperText Markup Language">HTML</acronym>, per aquesta raó només ens centrarem en els que són específics dels formularis, en la seva estructuració i en l’enviament de dades.
</p>

<p>
Aquesta és la llista dels elements que s’utilitzen més sovint a l’hora de crear un formulari:
</p>
<ul>
<li class="level1"><div class="li"> <strong>form</strong>: element principal que forma un formulari; totes les dades definides en elements que es trobin entre l’etiqueta d’apertura i tancament seran enviats en clicar el botó d’enviament.</div>
</li>
<li class="level1"><div class="li"> <strong>input</strong>: aquest element permet que l’usuari introdueixi dades, i pot representar-se de moltes maneres diferents: botons, quadres de text, selectors de colors…</div>
</li>
<li class="level1"><div class="li"> <strong>textarea</strong>: serveix únicament per introduir textos. A diferència de l<code>‘input</code> de tipus <code>text</code>, el <code>textarea</code> és multilineal i s’utilitza generalment per la introducció de textos llargs.</div>
</li>
<li class="level1"><div class="li"> <strong>button</strong>: aquest element crea un botó clicable que, per defecte, el seu comportament és enviar el formulari. Pot donar problemes en versions de navegadors antigues.</div>
</li>
<li class="level1"><div class="li"> <strong>label</strong>: per tal de millorar l’estructura semàntica del document és recomanable fer servir aquest element per afegir les etiquetes corresponents a cada element d’entrada de dades.</div>
</li>
<li class="level1"><div class="li"> <strong>datalist</strong> (HTML5): aquest element ens permet afegir llistes al nostre codi <acronym title="HyperText Markup Language">HTML</acronym> que poden ser utilitzades per altres elements del formulari.</div>
</li>
</ul>

<p>
Si volem elaborar llistes desplegables més complexes, haurem de fer servir els elements <code>select</code>, <code>option</code> i <code>optgroup</code>:
</p>

<p>
Tenim altres elements que es poden considerar opcionals, ja que no afecten com s’envia la informació sióo com s’estructuren les opcions:
</p>
<ul>
<li class="level1"><div class="li"> <strong>select</strong>: embolcalla tots els elements que formen la llista, i inclou l’atribut que determina el nom del paràmetre amb què s’enviarà la informació a l’atribut <code>name</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>option</strong>: aquest element conté el valor que es passarà en enviar el formulari i el text que es veurà en desplegar la llista que correspon al seu atribut <code>value</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>optgroup</strong>: serveix per agrupar les opcions de la llista, separades per un títol no seleccionable que s’especifica al seu atribut <code>label</code>.</div>
</li>
</ul>

<p>
Al contrari dels elements que es poden utilitzar individualment, aquestes llistes s’han de crear amb una estructura específica; vegem-ho:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;select name=&quot;selector&quot;&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;SEU-A&quot;&gt;Barcelona&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;SEU-B&quot;&gt;Tarragona&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;SEU-C&quot;&gt;Lleida&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;SEU-D&quot;&gt;Girona&lt;/option&gt;</div></li><li class="li1"><div class="de1">&lt;/select&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/gPqPdW?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/gPqPdW?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/gPqPdW?editors=1000</a>.
</p>

<p>
Com es pot veure en la pestanya de xarxa de les eines del desenvolupador, en fer clic sobre el botó d’enviar s’envia al servidor el paràmetre anomenat <code>selector</code> amb el valor de l’opció seleccionada, per exemple <code>SEU-A</code> si se selecciona <em>Barcelona</em>: <code>test.php?selector=SEU-A</code>
</p>

<p>
La diferència que trobem entre aquest tipus de llista i fer servir un <code>datalist</code> amb un element <code>input</code> és que aquestes llistes obliguen a seleccionar un dels elements (no es pot escriure el que vulguem) i a més permet afegir grups d’opcions gràcies a l’element <code>optgroup</code>.
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;select name=&quot;assignatura&quot;&gt;</div></li><li class="li1"><div class="de1">    &lt;optgroup label=&quot;Primer Curs&quot;&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;M01&quot;&gt;Sistemes operatius&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;M03&quot;&gt;Programació&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;/optgroup&gt;</div></li><li class="li1"><div class="de1">    &lt;optgroup label=&quot;Segon Curs&quot;&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;M06&quot;&gt;Desenvolupament d'aplicacions en entorn client&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;option value=&quot;M09&quot;&gt;Disseny d'interfícies Web&lt;/option&gt;</div></li><li class="li1"><div class="de1">    &lt;/optgroup&gt;</div></li><li class="li1"><div class="de1">&lt;/select&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/mVvVaW?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/mVvVaW?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/mVvVaW?editors=1000</a>.
</p>

<p>
En aquest cas es pot comprovar que la llista desplegable inclou les categories <em>Primer Curs</em> i <em>Segon Curs</em>, que tenen la funció de separar tots dos grups d’assignatures, i no són seleccionables.
</p>

<p>
També trobem alguns elements que, si bé no tenen efecte sobre l’enviament de dades, sí que milloren l’estructura semàntica del formulari, ja que agrupen els possibles conjunts de dades indicant clarament de què es tracta, en lloc de fer servir capçaleres i elements <code>div</code> genèrics; com ara <code>fieldset</code> i <code>legend</code>: 
</p>
<ul>
<li class="level1"><div class="li"> <strong>fieldset</strong>: permet agrupar els elements d’un formulari (vegeu la <span class="figref"><a href="#figura u4a2-01"><span>figura</span></a></span>).</div>
</li>
</ul>
<div class="iocfigure"><a name="figura u4a2-01"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Representació d’un <code>fieldset</code>

</figcaption><img src="../media/caotyra_fieldset.png" alt="" /></figure>
</div><ul>
<li class="level1"><div class="li"> <strong>legend</strong>: afegeix un títol dins d’un <code>fieldset</code>.</div>
</li>
</ul>

<p>
Vegem-ne el funcionament: 
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;style&gt;</div></li><li class="li1"><div class="de1">fieldset {</div></li><li class="li1"><div class="de1">  width: 240px;</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&lt;/style&gt;</div></li><li class="li1"><div class="de1">&lt;fieldset&gt;</div></li><li class="li1"><div class="de1">  &lt;legend&gt;Dades d'usuari&lt;/legend&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Nom d'usuari:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;text&quot; name=&quot;nom_usuari&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Contrasenya:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;password&quot; name=&quot;contrasenya&quot; /&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;/fieldset&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/KVJOOB?editors=1100" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/KVJOOB?editors=1100"  rel="nofollow">codepen.io/ioc-daw-m06/pen/KVJOOB?editors=1000</a>.
</p>

</div>

<h3><a id="element_form" >Element &#039;form&#039;</a></h3>
<div class="level3">

<p>
Tal com passa amb altres elements, si volem poder identificar fàcilment un formulari, hem d’especificar el seu atribut <code>id</code>, que ha de ser únic entre els elements de la pàgina. Això ens permet lligar-lo a elements externs a l’estructura del formulari, i accedir de forma fàcil i ràpida a través de JavaScript.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Atributs de &#039;form&#039;</p>
<p>
Podeu trobar una descripció completa de les propietats de l’element <code>form</code> en l’enllaç següent: <a href="https://developer.mozilla.org/es-ES/docs/Web/HTML/Element/form" class="urlextern" title="https://developer.mozilla.org/es-ES/docs/Web/HTML/Element/form"  rel="nofollow">www.goo.gl/p5DRi8</a>.
</p>
</div></div>
<p>
L’element <code>form</code> accepta dos mètodes per enviar les dades: <code>POST</code> i <code>GET</code>. A banda de la intenció que tinguem quan enviem les dades, cal tenir en compte algunes diferències importants entre tots dos; vegem-les:
</p>
<ul>
<li class="level1"><div class="li"> <strong>GET</strong>: els valors dels paràmetres es passen al servidor a través de l’<acronym title="Uniform Resource Locator">URL</acronym>. El format és l’<acronym title="Uniform Resource Locator">URL</acronym> de destí, seguida d’un interrogant (<code>?</code>), afegint els parells de paràmetre-valor units amb un signe d’igual (<code>=</code>), i encadenant els següents paràmetres amb el símbol (<code>&amp;</code>). Per exemple, si tenim els paràmetres <code>nom</code> i <code>cognom</code>, en enviar el formulari l’<acronym title="Uniform Resource Locator">URL</acronym> resultant podria ser semblant a <code>test.php?nom=john&amp;cognom=doe</code>. A causa de la manera com es passen les dades hi ha una limitació de longitud imposada pels servidors -no per l’especificació-, i <strong>no s’ha de fer servir <code>GET</code> per enviar grans volums de dades o text</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>POST</strong>: aquest mètode afegeix els paràmetres dins de la capçalera, de manera que ni és visible a l’<acronym title="Uniform Resource Locator">URL</acronym> ni té la mida limitada. Cal tenir en compte que encara que no siguin visibles a l’<acronym title="Uniform Resource Locator">URL</acronym> <strong>no estan encriptats ni amagats</strong>: des del panell de xarxa de les eines de desenvolupador dels navegadors es poden veure els paràmetres enviats amb la capçalera. </div>
</li>
</ul>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Limitació de la mida de l&#039;URL</p>
<p>
Si volem assegurar-nos que les peticions <code>GET</code> es fan correctament, hem de tenir en compte que els navegadors més antics no admeten <acronym title="Uniform Resource Locator">URL</acronym> de més de 255 bytes; per exemple, Internet Explorer només admet fins a 2.083 caràcters (<a href="https://support.microsoft.com/en-us/kb/208427" class="urlextern" title="https://support.microsoft.com/en-us/kb/208427"  rel="nofollow">www.goo.gl/Xj7loh</a>).
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Es recomana fer servir el mètode <code>GET</code> per l’enviament d’un volum de dades baix o si volem que es generi un <acronym title="Uniform Resource Locator">URL</acronym> amb els paràmetres. Els <acronym title="Uniform Resource Locator">URL</acronym> generats d’aquesta manera ens permeten fer proves més fàcilment o guardar els enllaços per visitar-los posteriorment.
</p>

<p>
En tots els altres casos, com poden ser enviar fitxers o volums importants de dades o si desitgem que no es vegin a l’<acronym title="Uniform Resource Locator">URL</acronym> els paràmetres enviats, farem servir <code>POST</code>.
</p>
</div></div>
<p>
Un altre atribut molt important és el <code>enctype</code>. Aquest atribut especifica el tipus de format (<em>media type</em> o <em>MIME type</em>) que s’envia al servidor:
</p>
<ul>
<li class="level1"><div class="li"> <strong>application/x-www-form-urlencoded</strong>: aquest és el <strong>valor per defecte</strong> que s’assigna si no s’especifica res.</div>
</li>
<li class="level1"><div class="li"> <strong>multipart/form-data</strong>: aquest valor és el que s’ha d’especificar <strong>si volem enviar fitxers</strong> juntament amb el nostre formulari. Amb aquest tipus de format sempre s’ha de fer servir el mètode <code>POST</code>.</div>
</li>
</ul>

<p>
Així doncs, un formulari amb enviament de fitxers quedaria així:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot; id=&quot;form-principal&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;file&quot; /&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/LGqxWm?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/LGqxWm?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/LGqxWm?editors=1000</a>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Amb HTML5 s’han afegit algunes propietats als botons (tant els elements <code>button</code> com els <code>input</code> de tipus botó) que permeten modificar com s’envia el formulari. Aquestes propietats sobreescriuen el comportament normal en enviar el formulari clicant el botó; són les següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>formaction</strong> especifica on s’envien les dades del formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>formenctype</strong> especifica el tipus de format per enviar les dades.</div>
</li>
<li class="level1"><div class="li"> <strong>formmethod</strong> especifica el mètode que es farà servir per enviar les dades.</div>
</li>
<li class="level1"><div class="li"> <strong>formnovalidate</strong> salta la validació de les dades.</div>
</li>
</ul>
</div></div>
</div>

<h3><a id="element_input" >Element &#039;input&#039;</a></h3>
<div class="level3">

<p>
L’element <code>input</code> es va enriquir moltíssim amb HTML5. Mentre que altres elements es mantenen pràcticament igual que en versions anteriors, a aquest se li han afegit una gran quantitat de tipus que no són disponibles als navegadors antics o fins i tot en alguns navegadors actuals. Per aquesta raó, cal distingir entre els elements que són compatibles amb versions anteriors i aquells que es van afegir amb HTML5 (podeu comprovar les compatibilitats amb els diferents navegadors a la pàgina <a href="https://caniuse.com/?search=input%20type" class="urlextern" title="https://caniuse.com/?search=input%20type"  rel="nofollow">https://caniuse.com/?search=input%20type</a>).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Fixeu-vos que l’element <code>input</code>, al contrari que la majoria dels elements <acronym title="HyperText Markup Language">HTML</acronym>, s’autotanca: <code>type=“text” /&gt;</code>. Com que no ha de contenir res al seu interior <strong>no cal afegir una etiqueta de tancament independent</strong>, igual que passa amb l’element <code>img</code>.
</p>
</div></div>
<p>
Els atributs comuns d’ús més freqüent i, per tant, compatibles amb versions anteriors, són:
</p>
<div class="iocnote"><div class="ioccontent">
<p>
En general, quan parlem d’un element de tipus <code>input</code>, ens referim a un camp del formulari.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Atributs d&#039;input</p>
<p>
Podeu trobar una llista completa dels atributs d<code>‘input</code> al següent enllaç: <a href="https://developer.mozilla.org/es/docs/Web/HTML/Elemento/input" class="urlextern" title="https://developer.mozilla.org/es/docs/Web/HTML/Elemento/input"  rel="nofollow">www.goo.gl/jSaZgH</a>.
</p>
</div></div><ul>
<li class="level1"><div class="li"> <strong>id</strong>: ens permet identificar unívocament l’element, de manera que el podem manipular fàcilment des de codi, i ens serveix per enllaçar-lo amb elements <code>label</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>name</strong>: aquest atribut és indispensable per poder enviar dades, ja que el seu valor és el que es fa servir com a nom del paràmetre.</div>
</li>
<li class="level1"><div class="li"> <strong>value</strong>: valor per defecte o valor actual del camp, segons el seu tipus.</div>
</li>
<li class="level1"><div class="li"> <strong>disabled</strong> (booleà): quan s’aplica aquest atribut el camp estarà desactivat i es mostrarà amb un estil diferent per destacar-ho. Els valors dels camps amb aquest atribut <strong>no s’envien amb el formulari</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>readonly</strong>: similar a <code>disabled</code>, però no canvia l’estil de representació i només funciona amb alguns tipus. A diferència de <code>disabled</code>, els valors d’aquests camps <strong>sí que s’envien amb el formulari</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>size</strong>: permet establir la mida del control, <strong>en caràcters, si conté text</strong>, o en píxels si es tracta d’altres tipus i treballem amb navegadors antics. En HTML5 aquest atribut només s’aplica a elements que contenen text, així que sempre s’aplica com a nombre de caràcters.</div>
</li>
<li class="level1"><div class="li"> <strong>maxlength</strong>: en els camps de tipus text com <code>text</code>, <code>email</code>, <code>password</code>, etc. especifica el nombre màxim de caràcters que admet.</div>
</li>
</ul>

<p>
Proveu l’exemple següent per veure la diferència entre els camps activats i els desactivats:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">L&#039;atribut booleà</p>
<p>
Un atribut booleà només pot tenir dos valors: <code>true</code> i <code>false</code> (cert i fals); aquests valors són admesos pels operadors lògics ( &amp;&amp;, || i ! ). En el cas dels formularis, l’existència de l’atribut equival a <code>true</code> i l’absència a <code>false</code>, independentment del valor assignat.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">Quan fer servir la propietat &#039;size&#039;</p>
<p>
No és recomanable fer servir la propietat <code>size</code>, ja que per modificar l’estil és més apropiat utilitzar <acronym title="Cascading Style Sheets">CSS</acronym>. Però si es fa servir juntament amb la propietat <code>maxlength</code> s’aconsegueix un quadre de text de la mida exacta.
</p>
</div></div><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;input type='text' value=&quot;aquest text es troba activat&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;input type='text' disabled value=&quot;aquest text es troba desactivat&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Casella desactivada</div></li><li class="li1"><div class="de1">  &lt;input type='checkbox' disabled /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Casella activada</div></li><li class="li1"><div class="de1">  &lt;input type='checkbox' /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Casella desactivada i marcada</div></li><li class="li1"><div class="de1">  &lt;input type='checkbox' disabled checked/&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Casella activada i marcada</div></li><li class="li1"><div class="de1">  &lt;input type='checkbox' checked/&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/eJxvvj?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/eJxvvj?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/eJxvvj?editors=1000</a>.
</p>

<p>
En el següent exemple, podeu veure la diferència entre un camp amb la mida establerta com a propietat <code>size</code> o fent servir <acronym title="Cascading Style Sheets">CSS</acronym>, i l’efecte de la propietat <code>maxlength</code>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;style&gt;</div></li><li class="li1"><div class="de1">  label {</div></li><li class="li1"><div class="de1">    display:block; /* això evita haver d'afegir un salt de línia */</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">  .mida {</div></li><li class="li1"><div class="de1">    width: 5em;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/style&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Quadre amb size=&quot;5&quot;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; size=&quot;5&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Quadre amb estil CSS width=&quot;5em&quot;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; class=&quot;mida&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Quadre amb size=&quot;5&quot; i maxlength=&quot;5&quot;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; size=&quot;5&quot; maxlength=&quot;5&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Quadre amb estil CSS width=&quot;5em&quot; i maxlength=&quot;5&quot;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; class=&quot;mida&quot; maxlength=&quot;5&quot;/&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Quadre amb size=&quot;10&quot; i maxlength=&quot;5&quot;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; size=&quot;10&quot; maxlength=&quot;5&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/GozeMe?editors=1100" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/GozeMe?editors=1100"  rel="nofollow">codepen.io/ioc-daw-m06/pen/GozeMe?editors=1000</a>.
</p>

<p>
Entre els elements que <strong>només estan disponibles per a HTML5</strong> trobem els següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>placeholder</strong>: si s’especifica aquest atribut, es mostra un text quan el camp és buit; generalment s’aprofita per indicar a l’usuari què s’espera que s’introdueixi en aquest camp, per exemple: <em>introdueix el teu nom</em>. Aquest atribut només està disponible per als elements que contenen text i no compta com a contingut per al camp, és a dir, si s’envia el formulari i no hem afegit cap text, s’enviarà buit.</div>
</li>
<li class="level1"><div class="li"> <strong>autofocus</strong> (booleà): només es pot fer servir en un element per document. Fa que aquest element sigui el seleccionat automàticament en carregar la pàgina.</div>
</li>
<li class="level1"><div class="li"> <strong>form</strong>: permet indicar l<code>‘id</code> d’un formulari al qual s’enllaçarà aquest element. Gràcies a aquest atribut és possible afegir un element fora de l’estructura del formulari però que les seves dades s’enviïn juntament amb el formulari amb l<code>‘id</code> especificat.</div>
</li>
<li class="level1"><div class="li"> <strong>autocomplete</strong>: habilita la funció d’autocompletar del navegador per al tipus que s’indiqui, per exemple: <code>email</code>, <code>tel</code>, <code>bday</code>, <code>postal-code</code>, etc.</div>
</li>
<li class="level1"><div class="li"> <strong>list</strong>: s’utilitza juntament amb l’element <code>datalist</code>; afegeix la llista especificada a aquest atribut com a valors per mostrar.</div>
</li>
<li class="level1"><div class="li"> <strong>required</strong> (booleà): quan hi ha aquest atribut, el camp ha de tenir algun valor abans de poder enviar el formulari. No tots els camps admeten aquest atribut.</div>
</li>
<li class="level1"><div class="li"> <strong>pattern</strong>: el valor és una expressió regular que es fa servir per validar el contingut del camp. Només s’aplica quan el tipus de camp conté text.</div>
</li>
</ul>

<p>
Fixeu-vos com fent servir l’atribut <code>placeholder</code> es fa molt més entenedor com s’ha d’omplir el formulari:
</p>
<div class="iocreference"><div class="ioccontent">
<p>
Les expressions regulars es veuran detalladament en la secció “Expressions regulars” d’aquest mateix apartat.
</p>
</div></div><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;style&gt;</div></li><li class="li1"><div class="de1">  label {</div></li><li class="li1"><div class="de1">    display: block;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  input {</div></li><li class="li1"><div class="de1">    width: 20em;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/style&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; name=&quot;dni&quot; placeholder=&quot;Introdueix el teu DNI incloent la lletra&quot;/&gt;</div></li><li class="li1"><div class="de1">  DNI</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;email&quot; name=&quot;email&quot; placeholder=&quot;Introdueix una adreça de correu vàlida&quot;/&gt;</div></li><li class="li1"><div class="de1">  Correu electrònic</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/zreXBL" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/zreXBL"  rel="nofollow">codepen.io/ioc-daw-m06/pen/zreXBL?editors=1100</a>.
</p>

<p>
Vegem un exemple de com s’enllaça un element extern a l’estructura del formulari:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form id=&quot;principal&quot; action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; name=&quot;element-intern&quot; value=&quot;intern&quot; /&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot;/&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li><li class="li1"><div class="de1">&lt;input type=&quot;text&quot; name=&quot;element-extern&quot; value=&quot;extern&quot; form=&quot;principal&quot; /&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/RrvdMv?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/RrvdMv?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/RrvdMv?editors=1000</a>.
</p>

<p>
Si us fixeu en el panell de xarxa de les eines de desenvolupador, veureu que en fer clic sobre el botó “enviar” la petició que s’envia conté els paràmetres <code>element-intern</code> i <code>element-extern</code>, tot i que el camp corresponent a <code>element-extern</code> es troba fora de l’estructura del <code>form</code>.
</p>

<p>
Vegem, ara, el funcionament d’un element <code>data-list</code> juntament amb l’atribut <code>list</code> en un altre camp:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;label&gt;Selecciona una seu:</div></li><li class="li1"><div class="de1">  &lt;input list=&quot;seus&quot; name=&quot;seu&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;datalist id=&quot;seus&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Barcelona&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Girona&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Lleida&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Tarragona&quot;&gt;</div></li><li class="li1"><div class="de1">&lt;/datalist&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/gPqyMa?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/gPqyMa?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/gPqyMa?editors=1000</a>.
</p>

<p>
Fixeu-vos que l’element <code>input</code> conté com a atribut <code>list</code> l’identificador de l’element <code>datalist</code>.
</p>

</div>

<h4><a id="tipus_de_l_element_inputl_atribut_type" >Tipus de l&#039;element &#039;input&#039;: l&#039;atribut &#039;type&#039;</a></h4>
<div class="level4">

<p>
Encara que es tracti només d’un atribut, les diferències entre seleccionar un tipus o un altre són tan importants que cal tractar-les en una secció a part.
</p>

<p>
D’una banda, podem definir dos grans grups:
</p>
<ul>
<li class="level1"><div class="li"> Els que tracten amb text; com serien el tipus <code>text</code>, <code>password</code> o <code>email</code>.</div>
</li>
<li class="level1"><div class="li"> Els que afegeixen un component completament diferent; com són una casella de selecció (<code>checkbox</code>), un botó de selecció única (<code>radiobutton</code>) o un botó per afegir fitxers (<code>file</code>).</div>
</li>
</ul>

<p>
D’altra banda, amb HTML5 es van afegir una gran quantitat de components amb noves funcionalitats, com el tipus <code>time</code> per introduir hores; <code>date</code> per introduir dates; <code>email</code>, que es tracta com un camp de text però valida automàticament que sigui una adreça de correu vàlida, o <code>range</code>, que mostra una barra per seleccionar un valor entre un mínim i un màxim.
</p>

<p>
En la llista següent, trobareu alguns dels diferents tipus que admeten tots els navegadors:
</p>
<ul>
<li class="level1"><div class="li"> <strong>button</strong>: el camp es tracta com un botó sense cap comportament per defecte.</div>
</li>
<li class="level1"><div class="li"> <strong>submit</strong>: es mostra com un botó però el seu comportament per defecte és enviar el formulari en fer clic.</div>
</li>
<li class="level1"><div class="li"> <strong>reset</strong>: en aquest cas també es mostra un botó, i el comportament per defecte és restablir tots els camps del formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>image</strong>: en cas de voler fer servir una imatge personalitzada en lloc d’un botó d’enviament es pot fer servir aquest tipus.</div>
</li>
<li class="level1"><div class="li"> <strong>text</strong>: quadre de text bàsic per introduir qualsevol tipus de text; es mostra en una sola línia.</div>
</li>
<li class="level1"><div class="li"> <strong>password</strong>: és com el tipus <code>text</code>, però no mostra els caràcters introduïts per pantalla.</div>
</li>
<li class="level1"><div class="li"> <strong>hidden</strong>: els camps d’aquest tipus no són visibles a la pàgina, tot i que el seu valor s’enviarà juntament amb el formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>checkbox</strong>: el camp serà una casella de selecció.</div>
</li>
<li class="level1"><div class="li"> <strong>radio</strong>: afegeix un botó de selecció única que només permet seleccionar un dels valors; si se’n selecciona un altre, es desselecciona l’anterior. Es considera que <strong>tots els botons de selecció única que tenen la propietat <code>name</code> igual pertanyen al mateix grup</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>file</strong>: afegeix un component d’enviament de fitxers que consta d’un botó i una etiqueta que indica el fitxer (o fitxers en HTML5) que s’enviaran juntament amb el formulari.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
Recordeu que per poder enviar fitxers juntament amb el formulari, cal fer servir el mètode <code>POST</code> i l<code>‘enctype</code>  ha de ser <code>multipart/form-data</code>.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Camps ocults (hidden)</p>
<p>
Els camps ocults ens permeten afegir informació que s’ha d’enviar amb el formulari, però que no ha de ser modificada per l’usuari. Per exemple, en un formulari per demanar més informació d’un producte que es trobi en una pàgina cal incloure l’identificador únic del producte com a valor ocult, ja que aquest no ha de ser modificat per l’usuari.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
L’estil de l’element de tipus <code>file</code> <strong>no es pot modificar mitjançant <acronym title="Cascading Style Sheets">CSS</acronym></strong>; ja que la implementació d’aquest component no forma part de l’especificació d’<acronym title="HyperText Markup Language">HTML</acronym> i cada fabricant la fa d’una manera diferent. Les solucions per donar format a aquest element impliquen implementar el nostre propi component en JavaScript o fer servir biblioteques externes.
</p>
</div></div>
<p>
Vegeu, en aquest exemple, l’aspecte de cadascun d’aquests tipus:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;POST&quot; action=&quot;test.php&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;button&quot; value=&quot;No fa res&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; value=&quot;Envia el formulari&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;reset&quot; value=&quot;Restableix el formulari&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; value=&quot;Camp de tipus text&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;password&quot; value=&quot;Camp de tipus password&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;hidden&quot; value=&quot;Camp ocult&quot; /&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;checkbox&quot; /&gt;Tipus checkbox&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;radio&quot; name=&quot;exemple&quot;/&gt;Tipus radio 1&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;radio&quot; name=&quot;exemple&quot;/&gt;Tipus radio 2&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;file&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/dGaBdj?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/dGaBdj?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/dGaBdj?editors=1000</a>.
</p>

<p>
El resultat que obtindreu serà similar al de la <span class="figref"><a href="#figura u4a2-02"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="figura u4a2-02"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Representació d’elements ‘input’ d’<acronym title="HyperText Markup Language">HTML</acronym>

</figcaption><img src="../media/captura_tipus_input_html.png" alt="" /></figure>
</div>
<p>
Podeu comprovar que com que els dos botons de selecció única tenen el mateix nom (<code>exemple</code>), només n’hi pot haver un de seleccionat en un moment donat.
</p>

<p>
Amb HTML5 es van afegir molts més tipus, amb funcionalitats que abans requerien ser programades pel nostre compte en JavaScript o fer servir llibreries externes. Així, s’ha de tenir en compte que no existeixen en navegadors antics o que fins i tot poden no ser compatibles amb alguns dels navegadors actuals. Per aquesta raó, si voleu que funcioni correctament en tot tipus de navegadors, s’ha de proporcionar a l’usuari una alternativa.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle"> Incongruències entre l&#039;atribut &#039;value&#039; i el contingut d&#039;un camp</p>
<p>
En alguns casos ens trobarem que hi ha discrepàncies entre l’un i l’altre. Això és a causa del fet que l’especificació d’<acronym title="HyperText Markup Language">HTML</acronym> indica un format que és el que s’utilitza internament, mentre que a la representació del navegador se n’utilitza una altra de basada en la configuració de llenguatge i idioma. Per exemple, ens trobem amb aquests casos quan treballem amb nombres reals i dades.
</p>
</div></div>
<p>
En la següent llista, trobareu alguns dels diferents tipus que no admeten els navegadors antics:
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Alguns dels nous tipus són versions modificades dels originals, que afegeixen capacitats de validació, com per exemple el tipus <code>email</code>.
</p>
</div></div><ul>
<li class="level1"><div class="li"> <strong>email</strong>: obliga a introduir una adreça de correu vàlida per enviar el formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>number</strong>: només permet escriure nombres, i per passar la validació cal que sigui un nombre vàlid.</div>
</li>
<li class="level1"><div class="li"> <strong>url</strong>: és un quadre de text que obliga a introduir una adreça <acronym title="Uniform Resource Locator">URL</acronym> vàlida, incloent-hi el protocol.</div>
</li>
<li class="level1"><div class="li"> <strong>range</strong>: aquest tipus mostra una barra per seleccionar el valor desplaçant el marcador. Es pot configurar fent servir els atributs <code>max</code>, <code>min</code> i <code>step</code> per indicar els valors màxims, mínims i els increments respectivament.</div>
</li>
<li class="level1"><div class="li"> <strong>date</strong>: serveix per introduir dates, i pot mostrar un selector de dates que ens permet seleccionar-les en lloc d’afegir-les manualment.</div>
</li>
<li class="level1"><div class="li"> <strong>time</strong>: és similar a l’anterior però per introduir hores i minuts; en aquest cas no es mostra cap component extra per seleccionar-les.</div>
</li>
<li class="level1"><div class="li"> <strong>color</strong>: permet seleccionar un color de dintre d’una paleta de colors.</div>
</li>
</ul>

<p>
Vegeu en aquest exemple l’aspecte de cadascun d’aquests tipus:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Tipus email:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;email&quot; value=&quot;test@exemple.cat&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Tipus number:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;number&quot; value=&quot;42&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Tipus url:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;url&quot; value=&quot;http://ioc.xtec.cat&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Tipus range:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;range&quot; value=&quot;42&quot; min=&quot;1&quot; max=&quot;100&quot; step=&quot;2&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Tipus date:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;date&quot; value=&quot;1963-11-22&quot;/&gt;&lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Tipus time:</div></li><li class="li1"><div class="de1">    &lt;input type=&quot;time&quot; value=&quot;08:15&quot;/&gt;&lt;/label&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/vLboBw?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/vLboBw?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/vLboBw?editors=1000</a>.
</p>

<p>
Fixeu-vos en el camp de tipus <code>date</code>: tot i que el valor s’ha afegit amb el format <code>aaaa-mm-dd</code> (el corresponent a l’especificació d’<acronym title="HyperText Markup Language">HTML</acronym>), el format que es mostra al navegador és <code>dd/mm/aaaa</code>, el corresponent a la nostra llengua. Una cosa semblant passa amb els decimals: en el codi hem de fer servir el punt com a separador, mentre que per introduir les dades es fa servir la coma.
</p>

<p>
A la <span class="figref"><a href="#figura u4a2-03"><span>figura</span></a></span> podeu veure un exemple de representació de diferents elements afegits a HTML5.
</p>
<div class="iocfigure"><a name="figura u4a2-03"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Representació d’elements input d’HTML5

</figcaption><img src="../media/captura_tipus_input_html5.png" alt="" /></figure>
</div><div class="iocimportant"><div class="ioccontent">
<p>
Tot i que l’element <code>input</code> accepta més tipus, en aquests materials ens hem limitat a enumerar els que s’utilitzen més habitualment.
</p>
</div></div>
</div>

<h3><a id="element_textarea" >Element &#039;textarea&#039;</a></h3>
<div class="level3">

<p>
Aquest element té un funcionament similar al d’un element <code>input</code> de tipus text, però la diferència principal és que aquest és multilineal, fet que permet escriure extensions més grans de text i incloure salts de línia.
</p>

<p>
Primerament, veurem algunes diferències de funcionament entre aquest element i l’element <code>input</code>. A diferència d’aquest últim, el <code>textarea</code> no s’autotanca: s’ha d’afegir l’etiqueta de tancament, i el valor del camp és el que es troba entre l’etiqueta d’obertura i de tancament, per exemple:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let textarea = document.getElementById('test');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function mostrarValor() {</div></li><li class="li1"><div class="de1">    alert(textarea.value);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;textarea id=&quot;test&quot;&gt;Aquest es el valor del camp&lt;/textarea&gt;</div></li><li class="li1"><div class="de1">&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;mostrarValor();&quot;&gt;Mostrar valor&lt;/button&gt;</div></li></ol></pre>

<p>
Fixeu-vos que el valor inicial s’obté del text contingut entre les etiquetes d’apertura i tancament del <code>textarea</code>, però una vegada que el modifiqueu, el valor que es mostra en clicar el botó és el que conté el <code>textarea</code>.
</p>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/LGoowV?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/LGoowV?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/LGoowV?editors=1010</a>.
</p>

<p>
Vegem-ne ara un altre exemple molt semblant:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let textarea = document.getElementById('test');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function mostrarValor() {</div></li><li class="li1"><div class="de1">    alert(textarea.value);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;textarea id=&quot;test&quot; value=&quot;Aquest es el valor del camp&quot;&gt;&lt;/textarea&gt;</div></li><li class="li1"><div class="de1">&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;mostrarValor();&quot;&gt;Mostrar valor&lt;/button&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/XXwwvQ?editors=1011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/XXwwvQ?editors=1011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/XXwwvQ?editors=1011</a>.
</p>

<p>
En aquest cas hem establert el mateix text que abans com a valor de la propietat del <code>textarea</code>, però <strong>tant el <code>textarea</code> com el missatge d’alerta mostrat pel navegador són buits</strong>. És a dir, si ho establim com a valor des de la declaració <acronym title="HyperText Markup Language">HTML</acronym>, aquest valor és ignorat.
</p>

<p>
Però què passa si intentem establir el valor del <code>textarea</code> per codi?
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let textarea = document.getElementById('test');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  textarea.value = &quot;Valor establert via codi&quot;;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function mostrarValor() {</div></li><li class="li1"><div class="de1">    alert(textarea.value);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;textarea id=&quot;test&quot;&gt;&lt;/textarea&gt;</div></li><li class="li1"><div class="de1">&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;mostrarValor();&quot;&gt;Mostrar valor&lt;/button&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/vLwqNg?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/vLwqNg?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/vLwqNg?editors=1010</a>.
</p>

<p>
Com es pot veure, es mosta el text introduït per codi. Per tant, podem concloure que:
</p>
<ul>
<li class="level1"><div class="li"> Si necessitem afegir un text per defecte a un <code>textarea</code> des de l’<acronym title="HyperText Markup Language">HTML</acronym>, ho hem de fer entre les etiquetes d’apertura i tancament.</div>
</li>
<li class="level1"><div class="li"> Si ho hem de fer mitjançant codi, ho farem a través de la propietat <code>value</code>.</div>
</li>
</ul>

<p>
Finalment ens queda un dubte per resoldre: com reacciona el <code>textarea</code> en establir el seu contingut amb la propietat <code>innerHTML</code>?
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let textarea = document.getElementById('test');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  textarea.innerHTML = &quot;Valor establert via codi amb innerHTML&quot;;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function mostrarValor() {</div></li><li class="li1"><div class="de1">    alert(textarea.value);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;textarea id=&quot;test&quot; value=&quot;Aquest és el valor del camp&quot;&gt;&lt;/textarea&gt;</div></li><li class="li1"><div class="de1">&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;mostrarValor();&quot;&gt;Mostrar valor&lt;/button&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/xZNoEG?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/xZNoEG?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/xZNoEG?editors=1010</a>.
</p>

<p>
L’efecte és similar, però s’ha de tenir en compte una diferència important: si inspeccionem l’element <code>textarea</code> amb les eines de desenvolupador, veurem que si establim l’atribut <code>value</code> d’aquest element el codi <acronym title="HyperText Markup Language">HTML</acronym> inspeccionat no ha canviat, continua buit. En canvi, si ho fem mitjançant <code>innerHTML</code>, en inspeccionar l’element veurem que el valor és entre les etiquetes del <code>textarea</code> perquè amb <code>innerHTML</code> <strong>es modifica l’estructura del document</strong>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Tot i que la funció del <code>textarea</code> és la mateixa que la del <code>input</code> de tipus <code>text</code>, té unes diferències de funcionament importants que s’han de tenir en compte.
</p>

<p>
Podem canviar el contingut d’un <code>textarea</code> tant a través de la propietat <code>value</code> com de la propietat <code>innerHTML</code>, però <strong>es recomana fer servir <code>value</code></strong>, ja que és més coherent amb el tractament de dades, mentre que <code>innterHTML</code> en modifica l’estructura.
</p>
</div></div>
<p>
El <code>textarea</code> compta amb moltes menys opcions que l’element <code>input</code>, ja que aquest element acompleix una funció molt específica. Tot i així s’ha afegit noves propietats a HTML5 i cal diferenciar-les; si més no, per ser conscient de quines propietats no són compatibles amb navegadors antics. Vegem, primer, les propietats de les versions anteriors:
</p>
<ul>
<li class="level1"><div class="li"> <strong>id</strong>: idèntic que en el cas de l’element <code>input</code>. Ens permet identificar-lo unívocament i enllaçar-lo amb elements <code>label</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>name</strong>: igual que en l’element input, aquest és el nom del paràmetre que s’enviarà amb el formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>value</strong>: aquesta propietat no té cap efecte si l’apliquem com a etiqueta <acronym title="HyperText Markup Language">HTML</acronym>, en canvi, ens permet obtenir el contingut del <code>textarea</code> quan hi accedim des de JavaScript.</div>
</li>
<li class="level1"><div class="li"> <strong>disabled</strong> (booleà): quan s’aplica aquest atribut el contingut no serà modificable, es presentarà amb un estil diferent, i els seus continguts no s’enviaran amb el formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>readonly</strong> (booleà): similar a l’anterior, però en aquest cas les dades sí que són enviades.</div>
</li>
<li class="level1"><div class="li"> <strong>cols</strong>: especifica l’amplada de l’àrea de text en caràcters, de manera similar al funcionament de l’atribut <code>size</code> amb els camps de text.</div>
</li>
<li class="level1"><div class="li"> <strong>rows</strong>: nombre de files de text que es veuran. S’ha de tenir en compte que encara que <code>cols</code> i <code>row</code> tracten amb l’aparença en lloc de l’estructura, no es pot fer servir <acronym title="Cascading Style Sheets">CSS</acronym> en aquest cas perquè <acronym title="Cascading Style Sheets">CSS</acronym> no treballa amb caràcters.</div>
</li>
<li class="level1"><div class="li"> <strong>selectionStart</strong>: indica l’índex del primer caràcter seleccionat.</div>
</li>
<li class="level1"><div class="li"> <strong>selectionEnd</strong>: indica l’índex de l’últim caràcter seleccionat. Això, combinat amb l’anterior propietat, ens permet capturar el valor de la selecció mitjançant JavaScript.</div>
</li>
</ul>

<p>
Aquest és un petit exemple de com capturar el text seleccionat en un <code>textarea</code>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let textarea = document.getElementById('test');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function mostrarSeleccio() {</div></li><li class="li1"><div class="de1">    let seleccio,</div></li><li class="li1"><div class="de1">      start,</div></li><li class="li1"><div class="de1">      length;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    start = textarea.selectionStart;</div></li><li class="li1"><div class="de1">    length = textarea.selectionEnd - textarea.selectionStart;</div></li><li class="li1"><div class="de1">    seleccio = textarea.value.substr(start, length);</div></li><li class="li1"><div class="de1">    alert(seleccio);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;textarea id=&quot;test&quot;&gt;Contingut de prova&lt;/textarea&gt;</div></li><li class="li1"><div class="de1">&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;mostrarSeleccio();&quot;&gt;Mostrar seleccio&lt;/button&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/XXwLVJ?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/XXwLVJ?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/XXwLVJ?editors=1010J</a>.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Mètode String.substr(start, length)</p>
<p>
El mètode <code>substr()</code>, dels objectes de tipus <code>String</code>, permet obtenir el fragment de la cadena que va des de la posició indicada pel primer paràmetre fins a aquesta posició més el valor del segon paràmetre. Per exemple: <code>“hola mon”.substr(5,3)</code> retorna <code>mon</code>.
</p>
</div></div>
<p>
D’altra banda, també podem fer servir JavaScript per fer la selecció d’un text, tal com podeu veure en aquest exemple: permet cercar dins del <code>textarea</code> i seleccionar el primer mot que coincideixi amb la cerca; vegem-ho:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let text = document.getElementById('text'),</div></li><li class="li1"><div class="de1">      cerca = document.getElementById('mot');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function cercar() {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    let mot = cerca.value,</div></li><li class="li1"><div class="de1">      start = text.value.indexOf(mot);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    if (start &gt; 0) {</div></li><li class="li1"><div class="de1">      text.selectionStart = start;</div></li><li class="li1"><div class="de1">      text.selectionEnd = start + mot.length;</div></li><li class="li1"><div class="de1">      text.focus();  //necessari en alguns navegadors (p.e. a Firefox) perquè es visualitzi la selecció</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    } else {</div></li><li class="li1"><div class="de1">      alert(&quot;No s'ha trobat el mot&quot;);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;label&gt;Mot a cercar:</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;search&quot; id=&quot;mot&quot;/&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;&lt;button onclick=&quot;cercar();&quot;&gt;cercar&lt;/button&gt;&lt;br&gt;</div></li><li class="li1"><div class="de1">&lt;textarea id=&quot;text&quot; readonly cols=&quot;150&quot; rows=&quot;7&quot;&gt;—Ja era passat l’any e lo dia, e les festes eren complides de solemnizar, com la magestat del senyor rey tramés a preguar a tots los stats que·s volguessen esperar alguns dies per ço com la magestat sua volia fer publicar una fraternitat, la qual novament havia instituïda, de XXVI cavallers, sens que negú no fos reproche. E tots de bon grat foren contents de aturar. E la causa e principi de aquesta fraternitat, senyor, és stada aquesta, ab tota veritat, segons yo e aquests cavallers que açí són havem hoïda reçitar per boca del senyor rey mateix: com, un dia de solaç que·s fehien moltes dançes e lo rey, havent dançat, restà per reposar al cap de la sala, e la reyna restà a l’altre cap ab les sues donzelles, e los cavallers dançaven ab les dames; e fon sort que una donzella, dançant ab un cavaller, apleguà fins en aquella part hon lo rey era e, al voltar que la donzella féu, caygué-li la liguacama de la calça, e al parer de tots devia ésser de la sinestra cama, e era de çimolça. </div></li><li class="li1"><div class="de1">&lt;/textarea&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/BjegbG?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/BjegbG?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/BjegbG?editors=1010</a>.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Una altra opció per establir la selecció d’un <code>textarea</code> és fer servir el mètode <code>setSelectionRange( selectionStart, selectionEnd)</code>, proporcionat per la interfície de l’element <code>textarea</code>.
</p>
</div></div>
<p>
Vegem ara les propietats afegides amb HTML5, molt similars a les que trobem a l’element <code>input</code>:
</p>
<ul>
<li class="level1"><div class="li"> <strong>placeholder</strong>: com en el cas de l’element <code>input</code>, afegeix un text per indicar què s’espera que s’introdueixi en aquest camp. Aquest text no s’envia amb el formulari, i si no s’introdueix res al <code>textarea</code>, s’enviarà buit.</div>
</li>
<li class="level1"><div class="li"> <strong>required</strong>: serveix per validar el camp i ens obliga a introduir-hi quelcom abans de poder enviar el formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>maxlength</strong>: limita el nombre de caràcters que es poden introduir.</div>
</li>
<li class="level1"><div class="li"> <strong>minlength</strong>: estableix el nombre mínim de caràcters per poder enviar-lo. <strong>No s’aplica si el camp es deixa buit</strong>; si volem controlar que no sigui buit hem d’afegir també la propietat <code>required</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>form</strong>: igual que en el cas de l’element <code>input</code> aquesta propietat permet associar el <code>textarea</code> a un formulari en el qual no està inclòs.</div>
</li>
</ul>

<p>
En aquest exemple podeu veure aquestes propietats en funcionament:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form method=&quot;GET&quot; action=&quot;test.phpt&quot; id=&quot;principal&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li><li class="li1"><div class="de1">&lt;textarea name=&quot;text&quot; form=&quot;principal&quot; minlength=&quot;5&quot; maxlength=&quot;50&quot; cols=&quot;100&quot; rows=&quot;5&quot; required&gt;Text de prova que passa la validació&lt;/textarea&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en aquest enllaç: <a href="https://codepen.io/ioc-daw-m06/pen/adreVV?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/adreVV?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/adreVV?editors=1010</a>; i el resultat a la <span class="figref"><a href="#figura u4a2-08"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="figura u4a2-08"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Formulari amb textarea

</figcaption><img src="../media/captura_textarea.png" alt="" /></figure>
</div>
</div>

<h3><a id="element_button" >Element &#039;button&#039;</a></h3>
<div class="level3">

<p>
Aquest element, com es pot deduir pel seu nom, serveix per representar botons; tal com els que es mostren amb l’element <code>input</code>, amb els tipus: <code>button</code>, <code>submit</code>, i <code>reset</code>.
</p>

<p>
En aquest cas el comportament per defecte de l’element és enviar el formulari, igual que fa el tipus <code>submit</code>; tot i que es pot especificar el tipus mitjançant les seves propietats, que són les següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>name</strong>: com en altres elements ja vistos, és el nom del paràmetre que s’enviarà amb el formulari.</div>
</li>
<li class="level1"><div class="li"> <strong>id</strong>: identificador únic habitual de tots els elements <acronym title="HyperText Markup Language">HTML</acronym>.</div>
</li>
<li class="level1"><div class="li"> <strong>type</strong>: els botons poden ser de tres tipus: <code>submit</code>, <code>reset</code> i <code>button</code>, amb el comportament equivalent als mateixos tipus de l’element <code>input</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>value</strong>: valor del botó que s’afegirà com a valor en enviar el formulari.</div>
</li>
</ul>
<div class="iocnote"><div class="ioccontent">
<p>
En cas de fer servir l’element <code>button</code> fora de l’estructura de formulari, el comportament per defecte és ignorat.
</p>
</div></div>
<p>
Fixeu-vos en aquest exemple: en fer clic al botó, com que no s’ha especificat cap tipus, es realitza l’enviament del formulari i, com podeu veure a la pestanya <em>Network</em> de les eines de desenvolupador, s’ha afegit el paràmetre <code>esborrar</code> amb el valor <code>true</code>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form method=&quot;GET&quot; action=&quot;test.php&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;button name=&quot;esborrar&quot; value=&quot;true&quot;&gt;Esborrar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/KVLOeM?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/KVLOeM?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/KVLOeM?editors=1000</a>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
En navegadors antics, <strong>el funcionament de l’element <code>button</code> no sempre és correcte</strong>, per aquesta raó és preferible fer servir l’element <code>input</code> amb un tipus de botó.
</p>
</div></div>
</div>

<h3><a id="element_label" >Element &#039;label&#039;</a></h3>
<div class="level3">

<p>
La finalitat d’aquest element és purament semàntica, ja que no afecta l’enviament de les dades. Serveix per indicar clarament que el text que inclou acompanya un dels elements del formulari.
</p>

<p>
Aquest element es pot aplicar de dues formes:
</p>
<ul>
<li class="level1"><div class="li"> Afegint l’element <code>input</code> entre les etiquetes d’apertura i tancament:</div>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;label&gt;Etiqueta:</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/zrQgmP?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/zrQgmP?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/zrQgmP?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> Fent servir l’atribut <code>for</code> i assignar com a valor l<code>‘id</code> del camp pel qual serveix d’etiqueta:</div>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;label for=&quot;camp1&quot;&gt;Etiqueta:&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;input id=&quot;camp1&quot; type=&quot;text&quot; /&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/xZNvyW?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/xZNvyW?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/xZNvyW?editors=1000</a>.
</p>

</div>

<h3><a id="element_datalist" >Element &#039;datalist&#039;</a></h3>
<div class="level3">

<p>
Aquest element es va afegir amb HTML5 i serveix per definir una llista de valors que després pot ser utilitzada per l’element <code>input</code> especificant el nom de la llista a l’atribut <code>list</code>.
</p>

<p>
A diferència de les llistes generades amb l’element <code>select</code>, aquestes permeten introduir valors propis, i el valor no queda limitat als valors del <code>datalist</code>. Vegem-ne el funcionament:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;label&gt;Selecciona un navegador de la llista:</div></li><li class="li1"><div class="de1">  &lt;input list=&quot;navegadors&quot; name=&quot;meuNavegador&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/label&gt;</div></li><li class="li1"><div class="de1">&lt;datalist id=&quot;navegadors&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Chrome&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Firefox&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Internet Explorer&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Opera&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;option value=&quot;Safari&quot;&gt;</div></li><li class="li1"><div class="de1">&lt;/datalist&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/NxVQex?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/NxVQex?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/NxVQex?editors=1000</a>.
</p>

</div>

<h2><a id="modificacio_d_aparenca_i_comportament" >Modificació d&#039;aparença i comportament</a></h2>
<div class="level2">

<p>
A l’hora de crear un formulari, s’ha de tenir en compte que molt rarament n’hi haurà prou amb l’aparença original. Aquests formularis estaran incrustats en una pàgina o aplicació que tindrà un estil ja definit per l’empresa i, per tant, el formulari haurà de fer servir els mateixos colors i estils.
</p>

<p>
D’altra banda, també serà habitual fer algun tipus de personalització del comportament, ja sigui fer una validació de dades abans d’enviar el formulari, fer alguns càlculs amb la informació que serà enviada o simplement actualitzar el valor d’alguns camps a partir dels canvis produïts en uns altres.
</p>

</div>

<h3><a id="modificacio_de_l_aparenca_d_un_formulari" >Modificació de l&#039;aparença d&#039;un formulari</a></h3>
<div class="level3">

<p>
Un formulari molt rarament es trobarà de forma independent, sempre serà part d’un altre lloc web o aplicació i, per aquest motiu, la seva aparença ha de concordar amb la resta de l’aplicació.
</p>

<p>
Aquesta concordança d’estil la farem fent servir <acronym title="Cascading Style Sheets">CSS</acronym>, raó per la qual segurament ja tindrem la major part de la feina feta.
</p>

<p>
És important recordar que, per agrupar els elements del formulari, en lloc de fer servir l’element <code>div</code> i etiquetar fent servir text directament o capçaleres, disposem d’elements com ara:
</p>
<ul>
<li class="level1"><div class="li"> <strong>fieldset</strong>: per agrupar els continguts en lloc de fer servir <em>divs</em>.</div>
</li>
<li class="level1"><div class="li"> <strong>label</strong>: per etiquetar els camps.</div>
</li>
<li class="level1"><div class="li"> <strong>legend</strong>: per fer servir com a capçalera dins d’un <code>fieldset</code>.</div>
</li>
<li class="level1"><div class="li"> <strong>placeholder</strong>: propietat per donar pistes als usuaris de com s’ha d’emplenar el formulari.</div>
</li>
</ul>

<p>
Malauradament, alguns dels elements que es fan servir per als formularis, com els botons i el tipus de camp <code>file</code>, no es poden personalitzar, ja que el <acronym title="Cascading Style Sheets">CSS</acronym> no s’aplica correctament. La seva implementació depèn del navegador i, si volem poder modificar-ne l’aparença, hem de recórrer a fer servir una biblioteca externa o hem de crear el nostre propi component.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
S’ha de tenir compte que si no mantenim amb un estil idèndtic els elements <code>input</code> de tipus botó i els elements <code>button</code>, l’aparença pot resultar incoherent.
</p>
</div></div>
<p>
En l’exemple següent, podeu veure com canvia l’aspecte d’un formulari quan s’hi aplica l’estil <acronym title="Cascading Style Sheets">CSS</acronym>. Primer, vegem el formulari sense aplicar-hi cap estil:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Fulls d&#039;estil CSS</p>
<p>
Podeu trobar més informació sobre els fulls d’estil <acronym title="Cascading Style Sheets">CSS</acronym> en aquest enllaç: <a href="https://developer.mozilla.org/es/docs/Web/CSS" class="urlextern" title="https://developer.mozilla.org/es/docs/Web/CSS"  rel="nofollow">www.developer.mozilla.org/es/ docs/Web/CSS</a>.
</p>
</div></div><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form&gt;</div></li><li class="li1"><div class="de1">  &lt;fieldset&gt;</div></li><li class="li1"><div class="de1">    &lt;legend&gt;Connectar&lt;/legend&gt;</div></li><li class="li1"><div class="de1">    &lt;label&gt;Usuari</div></li><li class="li1"><div class="de1">      &lt;input type=&quot;text&quot; name=&quot;usuari&quot; /&gt;</div></li><li class="li1"><div class="de1">    &lt;/label&gt;</div></li><li class="li1"><div class="de1">    &lt;label&gt;Contrasenya</div></li><li class="li1"><div class="de1">      &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;</div></li><li class="li1"><div class="de1">    &lt;/label&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    &lt;button&gt;Connectar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/YwoPLR?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/YwoPLR?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/YwoPLR?editors=1000</a>; i el resultat a la <span class="figref"><a href="#figura u4a2-04"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="figura u4a2-04"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Formulari sense estils <acronym title="Cascading Style Sheets">CSS</acronym>

</figcaption><img src="../media/captura_textarea_sense_css.png" alt="" /></figure>
</div>
<p>
I ara, vegem el mateix formulari, però afegint-hi el següent codi <acronym title="Cascading Style Sheets">CSS</acronym>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;style&gt;</div></li><li class="li1"><div class="de1">  form {</div></li><li class="li1"><div class="de1">    margin: 20px auto;</div></li><li class="li1"><div class="de1">    width: 300px;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  label {</div></li><li class="li1"><div class="de1">    text-transform: lowercase;</div></li><li class="li1"><div class="de1">    font-weight: bold;</div></li><li class="li1"><div class="de1">    font-size: small;</div></li><li class="li1"><div class="de1">    color: grey;</div></li><li class="li1"><div class="de1">    width: 100%;</div></li><li class="li1"><div class="de1">    display: block;</div></li><li class="li1"><div class="de1">    padding: 5px;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  input {</div></li><li class="li1"><div class="de1">    width: 60%;</div></li><li class="li1"><div class="de1">    float: right;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  button {</div></li><li class="li1"><div class="de1">    margin-top: 10px;</div></li><li class="li1"><div class="de1">    width: 100%;</div></li><li class="li1"><div class="de1">    height: 25px;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  legend {</div></li><li class="li1"><div class="de1">    text-transform: uppercase;</div></li><li class="li1"><div class="de1">    font-style: italic;</div></li><li class="li1"><div class="de1">    background: azure;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  fieldset {</div></li><li class="li1"><div class="de1">    background: azure;</div></li><li class="li1"><div class="de1">    border: 1px dotted ;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/style&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/yedyyy?editors=1100" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/yedyyy?editors=1100"  rel="nofollow">codepen.io/ioc-daw-m06/pen/yedyyy?editors=1100</a>; i el resultat a la <span class="figref"><a href="#figura u4a2-05"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="figura u4a2-05"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Formulari amb estils <acronym title="Cascading Style Sheets">CSS</acronym>

</figcaption><img src="../media/captura_formulari_css.png" alt="" /></figure>
</div>
</div>

<h3><a id="modificacio_del_comportament_d_un_formulari" >Modificació del comportament d&#039;un formulari</a></h3>
<div class="level3">

<p>
Quan treballem amb formularis i amb els elements relacionats (com són les llistes, els quadres de text i els botons), no sempre voldrem fer un enviament d’aquesta informació i, en molts casos, voldrem fer un tractament d’aquest abans d’enviar-la.
</p>

<p>
Potser hem de fer alguns càlculs amb la informació, formatar-la o validar-la abans de fer l’enviament. En qualsevol d’aquests casos, el que ens interessa és interrompre l’execució de l’enviament, comprovar o processar les dades i, si tot és correcte, continuar amb l’enviament.
</p>

<p>
A continuació podeu trobar un exemple en el qual es comprova si el nombre introduït és parell en enviar el formulari i, si no ho és, s’interromp l’enviament:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let principal = document.getElementById('principal'),</div></li><li class="li1"><div class="de1">    nombre = document.getElementById('nombre')</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  principal.addEventListener('submit', event =&gt; {</div></li><li class="li1"><div class="de1">    if (nombre.value % 2 === 0) {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      alert(&quot;Correcte, es continua amb l'enviament&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  } else {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      alert(&quot;El nombre ha de ser parell&quot;);</div></li><li class="li1"><div class="de1">      event.preventDefault();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  });</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot; id=&quot;principal&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Introdueix un numero parell:&lt;input type=&quot;number&quot; name=&quot;nombre&quot; id =&quot;nombre&quot; required/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/GobJzN?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/GobJzN?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/GobJzN?editors=1010</a>.
</p>

<p>
Si us fixeu en el panell <em>Network</em> de les eines de desenvolupador, podreu comprovar que, en efecte, si el nombre no és parell, no es produeix l’enviament, perquè <code>event.preventDefault()</code> evita el comportament per defecte de l’<em>event</em>, que en aquest cas és l’enviament.
</p>

<p>
D’aquesta manera podem evitar que es produeixi l’enviament del formulari fins que es compleixin totes les condicions necessàries.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Cal recordar que en el cas dels elements <code>form</code>, <strong><code>preventDefault()</code> és un mètode clau si estem treballant amb AJAX</strong>, perquè ens permet aturar l’enviament de la informació i invocar, en el seu lloc, les funcions que ens permeten fer la petició asíncrona.
</p>
</div></div>
<p>
Un altre exemple d’ús interessant és preprocessar la informació que s’enviarà al servidor; vegem-ho:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let principal = document.getElementById('principal'),</div></li><li class="li1"><div class="de1">    nom = document.getElementById('nom'),</div></li><li class="li1"><div class="de1">    cognom = document.getElementById('cognom'),</div></li><li class="li1"><div class="de1">    nomcomplet = document.getElementById('nomcomplet')</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  principal.addEventListener('submit', event =&gt; { </div></li><li class="li1"><div class="de1">    nomcomplet.value = (nom.value + ' ' + cognom.value).toLowerCase();</div></li><li class="li1"><div class="de1">  });</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot; id=&quot;principal&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Nom:&lt;input type=&quot;text&quot; name=&quot;nom&quot; id=&quot;nom&quot; required/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;label&gt;Cognom:&lt;input type=&quot;text&quot; name=&quot;cognom&quot; id =&quot;cognom&quot; required/&gt;</div></li><li class="li1"><div class="de1">  &lt;/label&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;hidden&quot; name=&quot;nomcomplet&quot; id=&quot;nomcomplet&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;submit&quot; /&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/jWjPjx?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/jWjPjx?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/jWjPjx?editors=1010</a>.
</p>

<p>
En aquest cas hem afegit un camp ocult que originalment no conté res; però, abans d’executar l’enviament, es processa la informació del <code>nom</code> i el <code>cognom</code> per crear el <code>nomcomplet</code>, que està compost per la concatenació del <code>nom</code> i el <code>cognom</code> amb totes les lletres en minúscula.
</p>

<p>
No obstant això, fer servir els botons de tipus <code>submit</code> no és l’única manera de provocar l’enviament de dades; també es pot fer manualment, cridant el mètode <code>submit</code> del formulari. Per exemple, en fer clic sobre un element personalitzat per emular el funcionament d’un botó: 
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;style&gt;</div></li><li class="li1"><div class="de1">  #botoFals {</div></li><li class="li1"><div class="de1">    display: inline;</div></li><li class="li1"><div class="de1">    border: 2px solid black;</div></li><li class="li1"><div class="de1">    border-radius: 15px;</div></li><li class="li1"><div class="de1">    padding: 5px;</div></li><li class="li1"><div class="de1">    font-style: italic;</div></li><li class="li1"><div class="de1">    background: azure;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/style&gt;</div></li><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let principal = document.getElementById('principal'),</div></li><li class="li1"><div class="de1">      boto = document.getElementById('botoFals');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  boto.addEventListener('click', event =&gt; principal.submit());</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot; id=&quot;principal&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; name=&quot;nom&quot; /&gt;</div></li><li class="li1"><div class="de1">  &lt;div id=&quot;botoFals&quot;&gt;</div></li><li class="li1"><div class="de1">    Enviar!</div></li><li class="li1"><div class="de1">  &lt;/div&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/vLqNEX" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/vLqNEX"  rel="nofollow">codepen.io/ioc-daw-m06/pen/vLqNEX</a>.
</p>

<p>
Com es pot veure, hem afegit un <em>listener</em> a l’element <code>div</code> per detectar quan es clica, i una vegada es dispara l’<em>event</em> <code>click</code> fem l’enviament del formulari cridant el mètode <code>submit</code>.
</p>

</div>

<h2><a id="validacio" >Validació</a></h2>
<div class="level2">

<p>
Un dels primers usos que es va donar a JavaScript va ser el de validar la informació del navegador abans d’enviar els formularis. Imagineu els problemes que suposava enviar un formulari amb informació errònia o incompleta el 1995, amb una velocitat de connexió de 28,8 kbit/s com a màxim i pagant pel temps de connexió. Aquest formulari s’havia d’enviar al servidor; allà es comprovava si era correcte i, en cas contrari, es retornava al client (el navegador de l’usuari) que havia de corregir-lo i tornar-lo a enviar fins que finalment passava la validació.
</p>

<p>
Cal remarcar que no es pot confiar la validació de les dades al client, les dades <strong>també han de ser validades al servidor</strong>. Tot i així, el fet de poder validar-les abans de fer l’enviament, ens estalvia temps i consum de dades; temps, perquè no s’ha de comunicar amb el servidor per realitzar la validació; i consum de transferència en els plans de dades, si ens connectem mitjançant una xarxa de dades com 4G.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
<strong>Les dades sempre s’han de validar i sanejar al servidor</strong>, ja que no podem comptar que la informació que ens arribi sigui sempre correcta. Sense aquests controls, seria molt fàcil que un usuari maliciós pogués accedir-hi i manipular o corrompre les dades del servidor.
</p>
</div></div>
</div>

<h3><a id="validacio_d_html5" >Validació d&#039;HTML5</a></h3>
<div class="level3">

<p>
Amb HTML5 es van afegir moltes millores als elements que formen els formularis. Gairebé tots els elements inclouen propietats que permeten fer validacions simples sobre les dades entrades, sense necessitat de codificar res.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
A les especificacions anteriors d’<acronym title="HyperText Markup Language">HTML</acronym> <strong>no s’incloïa la capacitat de validar les dades automàticament</strong>, l’única limitació que es podia afegir era la llargària d’una entrada de text. Aquest fet obligava a fer servir JavaScript per realitzar qualsevol tipus de validacions.
</p>
</div></div>
<p>
Vegem una llista d’exemples de com aplicar aquestes propietats per afegir la validació als nostres formularis:
</p>
<ul>
<li class="level1"><div class="li"> Fer que un camp sigui obligatori; hem d’afegir-hi la propietat <code>required</code>:</div>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; placeholder=&quot;Aquest camp no pot ser buit&quot; size=&quot;50&quot; required&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/QyXEdV?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/QyXEdV?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/QyXEdV?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> Afegir una validació de correu electrònic, el tipus ha de ser <code>email</code>; vegem-ho:</div>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;email&quot; placeholder=&quot;Aquest camp ha de ser un email correcte&quot; size=&quot;50&quot; required&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/vLqKxx?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/vLqKxx?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/vLqKxx?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> Acceptar només nombres enters:</div>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;number&quot; placeholder=&quot;Només nombres enters&quot; required&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/rxELyE?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/rxELyE?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/rxELyE?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> Acceptar també nombres reals: </div>
<ul>
<li class="level2"><div class="li"> Només haurem d’afegir l’atribut <code>step</code> amb el valor que representarà la diferència entre un nombre i el següent. Per exemple, si volem només una precisió d’un decimal, hi afegirem <code>step=“0.1”</code>:</div>
</li>
</ul>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;number&quot; placeholder=&quot;Accepta nombres reals&quot; required step=&quot;0.1&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/RrzRVV?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/RrzRVV?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/RrzRVV?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> Establir un valor mínim i màxim (contingut numèric):</div>
<ul>
<li class="level2"><div class="li"> Continuant amb els exemples numèrics, ens trobem que en molts casos necessitarem establir un valor mínim i un de màxim. Això també es pot fer mitjançant les propietats de l’element <code>input</code>, en aquest cas amb <code>max</code> i <code>min</code>:</div>
</li>
</ul>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;number&quot; placeholder=&quot;Acecepta nombres reals&quot; required step=&quot;0.1&quot; min=&quot;1&quot; max=&quot;42&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/NxZrjz?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/NxZrjz?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/NxZrjz?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> Establir un valor mínim i màxim (cadenes de text):</div>
<ul>
<li class="level2"><div class="li"> Seria possible aplicar els valors <code>max</code> i <code>min</code> a un camp de text? Per exemple, per requerir que una contrasenya tingui com a mínim 5 caràcters? Vegem-ho:</div>
</li>
</ul>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;password&quot; placeholder=&quot;Entre 5 i 10 caracters&quot; required min=&quot;5&quot; max=&quot;10&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/EPByXa?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/EPByXa?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/EPByXa?editors=1000</a>.
</p>
<ul>
<li class="level1"><div class="li"> No funciona, els valors de <code>min</code> i <code>max</code> només s’apliquen a continguts numèrics. Si volem treballar amb cadenes de text, hem de fer servir les propietats <code>minlength</code> i <code>maxlength</code>:</div>
</li>
</ul>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;password&quot; placeholder=&quot;Entre 5 i 10 caracters&quot; required minlength=&quot;5&quot; maxlength=&quot;10&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/yedJXw?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/yedJXw?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/yedJXw?editors=1000</a>.
</p>

</div>

<h4><a id="validacio_per_pattern" >Validació per &#039;pattern&#039;</a></h4>
<div class="level4">

<p>
La propietat de validació més potent és <code>pattern</code>, introduïda a HTML5 i, per consegüent, no disponible en els navegadors més antics. Aquesta propietat ens permet introduir una expressió regular que es farà servir per validar el contingut del camp. Per exemple, si l’entrada de text ha de contenir només una paraula i ha de començar per majúscula, podríem fer-ho així:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;text&quot; placeholder=&quot;Només una paraula que comenci per majúscula&quot; required size=50 pattern='^\b[A-Z]\w*\b$'&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/YwoWOx?editors=1000" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/YwoWOx?editors=1000"  rel="nofollow">codepen.io/ioc-daw-m06/pen/YwoWOx?editors=1000</a>.
</p>
<div class="iocreference"><div class="ioccontent">
<p>
Les <em>expressions regulars</em> es troben detallades a la secció “Expressions regulars” d’aquest mateix apartat.
</p>
</div></div>
<p>
Si proveu aquest exemple, veureu que només us deixa enviar el formulari si es compleix la condició indicada per l’expressió regular, que es pot interpretar de la manera següent:
</p>
<ul>
<li class="level1"><div class="li"> Començant al principi del text: <code>^</code></div>
</li>
<li class="level1"><div class="li"> Fins al final del text: <code>$</code></div>
</li>
<li class="level1"><div class="li"> Ha de contenir només una paraula, que és envoltada per <code>\b</code> que marca l’inici i el final</div>
</li>
<li class="level1"><div class="li"> El primer caràcter ha d’estar comprès entre A i Z, ambdós inclosos: <code>[A-Z]</code></div>
</li>
<li class="level1"><div class="li"> A continuació pot haver-hi qualsevol quantitat (0 o més) de lletres i números: <code>\w*</code></div>
</li>
</ul>

</div>

<h3><a id="validacio_per_a_javascript" >Validació per a JavaScript</a></h3>
<div class="level3">

<p>
Tot i que HTML5 ens permet validar els camps en una gran quantitat de situacions, pot ocórrer que necessitem programar les nostres pròpies validacions; per exemple, en el cas d’haver de donar suport a navegadors antics o quan tractem amb un tipus de validació més complexa.
</p>

<p>
Detectant quan es dispara l’<em>event</em> <code>submit</code> de l’element <code>form</code>, és possible aturar l’enviament d’un formulari i afegir les nostres pròpies validacions . Vegem una variació per simplificar el codi, afegint directament el nom de la funció que serà invocada en detectar-se aquest <em>event</em>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;GET&quot; onsubmit=&quot;return validar();&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input name=&quot;dni&quot; id=&quot;dni&quot; type=&quot;text&quot; minlength=&quot;9&quot; maxlength=&quot;9&quot; size=&quot;9&quot; placeholder=&quot;DNI&quot; pattern=&quot;^\d{8}[a-zA-Z]&quot;/&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  function validar() {</div></li><li class="li1"><div class="de1">    let dni = document.getElementById('dni');</div></li><li class="li1"><div class="de1">    return comprovarDni(dni.value);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function comprovarDni(dni) {</div></li><li class="li1"><div class="de1">    let nombre,</div></li><li class="li1"><div class="de1">      lletraIntroduida,</div></li><li class="li1"><div class="de1">      lletraEsperada,</div></li><li class="li1"><div class="de1">      correcte = false;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    nombre = dni.substr(0, dni.length - 1); // Extraiem el nombre</div></li><li class="li1"><div class="de1">    lletraIntroduida = dni.substr(dni.length - 1, 1); // Extreiem la lletra</div></li><li class="li1"><div class="de1">    nombre = nombre % 23;</div></li><li class="li1"><div class="de1">    lletraEsperada = 'TRWAGMYFPDXBNJZSQVHLCKET'; // Possibles valors de la lletra ordenats per la posició corresponent</div></li><li class="li1"><div class="de1">    lletraEsperada = lletraEsperada.substring(nombre, nombre + 1);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    if (lletraEsperada === lletraIntroduida.toUpperCase()) {</div></li><li class="li1"><div class="de1">      correcte = true;</div></li><li class="li1"><div class="de1">      alert('DNI correcte: ' + dni);</div></li><li class="li1"><div class="de1">    } else {</div></li><li class="li1"><div class="de1">      alert('DNI incorrecte: ' + dni);</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    return correcte;</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/XXLKGX?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/XXLKGX?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/XXLKGX?editors=1010</a>.
</p>

<p>

</p>

<p>
Com es pot apreciar, a l’element <code>input</code> del bloc <acronym title="HyperText Markup Language">HTML</acronym> s’ha especificat:
</p>
<ul>
<li class="level1"><div class="li"> La mida mínima ha de ser 9 caràcters (<code>minlength</code>).</div>
</li>
<li class="level1"><div class="li"> La mida màxima ha de ser 9 caràcters (<code>maxlength</code>).</div>
</li>
<li class="level1"><div class="li"> El valor s’ha de correspondre amb una expressió regular (<code>pattern</code>) que requereix 8 nombres <code>\d{8}</code> seguits d’una lletra en minúscules o majúscules <code>[a-zA-Z]</code>.</div>
</li>
</ul>

<p>
Com que la lletra corresponent a cada DNI es pot calcular en funció dels nombres, és possible comprovar que el DNI introduït sigui correcte abans d’enviar el formulari. Per afegir aquesta comprovació només cal afegir el nom de la funció encarregada de la validació a la detecció de l’<em>event</em> <code>submit</code> del formulari perquè aquesta funció sigui invocada quan el formulari sigui enviat.
</p>

<p>
Fixeu-vos que en lloc de simplement invocar la funció <code>validar</code> en disparar-se l’<em>event</em> <code>submit</code>, el que hem fet és retornar el valor d’aquesta funció: <code>onsumbit=“return validar();”</code>. Si aquest valor és <code>true</code>, el formulari s’enviarà, i si és <code>false</code>, s’aturarà l’enviament. Aquesta és una alternativa a invocar el mètode <code>preventDefault()</code> per aturar el comportament per defecte.
</p>

<p>
Fer la validació de la lletra és més complicat, així que per fer-ho hem de recórrer a JavaScript. En aquest exemple hem invocat la funció <code>validar()</code>, cosa que ens permetria centralitzar la validació i afegir més comprovacions, si fos necessari. Només s’ha de vigilar que ha de retornar <code>true</code>, si es passen totes les comprovacions, o a <code>false</code>, si alguna falla.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Validació del DNI</p>
<p>
Podeu trobar més informació sobre com es calcula la lletra del DNI en el següent enllaç: <a href="https://ca.wikipedia.org/wiki/N%C3%BAmero_d%27identificaci%C3%B3_fiscal" class="urlextern" title="https://ca.wikipedia.org/wiki/N%C3%BAmero_d%27identificaci%C3%B3_fiscal"  rel="nofollow">www.goo.gl/VrlzYQ</a>.
</p>
</div></div>
<p>
Fixeu-vos que la funció <code>validar()</code> retorna el valor de la funció <code>comprovarDni()</code>, ja que en aquest cas només ha de fer una comprovació. El procés a seguir per determinar si s’ha de retornar cert o fals és el següent:
</p>
<ol>
<li class="level1"><div class="li"> Separem la part de la cadena que correspon als nombres i la que correspon a la lletra.</div>
</li>
<li class="level1"><div class="li"> Calculem quina és la lletra que hi hauria de correspondre.</div>
</li>
<li class="level1"><div class="li"> Si la lletra introduïda correspon amb l’esperada, llavors és correcta. Fixeu-vos que fem la comprovació del valor en majúscules, així és indiferent si l’hem introduït d’una manera o de l’altra, ja que la lletra esperada és majúscula.</div>
</li>
<li class="level1"><div class="li"> Si és correcte, retornarem <code>true</code>; si no, retornarem <code>false</code>.</div>
</li>
</ol>

<p>
Un altre cas que us podeu trobar és haver de validar la mida màxima d’un o més fitxers abans de fer l’enviament al servidor. Aquest cas és molt interessant perquè, en cas contrari, no sabríeu si s’ha superat la mida màxima fins que falli el servidor, cosa que pot provocar llargues esperes abans de conèixer l’error. Vegem-ho:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let fitxers = document.getElementById('fitxers'),</div></li><li class="li1"><div class="de1">    MAX_MIDA_FITXERS = 2048; // Mida màxima en bytes</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function validarFitxers() {</div></li><li class="li1"><div class="de1">    let fitxer, midaTotal;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    if (fitxers.files.length &gt; 0) {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      midaTotal = 0;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      for (let i = 0; i &lt; fitxers.files.length; i++) {</div></li><li class="li1"><div class="de1">        fitxer = fitxers.files[i];</div></li><li class="li1"><div class="de1">        console.log(&quot;Fitxer: &quot; + fitxer.name + &quot; te una mida de &quot; + fitxer.size + &quot; bytes&quot;);</div></li><li class="li1"><div class="de1">        midaTotal += fitxer.size;</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      console.log(&quot;Mida total dels fitxers: &quot;, midaTotal);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">      if (midaTotal &gt; MAX_MIDA_FITXERS) {</div></li><li class="li1"><div class="de1">        fitxers.value = [];</div></li><li class="li1"><div class="de1">        alert(&quot;La mida màxima dels fitxers és &quot; + MAX_MIDA_FITXERS +</div></li><li class="li1"><div class="de1">          &quot; bytes, però els fitxers seleccionats tenen una mida de &quot; +</div></li><li class="li1"><div class="de1">          midaTotal + &quot; bytes.&quot;);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  };</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;form action=&quot;test.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;input type=&quot;file&quot; id=&quot;fitxers&quot; name=&quot;fitxer[]&quot; multiple=&quot;true&quot; onchange=&quot;validarFitxers();&quot;&gt;</div></li><li class="li1"><div class="de1">  &lt;button&gt;Enviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;/form&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/obrzEd?editors=1011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/obrzEd?editors=1011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/obrzEd?editors=1011</a>.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Web API File</p>
<p>
La Web <acronym title="Application Programming Interface">API</acronym> que permet obtenir la informació dels fitxers pertany a HTML5. Podeu trobar-ne més informació a l’enllaç següent: <a href="https://developer.mozilla.org/en-US/docs/Web/API/File" class="urlextern" title="https://developer.mozilla.org/en-US/docs/Web/API/File"  rel="nofollow">www.goo.gl/7dtSKT</a>.
</p>
</div></div>
<p>
En aquest exemple, en lloc de fer la validació en enviar el formulari, l’hem afegit a l’<em>event</em> <code>change</code> de l’element <em>input</em>. En el cas dels fitxers, l’<em>event</em> <code>change</code> es produeix sempre tan bon punt es tanca el diàleg de selecció de fitxers, així que és el punt ideal per fer la validació. Tampoc no cal retornar cap valor; si la mida no és correcta, el que fem és buidar la selecció establint l’<em>array</em> de fitxers a un <em>array</em> buit.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
<code>MAX_MIDA_FITXERS</code> és una variable definida per nosaltres que ens facilita ajustar la mida segons els requeriments, en lloc de fer servir un nombre. La posem en majúscules perquè la seva funcionalitat coincideix amb la de les constants d’altres llenguatges.
</p>
</div></div>
<p>
Com que és un exemple per a HTML5 es pot fer servir l’atribut <code>multiple</code> de l’element <em>input</em>, cosa que ens permet fer una selecció múltiple de fitxers. Fixeu-vos que en aquest cas l’atribut <code>name</code> és un <em>array</em>: això permet enviar tota la llista de fitxers seleccionats en lloc d’un de sol.
</p>

<p>
En el codi de la funció <code>validarFitxers()</code>, veureu que primer hem afegit una sèrie de missatges que es mostren per consola per facilitar el seguiment de què està passant. Aquests missatges, però, no són necessaris per al bon funcionament del programa. El procés seria el següent:
</p>
<ol>
<li class="level1"><div class="li"> El primer pas és comprovar si la mida de l’<em>array</em> de fitxers <code>file</code> (exposat per la Web <acronym title="Application Programming Interface">API</acronym> de fitxers) conté algun element.</div>
</li>
<li class="level1"><div class="li"> Si és així, inicialitzem la mida total a 0 i recorrem l’<em>array</em>.</div>
</li>
<li class="level1"><div class="li"> Mostrem la informació de cada fitxer per la consola i afegim la mida al total mitjançant la seva propietat <code>size</code>.</div>
</li>
<li class="level1"><div class="li"> Una vegada els hem recorregut tots, mostrem per la consola la mida total.</div>
</li>
<li class="level1"><div class="li"> Procedim a comprovar si la mida és superior al límit (en el nostre cas, 2.048 bytes) i, si és així, buidem el contingut de l’element <code>input</code> que conté els fitxers, i mostrem l’alerta.</div>
</li>
</ol>

<p>
Les bases per realitzar validacions directament amb JavaScript són molt simples. Això sí, s’ha de tenir sempre a mà una bona pàgina de consulta com <a href="https://developer.mozilla.org/" class="urlextern" title="https://developer.mozilla.org/"  rel="nofollow">www.developer.mozilla.org</a>, sobretot quan treballem amb les Web <acronym title="Application Programming Interface">API</acronym>, ja que poden oferir-nos possibilitats que van més enllà de l’especificació bàsica d’<acronym title="HyperText Markup Language">HTML</acronym>.
</p>

</div>

<h2><a id="expressions_regulars" >Expressions regulars</a></h2>
<div class="level2">

<p>
Es pot fer servir l’atribut <code>pattern</code> dels elements <code>input</code> per realitzar validacions, aplicant una expressió regular. En aquesta secció veurem què són exactament les expressions regulars i com s’ha d’utilitzar-les.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle"> Comprovador d&#039;expressions regulars en línia</p>
<p>
En molts casos pot ser interessant comprovar que l’expressió regular que volem aplicar és correcta. Per comprovar-ho existeixen eines en línia com <em>Regex Pal</em> (<a href="http://www.regexpal.com/" class="urlextern" title="http://www.regexpal.com/"  rel="nofollow">www.regexpal.com</a>). Aquest web permet introduir una expressió regular i un text, de manera que podem comprovar si la selecció es correspon amb el que s’esperava.
</p>
</div></div>
<p>
Una expressió regular és una seqüència de caràcters que defineixen un patró de cerca. Aquest patró es pot utilitzar en operacions del tipus <em>cercar i reemplaçar</em>, oferint inclús capacitat de captura de grups per realitzar uns reemplaçaments molt potents.
</p>
<div class="iocreference"><div class="ioccontent">
<p>
L’ús de l’atribut <code>pattern</code> dels elements <code>input</code> es tracta a la secció “Validació d’HTML5” d’aquest apartat. 
</p>
</div></div>
<p>
Es poden trobar processadors d’expressions regulars tant en eines dels sistemes operatius Unix i Linux, com en editors i processadors de textos. A banda de les aplicacions externes, pràcticament tots els llenguatges de programació ofereixen la possibilitat d’utilitzar-les. Així que encara que a primera vista siguin inintel·ligibles, dominar-les ens pot facilitar molt la manipulació de cadenes de text, sigui quin sigui el llenguatge amb el qual treballem.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Expressions regulars per a JavaScript</p>
<p>
Es pot trobar més informació sobre totes les opcions que ofereixen les expressions regulars per a JavaScript a l’enllaç següent: <a href="https://developer.mozilla.org/es/docs/Web/JavaScript/Guide/Regular_Expressions" class="urlextern" title="https://developer.mozilla.org/es/docs/Web/JavaScript/Guide/Regular_Expressions"  rel="nofollow">www.goo.gl/p3Ejc3</a>.
</p>
</div></div><div class="iocexample"><div class="ioccontent"><p class="ioctitle">Exemple d&#039;usos de les expressions regulars</p>
<p>
A banda de validar dades, a les expressions regulars se’ls poden donar molts altres usos, per exemple, els següents:
</p>
<ul>
<li class="level1"><div class="li"> Normalitzar textos: eliminar espais en blanc duplicats, salts de línia erronis (la següent línia comença en minúscula), etc.</div>
</li>
<li class="level1"><div class="li"> Canviar els formats: substituir cometes normals per tipogràfiques, que requereixen conèixer on comença i on acaba l’element.</div>
</li>
<li class="level1"><div class="li"> Convertir un text d’un tipus en un altre: extreure la informació d’una consulta SQL i convertir-la en una cadena de text en format JSON.</div>
</li>
<li class="level1"><div class="li"> Realitzar cerques de fitxers amb patrons concrets (utilitats del sistema operatiu Unix/Linux)</div>
</li>
<li class="level1"><div class="li"> Creació de <em>parsers</em> per extreure dades de fitxers amb formats coneguts de text pla (XML, JSON…) i convertir-les en objectes per poder manipular-los. </div>
</li>
<li class="level1"><div class="li"> Creació d’intèrprets de nous llenguatges de programació.</div>
</li>
<li class="level1"><div class="li"> Creació de plantilles on se substituiran valors clau pels valors de les variables que ens interessin.</div>
</li>
</ul>
</div></div>
<p>
En el següent exemple podeu veure com es fa servir un patró molt simple per eliminar tots els salts de línia i espais de sobra al text original, i reemplaçar-los per un sol espai:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let original = document.getElementById('original'),</div></li><li class="li1"><div class="de1">    net = document.getElementById('net');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function netejar() {</div></li><li class="li1"><div class="de1">    let text = original.innerHTML,</div></li><li class="li1"><div class="de1">      patro = /\s+/g;</div></li><li class="li1"><div class="de1">    net.innerHTML = text.replace(patro, ' ');</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;pre id=&quot;original&quot;&gt;»E  en aquell </div></li><li class="li1"><div class="de1">punt  </div></li><li class="li1"><div class="de1">se    </div></li><li class="li1"><div class="de1">féu  desliguar   </div></li><li class="li1"><div class="de1">la çimolsa, que   no  la    volgué més   portar,   ab molta   malenconia que      li restà, emperò no·n </div></li><li class="li1"><div class="de1">féu demostració alguna.</div></li><li class="li1"><div class="de1">&lt;/pre&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;netejar()&quot;&gt;Netejar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;pre id=&quot;net&quot;&gt;&lt;/pre&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/qbzrQY?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/qbzrQY?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/qbzrQY?editors=1010</a>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Tot i que la majoria dels <em>metacaràcters</em> es poden trobar en totes les implementacions, en cas de dubte, és recomanable fer servir una eina com <strong><em>RegexPal</em></strong> (<a href="http://www.regexpal.com/" class="urlextern" title="http://www.regexpal.com/"  rel="nofollow">www.regexpal.com</a>) per comprovar que la nostra expressió funciona com esperem, o bé consultar la documentació especial. Per exemple, no tots els processadors d’expressions regulars ofereixen la capacitat de fer <strong><em>backtracing</em></strong>.
</p>
</div></div>
<p>
En aquests materials ens centrarem en la implementació de les expressions regulars per a JavaScript, tot i que no farem una anàlisi en profunditat de totes les seves opcions.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Un <em>metacaràcter</em> és un caràcter o conjunt de caràcters que tenen un significat especial a l’expressió regular; per exemple <code>^</code> que coincideix la primera posició del text o <code>.</code> que coincideix amb qualsevol caràcter.
</p>
</div></div>
<p>
En JavaScript es poden crear expressions regulars com a representació literal:
</p>
<pre class="code">let patro = /ioc/;</pre>

<p>
També es poden crear expressions regulars com a objecte <code>RegExp</code>, fent servir el constructor i passant l’expressió com a cadena de text: 
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Les barres inicial i final d’una expressió regular no formen part del patró sino que són els delimitadors de l’expressió regular.
</p>
</div></div><pre class="code">let patro = new RegExp(&quot;ioc&quot;);</pre>
<div class="iocimportant"><div class="ioccontent">
<p>
Es prefereix <strong>l’ús de la creació literal</strong> quan coneixem el patró a priori; mentre que <strong>l’ús de l’objecte</strong> és el mètode preferit quan l’expressió és desconeguda inicialment, per exemple, quan es crea a partir de les dades entrades per l’usuari.
</p>
</div></div>
<p>
Totes dues formes admeten opcions addicionals (<em>flags</em>), que s’afegeixen de la següent manera en la representació literal:
</p>
<pre class="code">let patro = /ioc/flags;</pre>

<p>
I d’aquesta si fem servir el objecte:
</p>
<pre class="code">let patro = new RegExp(&quot;ioc&quot;, &quot;flags&quot;);</pre>

<p>
Els <strong><em>flags</em></strong> formen part de l’expressió regular, i no poden afegir-se ni eliminar-se després de la seva creació. A JavaScript es poden utilitzar els següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>g</strong>: <em>Global</em>, cerca tots els resultats a la cadena de text; si no s’afegeix, es para la cerca quan troba la primera coincidència.</div>
</li>
<li class="level1"><div class="li"> <strong>i</strong>: <em>Case-insensitive</em>, no distingeix entre majúscules i minúscules.</div>
</li>
<li class="level1"><div class="li"> <strong>m</strong>: <em>Multi-line</em>, el metacaràcter de final del text coincideix amb el de salt de línia, per exemple, el següent patró coincideix amb el punt i a part de tots els paràgrafs d’un text: <code>/\.$/gm</code></div>
</li>
</ul>

<p>
El caràcter <code>\</code> és u caràcter d’escapament; això vol dir que altera la interpretació del següent caràcter:
</p>
<ul>
<li class="level1"><div class="li"> Si es tracta d’un caràcter amb un significat especial, com <code>.</code>, es tractarà com un caràcter normal.</div>
</li>
<li class="level1"><div class="li"> Si es tracta d’un caràcter normal, i és interpretable com a especial com <code>b</code>, s’interpretarà segons la seva funció especial, en aquest cas com el delimitador de paraula <code>\b</code>.</div>
</li>
</ul>

<p>
Podeu trobar els metacaràcters més utilitzats a la <span class="tabref"><a href="#taula u4a2-01"><span>taula</span></a></span>.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Si no es fa servir cap metacaràcter de tipus quantificador, cada caràcter del patró només se cerca una vegada. Per exemple, <code>Adéu</code> valida <em>Adéu</em>, però no <em>AAAdéu</em>, el patró correcte per al segon cas seria <code>A+deu</code>.
</p>
</div></div><div class="ioctable ">
<div class="titletable"><a name="taula u4a2-01"><span>Taula: </span></a>Taula de metacaràcters per a expressions regulars</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0">Metac.</th><th class="col1">Descripció</th><th class="col2">Patró exemple</th><th class="col3">Vàlid</th><th class="col4">No vàlid</th>
	</tr>
	<tr class="row1">
		<td class="col0"><code>^</code></td><td class="col1"> Coincideix només amb el començament de la cadena </td><td class="col2"> <code>^a</code> </td><td class="col3"> <strong>a</strong>vió </td><td class="col4"> campana </td>
	</tr>
	<tr class="row2">
		<td class="col0"><code>$</code> </td><td class="col1"> Coincideix amb el final de la cadena </td><td class="col2"><code>a$</code></td><td class="col3">Samarret<strong>a</strong></td><td class="col4"> avió </td>
	</tr>
	<tr class="row3">
		<td class="col0"><code>*</code></td><td class="col1">Cerca el caràcter o grup precedent 0 o més vegades, equival a {0,}</td><td class="col2"><code>c*</code></td><td class="col3"><strong>c</strong>amió</td><td class="col4">avió</td>
	</tr>
	<tr class="row4">
		<td class="col0"><code>+</code></td><td class="col1">Cerca el caràcter o grup precedent 1 o més vegades, equival a {1,}</td><td class="col2"><code>c+</code></td><td class="col3">cole<strong>cc</strong>ió</td><td class="col4">camió</td>
	</tr>
	<tr class="row5">
		<td class="col0"><code>?</code></td><td class="col1">Aquest caràcter pot tenir diferents significats segons on es trobi. En situacions normals cerca el caràcter precedent 0 o 1 vegada, i equival a {0,1}</td><td class="col2"><code>bici?</code></td><td class="col3"><strong>bici</strong>, <strong>bic</strong></td><td class="col4">col</td>
	</tr>
	<tr class="row6">
		<td class="col0"><code>.</code></td><td class="col1">Coincideix amb tots els caràcters excepte salt de línia</td><td class="col2"><code>bi.i</code></td><td class="col3"><strong>bici</strong>, <strong>bili</strong></td><td class="col4">billi</td>
	</tr>
	<tr class="row7">
		<td class="col0"><code>{n}</code></td><td class="col1"> Repeteix la cerca del caràcter o grup precedent exactament <code>n</code> vegades</td><td class="col2"><code>o{2}</code></td><td class="col3"><strong>oo</strong>, <strong>oo</strong>o</td><td class="col4">o</td>
	</tr>
	<tr class="row8">
		<td class="col0"><code>{n,m}</code></td><td class="col1"> Repeteix la cerca del caràcter o grup precedent entre <code>n</code> i <code>m</code> vegades</td><td class="col2"><code>o{2,4}</code></td><td class="col3">oo, ooo, oooo, <strong>oooo</strong>o</td><td class="col4">o</td>
	</tr>
	<tr class="row9">
		<td class="col0"><code>(</code> i <code>)</code></td><td class="col1"> Obren i tanquen un grup, el fragment contingut dins dels parèntesis es tracta com un bloc i pot ser capturat.</td><td class="col2"> <code>o(na){2}</code></td><td class="col3"> <strong>onana</strong>, <strong>onana</strong>na, <strong>onanaonana</strong></td><td class="col4">ona</td>
	</tr>
	<tr class="row10">
		<td class="col0"><code>[</code> i <code>]</code></td><td class="col1"> Creen un joc de caràcters, el valor d’aquesta posició pot ser qualsevol dels que en formen part. Dins del joc de caràcters el guió <code>-</code> serveix per indicar un rang de caràcters, per exemple <code>[A-Z]</code> forma un joc de caràcters que inclou totes les lletres des de la A majúscula fins a la Z majúscula </td><td class="col2"><code>coordenada[XYZ]</code></td><td class="col3"><strong>coordenadaX</strong>, <strong>coordenadaY</strong>, <strong>coordenadaZ</strong></td><td class="col4">coordenadaB</td>
	</tr>
	<tr class="row11">
		<td class="col0"><code>[</code> i <code>]</code> començant per <code>^</code></td><td class="col1"> Si el joc de caràcters comença per <code>^</code> nega el joc de caràcters</td><td class="col2"><code>coordenada[^XYZ]</code></td><td class="col3"><strong>coordenadaB</strong></td><td class="col4">coordenadaY, coordenadaZ</td>
	</tr>
	<tr class="row12">
		<td class="col0">\b</td><td class="col1">Coincideix amb el principi o final de la paraula</td><td class="col2"><code>\bBarcelona</code></td><td class="col3">Som a <strong>Barcelona</strong></td><td class="col4">AutoBacerlona</td>
	</tr>
	<tr class="row13">
		<td class="col0">\d</td><td class="col1">Coincideix amb un digit, equival a <code>[0-9]</code></td><td class="col2">\d\d\d</td><td class="col3"><strong>123</strong>, <strong>123</strong>4</td><td class="col4">12</td>
	</tr>
	<tr class="row14">
		<td class="col0">\D</td><td class="col1">L’invers a \d, equival a <code>[^0-9]</code></td><td class="col2">\D\D\D</td><td class="col3"><strong>abc</strong></td><td class="col4">123</td>
	</tr>
	<tr class="row15">
		<td class="col0">\w</td><td class="col1">Coincideix amb un caràcter alfanumèric anglès, inclosa la barra baixa. Equival a <code>[A-Za-z-0-9_]</code> <strong>no inclou caràcters d’accentuació, ni propis d’altres llengües com la ç</strong></td><td class="col2">\w+</td><td class="col3"><strong>pala_72</strong></td><td class="col4">.?!</td>
	</tr>
	<tr class="row16">
		<td class="col0">\W</td><td class="col1">L’invers a \w, equival a <code>[^A-Za-z-0-9_]</code></td><td class="col2">\W</td><td class="col3">42<strong>%</strong></td><td class="col4">pala_72</td>
	</tr>
	<tr class="row17">
		<td class="col0">\s</td><td class="col1">Coincideix amb els caràcters d’espai en blanc, incloent-hi tabulacions i salts de línia</td><td class="col2"><code>\w\s\w</code></td><td class="col3">sens<strong>e s</strong>ortida</td><td class="col4">-</td>
	</tr>
	<tr class="row18">
		<td class="col0">\S</td><td class="col1">L’invers a \s, coincideix amb tot el que no siguin espais en blanc</td><td class="col2"><code>\w\S\w</code></td><td class="col3"><strong>cot</strong>xe</td><td class="col4">c o t x e</td>
	</tr>
</table></div>
<div class="foottable">En negreta es mostra la coincidència del patr; cal fixar-se que sovint només és parcial.</div></div>
</div>

<h3><a id="grups_de_captura" >Grups de captura</a></h3>
<div class="level3">
<div class="iocimportant"><div class="ioccontent">
<p>
L’ús de parèntesis ens serveix per agrupar seleccions, que poden ser extretes o reemplaçades, dins del patró. A aquests grups se’ls coneix com a <strong>grups de captura</strong>.
</p>
</div></div>
<p>
Vegem-ne un exemple fent servir grups de captura. Cerquem totes les ocurrències de <code>lo</code> i afegirem les etiquetes <code>&lt;b&gt;</code> i <code>&lt;/b&gt;</code> a cadascuna per ressaltar el canvi: 
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let original = document.getElementById('original'),</div></li><li class="li1"><div class="de1">    nou = document.getElementById('nou');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function canviar() {</div></li><li class="li1"><div class="de1">    let text = original.innerHTML,</div></li><li class="li1"><div class="de1">      patro = /(\b[lL]o\b)+/g;</div></li><li class="li1"><div class="de1">    nou.innerHTML = text.replace(patro, '&lt;b&gt;$1&lt;/b&gt;');</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;p id=&quot;original&quot;&gt;»Aprés diré a la senyoria vostra les cerimònies que s’an de fer en la capella. Ara diré los cavallers qui foren elets. Primerament, lo rey elegí XXV cavallers e, ab lo rey foren XXVI. Lo rey fon lo primer qui jurà de servar totes les ordinacions en los capítols contengudes e que no fos cavaller negú qui demanàs aquest orde que·l pogués haver. Tirant fon elet lo primer de tots los altres cavallers, per ço com fon lo millor de tots los cavallers. Aprés fon elet lo príncep de Gales, lo duch de Betafort, lo duch de Lencastre, lo duch d'Atçètera, lo marquès de Sófolch, lo marqués de Sant Jordi, lo marqués de Belpuig, Johan de Varoych, gran conestable, lo comte de Nortabar, lo comte de Salasberi, lo comte d’Estafort, lo comte de Vilamur, lo comte de les Marches Negres, lo comte de la Joyosa Guarda, lo senyor d’Escala Rompuda, lo senyor de Puigvert, lo senyor de Terranova, miçer Johan Stuart, miçer Albert de Riuçech. Aquests foren del regne. Los strangers foren: lo duch de Berrí, lo duch d’Anjou, lo comte de Flandes. Foren tots en nombre de XXVI cavallers.</div></li><li class="li1"><div class="de1">&lt;/p&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;canviar()&quot;&gt;Canviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;p id=&quot;nou&quot;&gt;&lt;/p&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/jWjmYL?editors=1010L" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/jWjmYL?editors=1010L"  rel="nofollow">codepen.io/ioc-daw-m06/pen/jWjmYL?editors=1010</a>.
</p>

<p>

</p>

<p>
Com es pot apreciar, en el segon paràmetre de la invocació a <code>replace</code>, l’expressió <code>$1</code> indica que en aquest lloc anirà la primera -i en aquest cas única- cadena capturada. Si capturéssim una segona cadena, podríem referir-nos-hi amb <code>$2</code>, a una tercera amb <code>$3</code>, etc.
</p>

<p>
Fixeu-vos que el patró utilitzat ha estat <code>(\b[lL]o\b)+</code>; això és així pels motius següents:
</p>
<ul>
<li class="level1"><div class="li"> Volem capturar els grups que continguin el patró envoltat pels parèntesis: <code>(</code> i <code>)</code>.</div>
</li>
<li class="level1"><div class="li"> Només volem fer el reemplaçament si n’hi ha 1 o més: <code>+</code>.</div>
</li>
<li class="level1"><div class="li"> Ha de ser la paraula completa, no ho volem substituir en els casos què formi part d’una altra paraula, com pot ser <strong>los</strong> o <strong>millor</strong>, així que ho hem delimitat al principi i final de les paraules amb <code>\b</code>.</div>
</li>
<li class="level1"><div class="li"> Volem fer el canvi tant en el cas que la <code>l</code> sigui majúscula com si no, per això afegim la selecció :<code>[lL]</code>.</div>
</li>
</ul>

<p>
A partir d’aquest codi, només canviant el patró, podem veure com és molt fàcil afegir més elements a la selecció; per exemple, si volem que la substitució afecti “la”, “les”, “lo” i “los”, només hem de tenir en compte els elements comuns i les variacions; el patró seria el següent: <code>(\b[Ll][aoe]s?\b)</code>. Per tant:
</p>
<ul>
<li class="level1"><div class="li"> Hem afegit un joc de selecció de caràcters nou: <code>[aoe]</code>.</div>
</li>
<li class="level1"><div class="li"> Hem afegit una <code>s</code> opcional: <code>s?</code>.</div>
</li>
</ul>

<p>
A continuació podeu trobar un exemple que cerca totes les coincidències de “la”, “las”, “le”, “les”, “lo” i “los” tant amb “l” minúscula com majúscula i les reemplaça per la mateixa coincidència però afegint les etiquetes per mostrar-les en negreta (element <code>&lt;b&gt;</code>). És a dir, si es troba la coincidència “lo” ho substituirà per <code>&lt;b&gt;lo&lt;/b&gt;</code>. Vegem-ho:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;p id=&quot;original&quot;&gt;»Aprés diré a la senyoria vostra les cerimònies que s’an de fer en la capella. Ara diré los cavallers qui foren elets. Primerament, lo rey elegí XXV cavallers e, ab lo rey foren XXVI. Lo rey fon lo primer qui jurà de servar totes les ordinacions en los capítols contengudes e que no fos cavaller negú qui demanàs aquest orde que·l pogués haver. Tirant fon elet lo primer de tots los altres cavallers, per ço com fon lo millor de tots los cavallers. Aprés fon elet lo príncep de Gales, lo duch de Betafort, lo duch de Lencastre, lo duch d'Atçètera, lo marquès de Sófolch, lo marqués de Sant Jordi, lo marqués de Belpuig, Johan de Varoych, gran conestable, lo comte de Nortabar, lo comte de Salasberi, lo comte d’Estafort, lo comte de Vilamur, lo comte de les Marches Negres, lo comte de la Joyosa Guarda, lo senyor d’Escala Rompuda, lo senyor de Puigvert, lo senyor de Terranova, miçer Johan Stuart, miçer Albert de Riuçech. Aquests foren del regne. Los strangers foren: lo duch de Berrí, lo duch d’Anjou, lo comte de Flandes. Foren tots en nombre de XXVI cavallers.</div></li><li class="li1"><div class="de1">&lt;/p&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;canviar()&quot;&gt;Canviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;p id=&quot;nou&quot;&gt;&lt;/p&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let original = document.getElementById('original'),</div></li><li class="li1"><div class="de1">    nou = document.getElementById('nou');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function canviar() {</div></li><li class="li1"><div class="de1">    let text = original.innerHTML,</div></li><li class="li1"><div class="de1">      patro = /(\b[Ll][aoe]s?\b)/g;</div></li><li class="li1"><div class="de1">    nou.innerHTML = text.replace(patro, '&lt;b&gt;$1&lt;/b&gt;');</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/YwoQKq?editors=1010" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/YwoQKq?editors=1010"  rel="nofollow">codepen.io/ioc-daw-m06/pen/YwoQKq?editors=1010</a>.
</p>

<p>
La resta del patró és idèntic, en canvi, ara s’aplica a moltes més combinacions.
</p>

<p>
Com podeu veure, encara que a primera vista les expressions regulars poden semblar inintel·ligibles, si se’n divideixen els components, són més fàcils d’entendre. Ara bé, hi ha excepcions, com per exemple en el cas de les substitucions, que es poden fer servir per localitzar en altres idiomes diferents de l’anglès.
</p>

</div>

<h3><a id="altres_metodes_d_utilitzacio_de_les_expressions_regulars_string_i_regexp" >Altres mètodes d&#039;utilització de les expressions regulars (&#039;String&#039; i &#039;RegExp&#039;)</a></h3>
<div class="level3">

<p>
Cal destacar que la utilització de patrons d’expressions regulars no es troba limitada als objectes de tipus <code>RegExp</code>, sinó que són utilitzats també per altres objectes. Per exemple, els objectes de tipus <code>String</code> ofereixen dos mètodes que accepten expressions regulars com a paràmetres, el que permet fer reemplaçaments i divisions de cadenes complexes.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Captura de caràcters accentuats</p>
<p>
El metacaràcter <code>\w</code> no captura ni la <code>ç</code> ni els caràcters accentuats, per tant, si volem seleccionar tots aquests caràcters, el patró equivalent a <code>\w</code> és: <code>[A-Za-z_çàéèíïóòúüÇÀÉÈÍÏÓÒÚÜ]</code>
</p>
</div></div>
<p>
Vegem a continuació alguns mètodes dels objectes de tipus <code>String</code> i els objectes de tipus <code>RegExp</code> que permeten realitzar diferents operacions amb expressions regulars:
</p>
<ul>
<li class="level1"><div class="li"> <strong><code>exec(cadena)</code></strong>: mètode de <code>RegExp</code> que executa una cerca sobre el paràmetre i retorna un <em>array</em> amb la informació de la cadena trobada (posició 0) i, si n’hi ha, grups de captura (resta de posicions); si no troba la cadena, retorna <code>null</code>.</div>
</li>
<li class="level1"><div class="li"> <strong><code>test(cadena)</code></strong>: mètode de <code>RegExp</code> que cerca una coincidència a <code>cadena</code> i retorna <code>true</code> si la troba o <code>false</code> en cas contrari.</div>
</li>
<li class="level1"><div class="li"> <strong><code>match(regexp)</code></strong>: mètode de <code>String</code> amb funcions similars a <code>exec</code>.</div>
</li>
<li class="level1"><div class="li"> <strong><code>search(regexp)</code></strong>: mètode de <code>String</code> que cerca a la cadena de text el patró passat com argument. En cas de trobar-se alguna coincidència retorna la posició (dintre de la cadena) on comença la coincidència o el valor -1 si no s’ha trobat. En cas de trobar-se múltiples coincidències només es té en compte la primera d’aquestes i la resta són ignorades.</div>
</li>
<li class="level1"><div class="li"> <strong><code>replace(regexp,cadena)</code></strong>: mètode de <code>String</code> que executa la cerca en base a la expressió regular indicada al primer paràmetre i la reemplaça per la cadena de reemplaçament especificada al segon paràmetre (que pot contenir referències als grups de captura).</div>
</li>
<li class="level1"><div class="li"> <strong>split(regexp)</strong>: mètode de <code>String</code> que divideix una cadena en fragments i els col·loca com a <em>array</em>. L’expressió regular identifica els separadors dels diferents fragments.</div>
</li>
</ul>

<p>
Vegem amb un exemple com funcionen tots aquests mètodes; obriu la consola de CodePen o les eines de desenvolupador per veure’n la informació extreta:
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Tant <code>replace</code> com <code>split</code> poden treballar directament amb cadenes, no és obligatori fer servir expressions regulars.
</p>
</div></div><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let original = document.getElementById('original'),</div></li><li class="li1"><div class="de1">    nou = document.getElementById('nou');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function canviar() {</div></li><li class="li1"><div class="de1">    let text = original.innerHTML;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    provaTest(text);</div></li><li class="li1"><div class="de1">    provaSearch(text);</div></li><li class="li1"><div class="de1">    provaExec(text);</div></li><li class="li1"><div class="de1">    provaMatch(text);</div></li><li class="li1"><div class="de1">    provaSplit(text);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    nou.innerHTML = provaReplace(text);</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function provaTest(text) {</div></li><li class="li1"><div class="de1">    let patro = /(cavallers)|(rey)/g;</div></li><li class="li1"><div class="de1">    console.log(&quot;----RegExp.test()----&quot;);</div></li><li class="li1"><div class="de1">    console.log(&quot;Es troba la paraula cavallers o rey?&quot;, patro.test(text));</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function provaSearch(text) {</div></li><li class="li1"><div class="de1">    let patro = /(cavallers)|(rey)/g;</div></li><li class="li1"><div class="de1">    console.log(&quot;----String.search()----&quot;);</div></li><li class="li1"><div class="de1">    console.log(&quot;Es troba la paraula cavaller o cavallers, i si és així en quina posició?&quot;, text.search(patro));</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function provaExec(text) {</div></li><li class="li1"><div class="de1">    let patro = /((cavallers)|(rey))+/g;</div></li><li class="li1"><div class="de1">    console.log(&quot;----RegExp.exec()----&quot;);</div></li><li class="li1"><div class="de1">    console.log(&quot;Quines coincidències de la paraula cavallers o rey s'han trobat?&quot;, patro.exec(text));</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function provaMatch(text) {</div></li><li class="li1"><div class="de1">    let patro = /((cavallers)|(rey))+/g;</div></li><li class="li1"><div class="de1">    console.log(&quot;----String.match()----&quot;);</div></li><li class="li1"><div class="de1">    console.log(&quot;Quines coincidències de la paraula cavallers o rey s'han trobat?&quot;, text.match(patro));</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function provaSplit(text) {</div></li><li class="li1"><div class="de1">    let patro = /[:,\.]? /g;</div></li><li class="li1"><div class="de1">    console.log(&quot;Array amb tots els mots del text:&quot;, text.split(patro));</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  function provaReplace(text) {</div></li><li class="li1"><div class="de1">    let patro = /([A-Za-z_çàéèíïóòúüÇÀÉÈÍÏÓÒÚÜ]+)([\.:,·]?\s)([A-Za-z_çàéèíïóòúüÇÀÉÈÍÏÓÒÚÜ]+)/gm;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    return text.replace(patro, '$3$2$1');</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li><li class="li1"><div class="de1">&lt;p id=&quot;original&quot;&gt;Aprés diré a la senyoria vostra les cerimònies que s’an de fer en la capella. Ara diré los cavallers qui foren elets. Primerament, lo rey elegí XXV cavallers e, ab lo rey foren XXVI. Lo rey fon lo primer qui jurà de servar totes les ordinacions en los capítols contengudes e que no fos cavaller negú qui demanàs aquest orde que·l pogués haver. Tirant fon elet lo primer de tots los altres cavallers, per ço com fon lo millor de tots los cavallers. Aprés fon elet lo príncep de Gales, lo duch de Betafort, lo duch de Lencastre, lo duch d'Atçètera, lo marquès de Sófolch, lo marqués de Sant Jordi, lo marqués de Belpuig, Johan de Varoych, gran conestable, lo comte de Nortabar, lo comte de Salasberi, lo comte d’Estafort, lo comte de Vilamur, lo comte de les Marches Negres, lo comte de la Joyosa Guarda, lo senyor d’Escala Rompuda, lo senyor de Puigvert, lo senyor de Terranova, miçer Johan Stuart, miçer Albert de Riuçech. Aquests foren del regne. Los strangers foren: lo duch de Berrí, lo duch d’Anjou, lo comte de Flandes. Foren tots en nombre de XXVI cavallers.</div></li><li class="li1"><div class="de1">&lt;/p&gt;</div></li><li class="li1"><div class="de1">&lt;button onclick=&quot;canviar()&quot;&gt;Canviar&lt;/button&gt;</div></li><li class="li1"><div class="de1">&lt;p id=&quot;nou&quot;&gt;&lt;/p&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/RrzgYL?editors=1011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/RrzgYL?editors=1011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/RrzgYL?editors=1011</a>.
</p>

<p>
Fixeu-vos que fent servir el mateix patró, <strong>el mètode <code>RegExp.exec()</code> no retorna els valors esperats</strong>; en canvi, el mètode <code>String.match()</code> ens retorna un <em>array</em> amb tots els elements, com és d’esperar.
</p>

<p>
Com es pot apreciar, s’ha fet servir el mètode <code>String.replace()</code> amb un patró una mica més complex per capturar correctament totes les paraules. Com a segon paràmetre s’ha utilitzat la cadena de reemplaçament <code>$3$2$1</code>, de manera que es posa primer el tercer grup capturat (<code>$3</code>), a continuació el segon grup (<code>$2</code>) i finalment el primer (<code>$1</code>). Així doncs, la primera coincidència del patró serien els grups <em>Aprés</em>, <em> </em> i <em>diré</em>; per tant, en reemplaçar el resultat és <em>diré Aprés</em>.
</p>

</div>

<h2><a id="utilitzacio_de_galetes_i_web_storage" >Utilització de galetes i Web Storage</a></h2>
<div class="level2">

<p>
Com que <em>HTTP</em> és un protocol sense estat, cada vegada que es demana una pàgina al servidor, el servidor no “ens recorda”. Això, com podeu imaginar, suposa un greu inconvenient, ja que no és possible, per exemple, canviar de pàgina sense perdre tota la informació, com pot ser:
</p>
<ul>
<li class="level1"><div class="li"> Estar autenticats a un lloc web</div>
</li>
<li class="level1"><div class="li"> La cistella de la compra en un negoci de venda per internet</div>
</li>
<li class="level1"><div class="li"> Les preferències seleccionades en visitar un lloc web</div>
</li>
</ul>

<p>
Tampoc no es pot accedir als següents serveis:
</p>
<ul>
<li class="level1"><div class="li"> Fer el seguiment de les pàgines visitades per generar analítiques</div>
</li>
<li class="level1"><div class="li"> Mostrar vídeos (Youtube)</div>
</li>
<li class="level1"><div class="li"> Mostrar mapes (Google Maps)</div>
</li>
<li class="level1"><div class="li"> Mostrar anuncis publicitaris</div>
</li>
<li class="level1"><div class="li"> Serveis de xat</div>
</li>
</ul>

<p>
La solució que es va donar a aquest problema va ser la invenció de les galetes que són uns petits fragments d’informació que el navegador guarda en fitxers i s’envien juntament amb la capçalera al servidor; de manera que es pot simular que el servidor ens recorda, tot que en realitat sempre es tracta cada petició com si fos nova.
</p>

<p>
Com que aquestes galetes poden ser llegides i escrites des de JavaScript, es poden utilitzar per a altres propòsits que no estan relacionats amb el servidor; per exemple, per guardar les preferències d’un usuari en visitar una pàgina. S’ha de tenir en compte que la mida màxima per a cada galeta és de 4.095 bytes.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Mètode alternatiu a l&#039;ús de galetes per autenticar-se</p>
<p>
En cas de no tenir activada l’opció d’acceptar galetes, el que es fa habitualment per mantenir sessions <em>obertes</em> al servidor és passar la informació d’autenticació com a paràmetre d’una petició GET; és a dir, es codifica al mateix <em><acronym title="Uniform Resource Locator">URL</acronym></em>.
</p>
</div></div>
<p>
Amb HTML5 es va afegir una nova Web <acronym title="Application Programming Interface">API</acronym> per emmagatzemar informació al navegador anomenada Web Storage que, a diferència de les galetes, no s’envien mai al servidor.
</p>

<p>
Així doncs, si necessitem compartir la informació guardada amb el servidor, farem servir galetes, però, si s’hi ha d’accedir només localment, es recomana fer servir Web Storage, ja que accepta fins a 5 <acronym title="Megabyte">MB</acronym> per domini i s’estalvia amplada de banda perquè no s’envia aquesta informació al servidor (al contrari del que passa amb les galetes).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Si es desactiva l’ús de galetes al navegador, queden inhabilitats tant el Web Storage com les galetes.
</p>
</div></div>
<p>
Les galetes poden visualitzar-se des de les eines de desenvolupador dels navegadors, però la seva localització canvia segons el navegador amb el qual treballeu. A Google Chrome podeu trobar-les a la pestanya <strong>Resources</strong>, en el desplegable <strong>Cookies</strong> del panell esquerre, tal com es veu en la imatge <span class="figref"><a href="#figura u4a2-05"><span>figura</span></a></span>. En canvi, si feu servir Mozilla Firefox, les podeu trobar a la pestanya <strong>Emmagatzematge</strong>, en el desplegable <strong>Galetes</strong> del panell esquerre, tal com es veu en la imatge <span class="figref"><a href="#figura u4a2-06"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="figura u4a2-05"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Visualització de galetes a Google Chrome

</figcaption><img src="../media/captura_cookies_chrome.png" alt="" /></figure>
</div><div class="iocfigure"><a name="figura u4a2-06"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Visualització de galetes a Mozilla Firefox

</figcaption><img src="../media/captura_cookies_firefox.png" alt="" /></figure>
</div>
<p>
En cas que no us aparegui aquesta pestanya a Mozilla Firefox, la podeu habilitar a les opcions de les eines de desenvolupador (símbol de la roda dentada a la dreta), marcant la casella <strong>Emmagatzematge</strong> (vegeu la <span class="figref"><a href="#figura u4a2-07"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="figura u4a2-07"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Visualització d’opcions a Mozilla Firefox

</figcaption><img src="../media/captura_opcions_firefox.png" alt="" /></figure>
</div>
<p>
La informació sobre els <strong>Web Storage</strong> es troba a la mateixa pestanya, però a la secció corresponent: <strong>Local Storage</strong> o <strong>Session Storage</strong>.
</p>

</div>

<h3><a id="llei_de_cookies" >Llei de cookies</a></h3>
<div class="level3">

<p>
Abans d’endinsar-nos en la gestió de galetes hem de parlar de la normativa que en regula l’ús, ja que si no s’informa adequadament l’usuari que les fem servir i amb quina finalitat, podem ser sancionats. En aquests materials no tractarem el tema en profunditat, però és important conèixer-les i saber que sempre que treballem amb galetes haurem d’aplicar aquesta llei. Recomanem la lectura de la <strong>Guia sobre les normes d’ús de les galetes</strong>.
</p>
<div class="iocexample"><div class="ioccontent"><p class="ioctitle">Exemple de sanció econòmica per vulnerar la llei de galetes</p>
<p>
En aquest enllaç podeu trobar informació sobre el primer cas de <strong>sancions econòmiques per vulnerar la llei de galetes</strong>: <a href="https://www.abanlex.com/2014/01/primeras-multas-por-vulnerar-la-ley-de-cookies-explicamos-el-caso/" class="urlextern" title="https://www.abanlex.com/2014/01/primeras-multas-por-vulnerar-la-ley-de-cookies-explicamos-el-caso/"  rel="nofollow">www.goo.gl/Ej7bFQ</a>.
</p>

<p>
Si us hi fixeu, no se n’està fent cap ús maliciós, totes les galetes que es fan servir tenen una finalitat legítima. Pertanyen a components que fan funcionar la pàgina correctament, o a publicitat, o bé a serveis externs, com Google Maps, YouTube… Tot i així, com que el text amb la política de galetes no està ben definit, les empreses involucrades van ser sancionades.
</p>

<p>
Les sancions per aquests motius poden arribar fins als 30.000€.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle"> Guia sobre les normes d&#039;ús de les galetes</p>
<p>
Podeu trobar la guia oficial de l’<em>Agencia española de protección de datos</em> amb tota la informació sobre la legislació de galetes a l’enllaç següent: <a href="https://www.agpd.es/portalwebAGPD/canaldocumentacion/publicaciones/common/Guias/Guia_Cookies.pdf" class="urlextern" title="https://www.agpd.es/portalwebAGPD/canaldocumentacion/publicaciones/common/Guias/Guia_Cookies.pdf"  rel="nofollow">www.goo.gl/akFmH</a>.
</p>
</div></div>
<p>
A l’hora de treballar amb galetes s’ha de tenir molt present la legislació vigent, que ens obliga a informar l’usuari que el nostre lloc web fa servir galetes i amb quins fins, i amb un enllaç que expliqui com pot desactivar-les al seu navegador.
</p>

<p>
A la pràctica és molt difícil trobar un lloc web que no faci servir galetes, ja que són imprescindibles fins i tot per generar analítiques. Per aquesta raó podeu donar per descomptat que haureu d’informar l’usuari que el vostre lloc web fa servir galetes i respectar la normativa.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Declinació de l&#039;ús de galetes</p>
<p>
Com que per guardar la informació sobre l’acceptació de les galetes cal fer servir galetes, si un usuari en declina l’ús, no es pot guardar aquesta preferència. Haurà de declinar-la a cada pàgina que visiti o resignar-se a veure el missatge.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
S’ha de tenir en compte també que si les dades guardades en les galetes són de caràcter personal, s’ha d’aplicar també la Llei orgànica de protecció de dades (LOPD).
</p>
</div></div>
</div>

<h3><a id="utilitzacio_de_les_galetes" >Utilització de les galetes</a></h3>
<div class="level3">

<p>
El funcionament de les galetes o <em>cookies</em> és molt senzill, però utilitzar-les no ho és tant. S’hi accedeix a través de la propietat <code>document.cookie</code>, tant per recuperar-les com per guardar-les. Podeu veure-ho en el següent exemple:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Llei orgànica de protecció de dades (LOPD)</p>
<p>
Podeu trobar més informació sobre aquesta llei al següent enllaç: <a href="https://www.boe.es/buscar/act.php?id=BOE-A-1999-23750" class="urlextern" title="https://www.boe.es/buscar/act.php?id=BOE-A-1999-23750"  rel="nofollow">www.goo.gl/Fmpuzv</a> i <a href="https://www.agpd.es/portalwebAGPD/canaldocumentacion/informes_juridicos/reglamento_lopd/index-ides-idphp.php" class="urlextern" title="https://www.agpd.es/portalwebAGPD/canaldocumentacion/informes_juridicos/reglamento_lopd/index-ides-idphp.php"  rel="nofollow">www.goo.gl/zHqQIY</a>.
</p>
</div></div><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  // Afegim una nova galeta</div></li><li class="li1"><div class="de1">  document.cookie=&quot;seu=Barcelona&quot;;</div></li><li class="li1"><div class="de1">  document.cookie=&quot;paf=1&quot;;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  // Recuperem totes les galetes</div></li><li class="li1"><div class="de1">  let galetes = document.cookie;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  // Les mostrem a la consola</div></li><li class="li1"><div class="de1">  console.log(galetes);</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/YwovaK?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/YwovaK?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/YwovaK?editors=0011</a>.
</p>

<p>

Si comproveu la consola, veureu el contingut de la vostra galeta. En cas de provar-lo en CodePen, veureu també les galetes afegides per CodePen separades per un <code>;</code> unes de les altres: <code>“seu=Barcelona; paf=1; grid_layout=list; _gat=1; _ga=GA1.2.197952496.1453793789”</code>
</p>

<p>
El primer que veieu en aquest exemple és com es guarda una informació a una galeta; sempre ha de ser amb el següent format: <code>clau=valor</code>, i si existeixen més galetes, estaran separades amb un <code>;</code>.
</p>

<p>
Segurament us ha estranyat aquest fragment de codi:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">document.cookie=&quot;seu=Barcelona&quot;;</div></li><li class="li1"><div class="de1">document.cookie=&quot;paf=1&quot;;</div></li></ol></pre>
<div class="iocimportant"><div class="ioccontent">
<p>
Es podria esperar que en sobreescriure el valor de la propietat <code>document.cookie</code>, aquest valor fos <code>“paf=1”</code> i el valor <code>seu=Barcelona</code> fos eliminat. Això no passa, perquè aquesta propietat té uns <em>setter</em> i <em>getter</em> natius que en modifiquen el comportament i, per tant, <strong>no és el mateix el que s’escriu i el que es llegeix</strong>.
</p>
</div></div>
<p>
Provem ara de guardar múltiples galetes:
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Es coneixen com a <em>setter</em> les funcions (o mètodes) encarregades d’establir un valor a una propietat i <em>getter</em> les que els recuperen.
</p>
</div></div><pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">// Afegim una nova galeta</div></li><li class="li1"><div class="de1">document.cookie=&quot;seu=Barcelona&quot;;</div></li><li class="li1"><div class="de1">document.cookie=&quot;seu=Tarragona&quot;;</div></li><li class="li1"><div class="de1">document.cookie=&quot;seu=Lleida&quot;;</div></li><li class="li1"><div class="de1">document.cookie=&quot;seu=Girona&quot;;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Recuperem totes les galetes</div></li><li class="li1"><div class="de1">let galetes = document.cookie;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Les mostrem a la consola</div></li><li class="li1"><div class="de1">console.log(galetes);</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/BjgVqp?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/BjgVqp?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/BjgVqp?editors=0011</a>.
</p>

<p>
Com podeu apreciar, només s’ha guardat el valor <code>seu=Girona</code>. En realitat s’han guardat tots, però els següents els han sobreescrit, ja que només hi pot haver un valor associat a cada clau.
</p>

<p>
Una possible solució seria guardar les dades com un <em>array</em>, però <strong>les galetes només poden guardar cadenes de text</strong>, i per tant, si necessitem un comportament més avançat, l’hem d’implementar nosaltres mateixos o fer servir alguna llibreria externa.
</p>

<p>
Després d’entendre com guardar i recuperar les galetes, se’ns presenta un problema nou: com ho fem per recuperar només la galeta que ens interessa i no totes? Malauradament ja heu vist tot el suport proporcionat per l’especificació, és a dir: com afegir una galeta, com sobreescriure’n el valor i com recuperar-les totes. Si volem recuperar-ne només una, hem d’implementar la nostra pròpia solució, per exemple:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">// Afegim una nova galeta</div></li><li class="li1"><div class="de1">document.cookie = &quot;seu=Barcelona&quot;;</div></li><li class="li1"><div class="de1">document.cookie = &quot;paf=1&quot;;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Extraiem la galeta corresponent a la seu</div></li><li class="li1"><div class="de1">let patro = new RegExp(&quot;(?:seu)=(.+?)(?=;|$)&quot;, &quot;g&quot;),</div></li><li class="li1"><div class="de1">  seu = patro.exec(document.cookie)[1];</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// La mostrem a la consola</div></li><li class="li1"><div class="de1">console.log(seu);</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/Ywovoy?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/Ywovoy?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/Ywovoy?editors=0011</a>.
</p>

<p>
El primer que fem és definir un patró que ens capturarà el valor de la galeta amb el nom <code>seu</code>, i a continuació l’executem. El resultat d’executar l’expressió regular és un <em>array</em> que conté a la primera posició (índex 0) el text coincident complet i a les següents posicions el contingut dels grups de captura ignorant el primer, ja que té el format de grup no capturable: <code>(?:)</code>. És a dir, a l’índex 1 es troba el contingut del grup que es troba a continuació del signe igual, ja que és el primer grup de captura vàlid i, per consegüent, es correspon amb el valor de la seu.
</p>

<p>
Tot això és força enrevessat, així que, per simplificar-ho, podem crear una funció que ens facilitarà la tasca, com en aquest exemple:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">// Afegim una nova galeta</div></li><li class="li1"><div class="de1">document.cookie = &quot;seu=Barcelona&quot;;</div></li><li class="li1"><div class="de1">document.cookie = &quot;paf=1&quot;;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Recuperem les galetes</div></li><li class="li1"><div class="de1">let paf = getCookie('paf'),</div></li><li class="li1"><div class="de1">  seu = getCookie('seu');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Mostrem les dades per consola</div></li><li class="li1"><div class="de1">console.log(&quot;Totes les galetes:&quot;, document.cookie);</div></li><li class="li1"><div class="de1">console.log(&quot;Seu:&quot;, seu);</div></li><li class="li1"><div class="de1">console.log(&quot;PAF:&quot;, paf);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function getCookie(key) {</div></li><li class="li1"><div class="de1">  let patro = new RegExp(&quot;(?:&quot;+key + &quot;)=(.+?)(?=;|$)&quot;, &quot;g&quot;);</div></li><li class="li1"><div class="de1">  return patro.exec(document.cookie)[1];</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/ZQdjKP?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/ZQdjKP?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/ZQdjKP?editors=0011</a>.
</p>

<p>
Com podeu comprovar, en fer servir una funció que encapsuli la lògica per recuperar una galeta, se’n simplifica molt la utilització; només hem d’invocar <code>getCookie()</code> i passar el nom de la clau que volem recuperar.
</p>

<p>
A banda d’aquest mètode -més simple- per guardar una galeta, les galetes admeten altres opcions per limitar-ne l’ús i la caducitat; són les següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>path</strong>: per exemple <code>/</code>, <code>/actualitat</code>. Si no s’especifica a la galeta, s’hi podrà accedir des de totes les pàgines del lloc web.  </div>
</li>
<li class="level1"><div class="li"> <strong>domain</strong>: per exemple <code>exemple.com</code>, <code>subdomini.exemple.com</code>. Si s’especifica el domini principal, també es podrà llegir des dels subdominis; si no s’especifica, només es podrà llegir des del domini principal.</div>
</li>
<li class="level1"><div class="li"> <strong>max-age</strong>: durada màxima en segons fins que la galeta caduqui.</div>
</li>
<li class="level1"><div class="li"> <strong>expires</strong>: data en format GMT en què expirarà la galeta. Si no s’especifica, la galeta caduca quan finalitza la sessió (generalment quan es tanca la pestanya concreta o el navegador)</div>
</li>
<li class="level1"><div class="li"> <strong>secure</strong>: la galeta només es podrà transmetre sobre protocols segurs com HTTPS. Aquest tipus de galetes no necessita valor. Totes les galetes enviades a través de HTTPS són automàticament segures.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
Tot i que existeix una opció <code>secure</code>, <strong>les galetes són inherentment insegures</strong>, i no heu de fer-les servir mai per guardar informació sensible ni confidencial.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Cada opció i el seu valor anirà separat per un punt i coma (<code>;</code>) i un espai en blanc, i es separaren els parells <em>opció</em> i <em>valor</em> per un signe igual (<code>=</code>). 
</p>
</div></div>
<p>
Aprofitant que ja coneixem totes les opcions possibles, implementarem la funció <code>setCookie()</code>:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">function setCookie(key, value, options) {</div></li><li class="li1"><div class="de1">  let cookie = encodeURIComponent(key) + '=' + encodeURIComponent(value);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  if (options) {</div></li><li class="li1"><div class="de1">    for (option in options) {</div></li><li class="li1"><div class="de1">      if (option === 'secure') {</div></li><li class="li1"><div class="de1">        cookie += '; ' + encodeURIComponent(option);</div></li><li class="li1"><div class="de1">      } else {</div></li><li class="li1"><div class="de1">        cookie += '; ' + encodeURIComponent(option) + '=' + encodeURIComponent(options[option]);</div></li><li class="li1"><div class="de1">      }</div></li><li class="li1"><div class="de1">    }</div></li><li class="li1"><div class="de1">  }</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  document.cookie = cookie;</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">function getCookie(key) {</div></li><li class="li1"><div class="de1">  let patro = new RegExp(&quot;(?:&quot; + key + &quot;)=(.+?)(?=;|$)&quot;, &quot;g&quot;);</div></li><li class="li1"><div class="de1">  return patro.exec(document.cookie)[1];</div></li><li class="li1"><div class="de1">}</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Afegim una nova galeta</div></li><li class="li1"><div class="de1">setCookie('seu', 'Barcelona', {</div></li><li class="li1"><div class="de1">  'max-age': 300,</div></li><li class="li1"><div class="de1">  path: '/',</div></li><li class="li1"><div class="de1">  domain: 'codepen.io'</div></li><li class="li1"><div class="de1">});</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">// Mostrem les dades per consola</div></li><li class="li1"><div class="de1">console.log(&quot;Totes les galetes:&quot;, document.cookie);</div></li><li class="li1"><div class="de1">console.log(&quot;Seu:&quot;, getCookie('seu'));</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/zrVeGp?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/zrVeGp?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/zrVeGp?editors=0011</a>.
</p>

<p>
Fixeu-vos que, per passar les opcions de les galetes, hem fet servir un objecte literal de JavaScript, d’aquesta manera el codi queda molt més net i compacte. La propietat <code>max-age</code>, en incloure el signe <code>-</code>, s’ha de posar entre cometes.
</p>

<p>
Si proveu de passar el paràmetre <code>secure</code> no us funcionarà perquè requereix que la connexió es faci sobre HTTPS, i ni l’exemple en local ni en CodePen corren sobre aquest protocol.
</p>

<p>
Tot i que l’especificació no requereix fer la codificació completa dels continguts de la galeta (només els espais, <code>,</code> i <code>;</code> han de ser codificats) és més simple codificar tots els valors i les claus fent servir la funció <code>encodeUriComponent()</code>. D’aquesta manera ens assegurem que els valors guardats seran correctes.
</p>

</div>

<h4><a id="temps_i_durada_de_les_galetes" >Temps i durada de les galetes</a></h4>
<div class="level4">

<p>
Tot i que la nostra funció per guardar galetes rutlli i contempli totes les opcions disponibles, encara podem tenir problemes amb un apartat: establir la data en la qual volem que expiri.
</p>

<p>
L’especificació ens diu que el format ha de ser el següent: <code>Wdy, DD-Mon-YYYY HH:MM:SS GMT</code> com per exemple: <code>Sat, 02 May 2009 23:38:25 GMT</code>. Però si fem servir l’objecte <code>Date</code> de JavaScript el que ens retorna serà semblant a això:
</p>
<pre class="code">Date.now();
// 1456167356375</pre>

<p>
L’objecte <code>Date</code> ens retorna la data en mil·lisegons. Afortunadament, disposa de mètodes per poder modificar aquesta data; vegem-ne alguns exemples:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  let ara = new Date(),</div></li><li class="li1"><div class="de1">      mes,</div></li><li class="li1"><div class="de1">      proximMes,</div></li><li class="li1"><div class="de1">      nadal;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;La data d'avui en UTC&quot;, ara.toUTCString());</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  mes = ara.getMonth();</div></li><li class="li1"><div class="de1">  console.log(&quot;Quin és el mes actual?&quot;, mes);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  proximMes = (mes + 1) % 12;</div></li><li class="li1"><div class="de1">  ara.setMonth(proximMes);</div></li><li class="li1"><div class="de1">  console.log(&quot;Quina és la data corresponent al pròxim mes?&quot;, ara.toUTCString());</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  nadal = new Date(2016, 11, 25);</div></li><li class="li1"><div class="de1">  console.log(&quot;Quin dia és Nadal el 2016?&quot;, nadal.toUTCString());</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;Desfasament horari per la nostra localització (en minuts):&quot;, nadal.getTimezoneOffset()</div></li><li class="li1"><div class="de1">)</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>

<p>

Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/mVZoqm?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/mVZoqm?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/mVZoqm?editors=0011</a>.
</p>

<p>
El resultat d’invocar el mètode <code>toUTCString()</code> produeix una data exactament amb el format que necessitem, com aquesta: <code>Tue, 22 Mar 2016 19:08:01 GMT</code>. Fixeu-vos que, en l’últim exemple, creem una data en concret, però el resultat pot ser inesperat, ja que:
</p>
<ul>
<li class="level1"><div class="li"> Gener correspon al mes 0, i per tant desembre és el mes 11.</div>
</li>
<li class="level1"><div class="li"> La data mostrada serà aquesta: <code>Sat, 24 Dec 2016 23:00:00 GMT</code></div>
</li>
<li class="level1"><div class="li"> El desfasament horari serà de -60 minuts, això explica per què la data mostrada sembla errònia per una hora. Quan es crea l’objecte Date es fa servir l’ús horari del client, que en el nostre cas és <code>GMT+1</code>, i en convertir-la en <code>GMT</code> es descompta aquesta hora.</div>
</li>
</ul>

<p>
Treballar amb dates afegeix una complicació extra a la creació de galetes. Per aquesta raó és més recomanable fer servir l’opció <code>max-age</code>, que ens permet especificar l’edat màxima que pot assolir la galeta, expressada en segons. Així, per exemple, podem crear-ne una que expiri en un mes així:
</p>
<pre class="code">setCookie(&#039;seu&#039;, &#039;Barcelona&#039;, {
  &#039;max-age&#039;: 60*60*24*30
});</pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/bEPZZx?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/bEPZZx?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/bEPZZx?editors=0011</a>.
</p>

<p>
Per tant, podem fer que les galetes persisteixin en el temps, encara que es finalitzi la sessió del navegador. Ara bé, com podem esborrar-les? La manera de fer-ho és molt simple, només hem de guardar una galeta amb la mateixa clau i amb l’opció <code>max-age=-1</code> (o amb l’opció <code>expires</code> amb una data ja passada). D’aquesta manera la galeta expira immediatament:
</p>
<pre class="code">setCookie(&#039;seu&#039;, &#039;Barcelona&#039;, {
  &#039;max-age&#039;: -1
});</pre>

<p>
Podeu veure aquest exemple en l’enllaç següent: <a href="https://codepen.io/ioc-daw-m06/pen/vLqMEp?editors=0011" class="urlextern" title="https://codepen.io/ioc-daw-m06/pen/vLqMEp?editors=0011"  rel="nofollow">codepen.io/ioc-daw-m06/pen/vLqMEp?editors=0011</a>.
</p>

</div>

<h3><a id="utilitzacio_de_web_storage" >Utilització de Web Storage</a></h3>
<div class="level3">

<p>
Aquesta Web <acronym title="Application Programming Interface">API</acronym> permet emmagatzemar dades en l’ordinador client amb més possibiltats que les galetes. Distingeix dues maneres de realitzar aquest emmagatzematge:
</p>
<ul>
<li class="level1"><div class="li"> LocalStorage: les dades no expiren mai i, per tant, es requereix esborrat manual o per programa</div>
</li>
<li class="level1"><div class="li"> SessionStorage: les dades es guarden només per una sessió i, en tancar la finestra del navegador s’esborra.</div>
</li>
</ul>

<p>
A banda de l’anterior, el funcionament és idèntic a tots dos tipus de Web Storage.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El <strong>LocalStorage</strong> comparteix la informació entre totes les pàgines del mateix domini, en canvi, el <strong>SessionStorage</strong> és diferent per a cada finestra; de manera que si tenim tres finestres obertes amb la mateixa pàgina, la informació del <strong>SessionStorage</strong> serà diferent per a cadascuna, mentre que la del <strong>LocalStorage</strong> serà la mateixa.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">Web Storage</p>
<p>
Podeu trobar l’especificació del <em>Living Standard</em> al següent enllaç: <a href="https://html.spec.whatwg.org/multipage/webstorage.html" class="urlextern" title="https://html.spec.whatwg.org/multipage/webstorage.html"  rel="nofollow">www.goo.gl/JVCEHl</a>. I informació sobre el funcionament detallat en aquest: <a href="https://developer.mozilla.org/ca/docs/Web/API/Storage" class="urlextern" title="https://developer.mozilla.org/ca/docs/Web/API/Storage"  rel="nofollow">www.goo.gl/mPwJxl</a>.
</p>
</div></div>
<p>
A diferència de l’ús de galetes, aquesta Web <acronym title="Application Programming Interface">API</acronym>  ofereix una interfície molt clara per interactuar amb el magatzem de dades:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Storage.setItem(key, value)</strong>: per guardar un valor amb la clau especificada.</div>
</li>
<li class="level1"><div class="li"> <strong>Storage.getItem(key)</strong>: per recuperar el valor corresponent a la clau.</div>
</li>
<li class="level1"><div class="li"> <strong>Storage.removeItem(key)</strong>: per eliminar l’element corresponent a la clau del magatzem.</div>
</li>
<li class="level1"><div class="li"> <strong>Storage.clear()</strong>: elimina totes les claus del magatzem.</div>
</li>
</ul>

<p>
Vegem com funcionen tots aquests mètodes:
</p>
<pre class="code html4strict"><ol><li class="li1"><div class="de1">&lt;script&gt;</div></li><li class="li1"><div class="de1">  localStorage.setItem('seus', ['Barcelona', 'Girona', 'Lleida', 'Tarragona']);</div></li><li class="li1"><div class="de1">  localStorage.setItem('seu seleccionada', 'Barcelona');</div></li><li class="li1"><div class="de1">  localStorage.setItem('paf', 1);</div></li><li class="li1"><div class="de1">  localStorage.setItem('confirmat', false);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;Comprovem que s'han creat:&quot;); console.log(&quot;seus:&quot;, localStorage.getItem('seus'));</div></li><li class="li1"><div class="de1">  console.log(&quot;seleccionada:&quot;, localStorage.getItem('seu seleccionada'));</div></li><li class="li1"><div class="de1">  console.log(&quot;paf:&quot;, localStorage.getItem('paf'));</div></li><li class="li1"><div class="de1">  console.log(&quot;confirmat:&quot;, localStorage.getItem('confirmat'));</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;Eliminem la seu seleccionada.&quot;)</div></li><li class="li1"><div class="de1">  localStorage.removeItem('seu seleccionada');</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;Comprovem el valor de la seu seleccionada:&quot;, localStorage.getItem('seu seleccionada'));</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;Eliminem tots els valors&quot;);</div></li><li class="li1"><div class="de1">  localStorage.clear();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  console.log(&quot;Comprovem que s'han eliminat:&quot;)</div></li><li class="li1"><div class="de1">  console.log(&quot;seus:&quot;, localStorage.getItem('seus'));</div></li><li class="li1"><div class="de1">  console.log(&quot;seleccionada:&quot;, localStorage.getItem('seu seleccionada'));</div></li><li class="li1"><div class="de1">  console.log(&quot;paf:&quot;, localStorage.getItem('paf'));</div></li><li class="li1"><div class="de1">  console.log(&quot;confirmat:&quot;, localStorage.getItem('confirmat'));</div></li><li class="li1"><div class="de1">&lt;/script&gt;</div></li></ol></pre>
<div class="iocimportant"><div class="ioccontent">
<p>
Per fer servir el <strong>SessionStorage</strong> en lloc del <strong>LocalStorage</strong>, només hem de canviar <code>localStorage</code> per <code>sessionStorage</code>.
</p>
</div></div>
<p>
Com podeu veure, a diferència de les galetes, els valors emmagatzemats poden ser de diferents tipus: enters, cadenes, <em>booleans</em> i fins i tot <em>arrays</em> (només caldrà fer servir <code>String.split()</code> per recuperar l’<em>array</em>).
</p>

<p>
No cal crear cap objecte ni configurar res per accedir als magatzems de dades, són accessibles directament a través dels objectes globals <code>localStorage</code> i <code>sessionStorage</code> que ens proporciona el navegador, i la informació es guarda automàticament associada al domini on s’ha creat.
</p>

<p>
La persistència de les dades es basa en el tipus de magatzem: si fem servir el <em>LocalStorage</em> aquestes dades persistiran fins que les esborrem nosaltres mateixos via codi o quan l’usuari esborri les dades de navegació; en canvi, si fem servir el <em>SessionStorage</em>
, totes les dades s’esborraran tan bon punt es tanqui la finestra del navegador.
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u4/a1/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u4/a2/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
