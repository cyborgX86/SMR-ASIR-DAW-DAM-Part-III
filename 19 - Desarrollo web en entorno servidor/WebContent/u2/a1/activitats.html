<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Desenvolupament web en entorn servidor</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Desenvolupament web en entorn servidor">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Desenvolupament web en entorn servidor</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u2" class="parentnode"><p><a class="unit" href="../../../WebContent/u2/introduccio.html">2. Desenvolupament web en entorn servidor</a></p><ul class="expander"><li id="u2introduccio"><a href="../../../WebContent/u2/introduccio.html">Introducció</a></li><li id="u2resum"><a href="../../../WebContent/u2/resum.html">Resum</a></li><li id="u2resultats"><a href="../../../WebContent/u2/resultats.html">Resultats d'aprenentatge</a></li><li id="u2referencies"><a href="../../../WebContent/u2/referencies.html">Referències</a></li><li id="u2a1" class="tocsection"><p id='u2a1continguts'><a class="section" href="../../../WebContent/u2/a1/continguts.html">'Servlets'</a><span class="buttonexp"></span></p><ul><li id="u2a1activitats"><a href="../../../WebContent/u2/a1/activitats.html">Activitats</a></li><li id="u2a1exercicis"><a href="../../../WebContent/u2/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u2a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a1/continguts.html#servlet_hola_mon">'Servlet' Hola, Món</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#servlet_endevinacolor">'Servlet' EndevinaColor</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#servlet_publicitat_als_nous">'Servlet' Publicitat als nous</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#que_s_ha_apres">Què s'ha après</a></li></ul></div></div><li id="u2a2" class="tocsection"><p id='u2a2continguts'><a class="section" href="../../../WebContent/u2/a2/continguts.html">Formularis amb 'servlets' i EJB</a><span class="buttonexp"></span></p><ul><li id="u2a2activitats"><a href="../../../WebContent/u2/a2/activitats.html">Activitats</a></li><li id="u2a2exercicis"><a href="../../../WebContent/u2/a2/exercicis.html">Exercicis d'autoavaluació</a></li><li id="u2a2annexos"><a href="../../../WebContent/u2/a2/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u2a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a2/continguts.html#calculant_el_sou_net">Calculant el sou net</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#escrivint_un_post">Escrivint un 'post'</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#dades_de_subscripcio">Dades de subscripció</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#que_s_ha_apres">Què s'ha après?</a></li></ul></div></div><li id="u2a3" class="tocsection"><p id='u2a3continguts'><a class="section" href="../../../WebContent/u2/a3/continguts.html">Manteniment d'estat, autenticació i autorització amb 'servlets' i EJB</a><span class="buttonexp"></span></p><ul><li id="u2a3activitats"><a href="../../../WebContent/u2/a3/activitats.html">Activitats</a></li><li id="u2a3exercicis"><a href="../../../WebContent/u2/a3/exercicis.html">Exercicis d'autoavaluació</a></li><li id="u2a3annexos"><a href="../../../WebContent/u2/a3/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u2a3' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a3/continguts.html#l_usuari_en_una_galeta">L'usuari, en una galeta</a></li><li><a href="../../../WebContent/u2/a3/continguts.html#l_usuari_a_la_sessio">L'usuari a la sessió</a></li><li><a href="../../../WebContent/u2/a3/continguts.html#un_formulari_d_autenticacio_amb_ejb">Un formulari d'autenticació amb EJB</a></li><li><a href="../../../WebContent/u2/a3/continguts.html#que_s_ha_apres">Què s'ha après?</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Desenvolupament web en entorn servidor</a></li><li><a href="continguts.html">'Servlets'</a></li><li>Activitats</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="activitats"> Activitats </a></h1>
    	
<h2><a id="la_capcalera_de_la_peticio" >La capçalera de la petició</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprofundir en l’aprenentatge del protocol HTTP amb la utilització de <em>servlets</em> per analitzar la capçalera d’una petició.
</p>

<p>
Implementeu un <em>servlet</em> que mostri en una pàgina el missatge <code>GET</code> o <code>POST</code> que hagi rebut amb totes les capçaleres i els paràmetres enviats.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
La solució de l’exercici la podeu descarregar en aquest <div class="mediaf filezip"><div class="mediacontent"><a href="../media/activitatsservlets.zip">enllaç</a><span> ( 6.8 KB )</span></div></div>. 
</p>

<p>
Començarem l’activitat creant un nou projecte Maven. Aneu a <em>File / New Project / Maven / Web Application</em>. Si voleu, esborreu el fitxer index.php, ja que no el necessitarem. A continuació, creeu un <em>servlet</em> nou i modifiqueu la funció <code>processRequest</code> perquè contingui el següent codi:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1"> protected void processRequest(HttpServletRequest request, HttpServletResponse response)</div></li><li class="li1"><div class="de1">            throws ServletException, IOException {</div></li><li class="li1"><div class="de1">        response.setContentType(&quot;text/html&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        PrintWriter out = response.getWriter();</div></li><li class="li1"><div class="de1">        String title = &quot;Exemple de petició HTTP&quot;;</div></li><li class="li1"><div class="de1">        String docType</div></li><li class="li1"><div class="de1">                = &quot;&lt;!doctype html public \&quot;-//w3c//dtd html 4.0 &quot;</div></li><li class="li1"><div class="de1">                + &quot;transitional//en\&quot;&gt;\n&quot;;</div></li><li class="li1"><div class="de1">        out.println(docType</div></li><li class="li1"><div class="de1">                + &quot;&lt;html&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;head&gt;&lt;title&gt;&quot; + title + &quot;&lt;/title&gt;&lt;/head&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;body bgcolor=\&quot;#f0f0f0\&quot;&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;h1 align=\&quot;center\&quot;&gt;&quot; + title + &quot;&lt;/h1&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;table width=\&quot;100%\&quot; border=\&quot;1\&quot; align=\&quot;center\&quot;&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;tr bgcolor=\&quot;#949494\&quot;&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;th&gt;Nom del paràmetre de la capçalera de la petició&lt;/th&gt;&lt;th&gt;Valor(s)&lt;/th&gt;\n&quot;</div></li><li class="li1"><div class="de1">                + &quot;&lt;/tr&gt;\n&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        Enumeration headerNames = request.getHeaderNames();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        while (headerNames.hasMoreElements()) {</div></li><li class="li1"><div class="de1">            String paramName = (String) headerNames.nextElement();</div></li><li class="li1"><div class="de1">            out.print(&quot;&lt;tr&gt;&lt;td&gt;&quot; + paramName + &quot;&lt;/td&gt;\n&quot;);</div></li><li class="li1"><div class="de1">            String paramValue = request.getHeader(paramName);</div></li><li class="li1"><div class="de1">            out.println(&quot;&lt;td&gt; &quot; + paramValue + &quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;);</div></li><li class="li1"><div class="de1">        }</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;/table&gt;\n&lt;/body&gt;&lt;/html&gt;&quot;);</div></li><li class="li1"><div class="de1">    }</div></li></ol></pre>

<p>
En executar el <em>servlet</em> anterior us apareixerà la informació que podeu veure en la <span class="figref"><a href="#fig01"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="fig01"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

 Capçalera de la petició

</figcaption><img src="../media/u2-a1-peticiohttp.png" alt="" /></figure>
<div class="footfigure"></div></div>
<p>
La <span class="figref"><a href="#fig01"><span>figura</span></a></span> ens mostra tot un llistat de paràmetres que el navegador ha enviat al servidor quan ha demanat el recurs. Aquest recurs és l’<acronym title="Uniform Resource Locator">URL</acronym> del <em>servlet</em> que hem creat per donar una solució a l’activitat.
</p>

<p>
Tots aquests paràmetres s’envien automàticament sense que el mateix usuari sàpiga que s’han enviat i el servidor els pot llegir per donar una resposta més acurada al client que l’ha demanat.
</p>

<p>
Els paràmetres que s’han enviat han estat:
</p>
<ul>
<li class="level1"><div class="li"> <code>host</code>: correspon amb la IP i el port del servidor al qual el navegador ha accedit per obtenir una pàgina web.</div>
</li>
<li class="level1"><div class="li"> <code>connection</code>: paràmetre que indica al servidor què ha de fer amb la connexió HTTP establerta. En aquest cas, l’opció <code>keep-alive</code> vol reaprofitar la connexió per a futures peticions.</div>
</li>
<li class="level1"><div class="li"> <code>accept</code>: indica quines respostes accepta. Sempre són dos valors <code>type/subtype</code>, per exemple, text/html. </div>
</li>
<li class="level1"><div class="li"> <code>include-insecure-headers</code>: indica al servidor la preferència de navegar amb HTPPS. Si es troba a “1”, el servidor té el permís del client per establir una connexió segura amb el protocol HTTPS. Si finalment s’estableix una connexió segura, el servidor ha d’incloure un paràmetre addicional anomenat <code>strict-transport-security</code> (<em>HSTS-Safe</em>).</div>
</li>
<li class="level1"><div class="li"> <code>user-agent</code>: indica quin és el navegador utilitzat pel client en fer la petició.</div>
</li>
<li class="level1"><div class="li"> <code>accept-encoding</code>: indica al servidor quina codificació accepta en la resposta. Per exemple, pot acceptar pàgines comprimides en Gzip.</div>
</li>
<li class="level1"><div class="li"> <code>accept-language</code>: indica al servidor l’idioma preferit per l’usuari per visualitzar una pàgina. </div>
</li>
<li class="level1"><div class="li"> <code>dnt</code>: també conegut com <code>do not track</code>. Si està activat, indica al servidor que l’usuari vol desactivar el seu seguiment (<em>tracking</em>). És un paràmetre de seguretat que activa l’usuari per indicar que no vol que rastregin la seva petició. Igualment, depèn de l’honorabilitat dels servidors fer cas d’aquesta petició.</div>
</li>
</ul>

<p>
Com podeu suposar, existeixen molts més paràmetres. Podeu veure tots els paràmetres que es poden enviar en aquest <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Request_fields" class="urlextern" title="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Request_fields"  rel="nofollow">enllaç</a>.
</p>

<p>
Tornant a l’exemple, fixeu-vos com s’han obtingut els paràmetres de capçalera de la petició:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">Enumeration headerNames = request.getHeaderNames();</div></li></ol></pre>

<p>
Amb aquesta instrucció s’ha obtingut una col·lecció d’elements que corresponen als noms dels paràmetres de la capçalera de la petició (<code>host</code>, <code>connection</code>…). 
</p>

<p>
Per aconseguir un a un els paràmetres enviats només s’ha d’executar el mètode <code>nextElement()</code>.
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">String paramName = (String) headerNames.nextElement();</div></li></ol></pre>

<p>
Finalment, amb la instrucció
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">String paramValue = request.getHeader(paramName);</div></li></ol></pre>

<p>
es recupera el valor associat a aquest paràmetre i es poden mostrar en forma de taula.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="la_capcalera_de_la_resposta" >La capçalera de la resposta</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprofundir en l’aprenentatge del protocol HTTP amb la utilització de <em>servlets</em> per analitzar la capçalera de resposta en fer una petició HTTP.
</p>

<p>
Implementeu un <em>servlet</em> que accedeixi a la pàgina <a href="http://ioc.xtec.cat" class="urlextern" title="http://ioc.xtec.cat"  rel="nofollow">ioc.xtec.cat</a> i mostri la capçalera de la resposta que hagi rebut amb tots els paràmetres.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
La solució de l’exercici la podeu descarregar en aquest <div class="mediaf filezip"><div class="mediacontent"><a href="../media/activitatsservlets.zip">enllaç</a><span> ( 6.8 KB )</span></div></div>.
</p>

<p>
Començarem l’activitat creant un nou projecte Maven. Aneu a <em>File / New Project / Maven / Web Application</em>. Si voleu, esborreu el fitxer index.php, ja que no el necessitarem. A continuació, creeu un <em>servlet</em> nou i modifiqueu la funció <code>processRequest</code> perquè contingui el següent codi:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">    protected void processRequest(HttpServletRequest request, HttpServletResponse response)</div></li><li class="li1"><div class="de1">            throws ServletException, IOException {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        response.setContentType(&quot;text/html&quot;);</div></li><li class="li1"><div class="de1">        response.setContentType(&quot;text/html;charset=UTF-8&quot;);</div></li><li class="li1"><div class="de1">        PrintWriter out = response.getWriter();</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;!DOCTYPE html&gt;&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;html&gt;&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;head&gt;&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;title&gt;Capçalera de la resposta&lt;/title&gt;&quot;);            </div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;/head&gt;&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;body&gt;&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	out.println(&quot;&lt;h1&gt;Capçalera de la resposta...\n&lt;/h1&gt;&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;h3&gt;Capçalera de la resposta del servidor ioc.xtec.cat en accedir al web: \n&lt;/h3&gt;&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;table width=\&quot;100%\&quot; border=\&quot;1\&quot; align=\&quot;center\&quot;&gt;\n&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;tr bgcolor=\&quot;#1acff6\&quot;&gt;\n&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;th&gt;Nom del paràmetre de la capçalera&lt;/th&gt;&lt;th&gt;Valor(s)&lt;/th&gt;\n&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;/tr&gt;\n&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        URL obj = new URL(&quot;http://ioc.xtec.cat&quot;);</div></li><li class="li1"><div class="de1">	URLConnection conn = obj.openConnection();</div></li><li class="li1"><div class="de1">	Map&lt;String, List&lt;String&gt;&gt; map = conn.getHeaderFields();</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : map.entrySet()) {</div></li><li class="li1"><div class="de1">            String paramName = (String) entry.getKey();</div></li><li class="li1"><div class="de1">            out.print(&quot;&lt;tr&gt;&lt;td&gt;&quot; + paramName + &quot;&lt;/td&gt;\n&quot;);         </div></li><li class="li1"><div class="de1">            out.println(&quot;&lt;td&gt; &quot; + entry.getValue() + &quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;);</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	}</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;/table&gt;&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;/body&gt;&quot;);</div></li><li class="li1"><div class="de1">        out.println(&quot;&lt;/html&gt;&quot;);</div></li><li class="li1"><div class="de1"> }</div></li></ol></pre>

<p>
En executar el <em>servlet</em> anterior us apareixerà la informació que podeu veure en la <span class="figref"><a href="#fig02"><span>figura</span></a></span>:
</p>
<div class="iocfigure"><a name="fig02"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Capçalera de la resposta de la petició d’un recurs

</figcaption><img src="../media/u2-a1-respostahttp.png" alt="" /></figure>
<div class="footfigure"></div></div>
<p>
La <span class="figref"><a href="#fig02"><span>figura</span></a></span> ens mostra tot un llistat de paràmetres que el <em>servlet</em> ha rebut en enviar una petició al servidor <a href="http://ioc.xtec.cat" class="urlextern" title="http://ioc.xtec.cat"  rel="nofollow">ioc.xtec.cat</a>.
</p>

<p>
Els paràmetres que s’han rebut son:
</p>
<ul>
<li class="level1"><div class="li"> <code>keep-Alive</code>: indica amb el valor <code>timeout</code> el temps que el servidor mantindrà la connexió oberta mentre no s’enviï cap altra petició. I amb el valor <code>max</code> indica el nombre màxim de peticions que admet del client per a aquesta connexió.</div>
</li>
<li class="level1"><div class="li"> <code>null - HTTP1.1/ 200 ok</code>: indica el protocol que ha fet servir per a la connexió (http 1.1) i l’estat (200) de la connexió (OK).</div>
</li>
<li class="level1"><div class="li"> <code>Server</code>: el servidor web que ha generat la resposta de la petició.</div>
</li>
<li class="level1"><div class="li"> <code>Connection</code>: l’estat de la connexió. En aquest cas es queda oberta perquè el client continuï fent peticions.</div>
</li>
<li class="level1"><div class="li"> <code>Last-Modified</code>: l’ultima vegada que es va modificar la pàgina web que s’ha demanat.</div>
</li>
<li class="level1"><div class="li"> <code>Date</code>: dia i hora en què la resposta va ser enviada.</div>
</li>
<li class="level1"><div class="li"> <code>Accept-Ranges</code>: és la unitat mínima d’informació que s’envia. Normalment, la informació s’envia en blocs de X bits. En aquest cas, envia la informació agrupada en bytes.</div>
</li>
<li class="level1"><div class="li"> <code>Cache-Contol</code>: informa el servidor durant quants segons la resposta és vàlida. </div>
</li>
<li class="level1"><div class="li"> <code>ETag</code>: correspon a l’identificador del recurs demanat.</div>
</li>
<li class="level1"><div class="li"> <code>Set-Cookie</code>: correspon a la <em>cookie</em> que el servidor emmagatzema a l’ordinador del usuari</div>
</li>
<li class="level1"><div class="li"> <code>Expires</code>: indica el dia i la hora fins a la qual la resposta és vàlida.</div>
</li>
<li class="level1"><div class="li"> <code>Content-length</code>: indica la longitud, en octets, del <em>body</em> de la pàgina demanada.</div>
</li>
<li class="level1"><div class="li"> <code>Content-Language</code>: indica l’idioma de la pàgina web que s’ha demanat.</div>
</li>
<li class="level1"><div class="li"> <code>Content-Type</code>: indica el tipus d’informació que s’envia al client. Exemple: text/html.</div>
</li>
</ul>

<p>
Podeu veure tots els paràmetres que es poden rebre en aquest <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Response_fields" class="urlextern" title="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Response_fields"  rel="nofollow">enllaç</a>.
</p>

<p>
Per crear una connexió HTTP a un servidor web s’ha fet servir aquest codi:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">URL obj = new URL(&quot;http://ioc.xtec.cat&quot;);</div></li><li class="li1"><div class="de1">URLConnection conn = obj.openConnection();</div></li></ol></pre>

<p>
Una vegada s’ha establert la connexió es pot demanar la capçalera que envia el servidor de l’IOC amb la següent instrucció:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">Map&lt;String, List&lt;String&gt;&gt; map = conn.getHeaderFields();</div></li></ol></pre>

<p>
Retorna un conjunt de dades que té l’estructura <code>clau:valor</code>, on la <em>clau</em> és el primer paràmetre i el <em>valor</em> és una llista de valors. Per recórrer aquesta estructura es fa servir un bucle de tipus <em>foreach</em>. A Java, aquests bucles s’implementen de la següent manera:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : map.entrySet()) {</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">}</div></li></ol></pre>

<p>
La variable <code>entry</code> a cada iteració tindrà un parell <code>clau:valor</code> diferent de l’objecte <code>map</code>.
</p>

<p>
Per accedir a la clau, que correspon al nom del paràmetre enviat a la capçalera de la resposta, s’utilitza el següent codi:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">String paramName = (String) entry.getKey();</div></li></ol></pre>

<p>
Per obtenir el valor o valors associats al paràmetre anterior s’utilitza la següent instrucció:
</p>
<pre class="code java"><ol><li class="li1"><div class="de1">out.println(&quot;&lt;td&gt; &quot; + entry.getValue() + &quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;);</div></li></ol></pre>

<p>
Mentre es van recuperant els valors, es va construint la taula que el <em>servlet</em> enviarà al client.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u2/a1/continguts.html">'Servlets'</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u2/a1/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
